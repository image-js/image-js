(function(D){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=D();else if("function"==typeof define&&define.amd)define([],D);else{var I;I="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?this:self:global:window,I.IJS=D()}})(function(){var define;return function D(I,R,T){function L(Z,W){if(!R[Z]){if(!I[Z]){var Q="function"==typeof require&&require;if(!W&&Q)return Q(Z,!0);if(E)return E(Z,!0);var $=new Error("Cannot find module '"+Z+"'");throw $.code="MODULE_NOT_FOUND",$}var J=R[Z]={exports:{}};I[Z][0].call(J.exports,function(ee){var te=I[Z][1][ee];return L(te?te:ee)},J,J.exports,D,I,R,T)}return R[Z].exports}var E="function"==typeof require&&require;for(var G=0;G<T.length;G++)L(T[G]);return L}({1:[function(D,I){(function(R){"use strict";var T=D("es-abstract/es6"),L=Number.isNaN||function(Z){return Z!==Z},E=Number.isFinite||function(Z){return"number"==typeof Z&&R.isFinite(Z)},G=Array.prototype.indexOf;I.exports=function(W){var Q=1<arguments.length?T.ToInteger(arguments[1]):0;if(G&&!L(W)&&E(Q)&&"undefined"!=typeof W)return-1<G.apply(this,arguments);var $=T.ToObject(this),J=T.ToLength($.length);if(0===J)return!1;for(var ee=0<=Q?Q:Math.max(0,J+Q);ee<J;){if(T.SameValueZero(W,$[ee]))return!0;ee+=1}return!1}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{"es-abstract/es6":25}],2:[function(D,I){"use strict";var R=D("define-properties"),T=D("es-abstract/es6"),L=D("./implementation"),E=D("./polyfill"),G=E(),Z=D("./shim"),W=Array.prototype.slice,Q=function(J){return T.RequireObjectCoercible(J),G.apply(J,W.call(arguments,1))};R(Q,{implementation:L,getPolyfill:E,shim:Z}),I.exports=Q},{"./implementation":1,"./polyfill":3,"./shim":4,"define-properties":23,"es-abstract/es6":25}],3:[function(D,I){"use strict";var R=D("./implementation");I.exports=function(){return Array.prototype.includes||R}},{"./implementation":1}],4:[function(D,I){"use strict";var R=D("define-properties"),T=D("./polyfill");I.exports=function(){var E=T();return Array.prototype.includes!==E&&R(Array.prototype,{includes:E}),E}},{"./polyfill":3,"define-properties":23}],5:[function(D,I){"use strict";I.exports=function(T){return atob(T)}},{}],6:[function(D,I){"use strict";function R(te){for(var ae=te.length,ie=new ArrayBuffer(ae),ne=new Uint8Array(ie),oe=-1;++oe<ae;)ne[oe]=te.charCodeAt(oe);return ie}function T(te){for(var ae="",ie=new Uint8Array(te),ne=ie.byteLength,oe=-1;++oe<ne;)ae+=String.fromCharCode(ie[oe]);return ae}function L(te,ae){return new ee(function(ie,ne){var oe=new Image;ae&&(oe.crossOrigin=ae),oe.onload=function(){ie(oe)},oe.onerror=ne,oe.src=te})}function E(te){var ae=document.createElement("canvas");ae.width=te.width,ae.height=te.height;var ie=ae.getContext("2d");return ie.drawImage(te,0,0,te.width,te.height,0,0,te.width,te.height),ae}function G(te,ae){return ae=ae||{},"string"==typeof ae&&(ae={type:ae}),new J(te,ae)}function Z(te){return new ee(function(ae,ie){var ne=new FileReader,oe="function"==typeof ne.readAsBinaryString;ne.onloadend=function(le){var se=le.target.result||"";return oe?ae(se):void ae(T(se))},ne.onerror=ie,oe?ne.readAsBinaryString(te):ne.readAsArrayBuffer(te)})}function W(te,ae){return ee.resolve().then(function(){var ie=[R(atob(te))];return ae?G(ie,{type:ae}):G(ie)})}function Q(te){return ee.resolve().then(function(){var ae=te.match(/data:([^;]+)/)[1],ie=te.replace(/^[^,]+,/,""),ne=R(atob(ie));return G([ne],{type:ae})})}function $(te,ae,ie){return ee.resolve().then(function(){return"function"==typeof te.toBlob?new ee(function(ne){te.toBlob(ne,ae,ie)}):Q(te.toDataURL(ae,ie))})}var J=D("blob"),ee=D("native-or-lie");I.exports={createBlob:G,createObjectURL:function(ae){return(window.URL||window.webkitURL).createObjectURL(ae)},revokeObjectURL:function(ae){return(window.URL||window.webkitURL).revokeObjectURL(ae)},imgSrcToBlob:function(ae,ie,ne,oe){return ie=ie||"image/png",L(ae,ne).then(function(le){return E(le)}).then(function(le){return $(le,ie,oe)})},imgSrcToDataURL:function(ae,ie,ne,oe){return ie=ie||"image/png",L(ae,ne).then(function(le){return E(le)}).then(function(le){return le.toDataURL(ie,oe)})},canvasToBlob:$,dataURLToBlob:Q,blobToBase64String:function(ae){return Z(ae).then(function(ie){return btoa(ie)})},base64StringToBlob:W,binaryStringToBlob:function(ae,ie){return ee.resolve().then(function(){return W(btoa(ae),ie)})},blobToBinaryString:Z,arrayBufferToBlob:function(ae,ie){return ee.resolve().then(function(){return G([ae],ie)})},blobToArrayBuffer:function(ae){return new ee(function(ie,ne){var oe=new FileReader;oe.onloadend=function(le){var se=le.target.result||new ArrayBuffer(0);ie(se)},oe.onerror=ne,oe.readAsArrayBuffer(ae)})}}},{blob:7,"native-or-lie":113}],7:[function(D,I){(function(R){"use strict";function T($){for(var J=0;J<$.length;J++){var ee=$[J];if(ee.buffer instanceof ArrayBuffer){var te=ee.buffer;if(ee.byteLength!==te.byteLength){var ae=new Uint8Array(ee.byteLength);ae.set(new Uint8Array(te,ee.byteOffset,ee.byteLength)),te=ae.buffer}$[J]=te}}}function L($,J){J=J||{};var ee=new G;T($);for(var te=0;te<$.length;te++)ee.append($[te]);return J.type?ee.getBlob(J.type):ee.getBlob()}function E($,J){return T($),new Blob($,J||{})}var G=R.BlobBuilder||R.WebKitBlobBuilder||R.MSBlobBuilder||R.MozBlobBuilder,Z=function(){try{var $=new Blob(["hi"]);return 2===$.size}catch(J){return!1}}(),W=Z&&function(){try{var $=new Blob([new Uint8Array([1,2])]);return 2===$.size}catch(J){return!1}}(),Q=G&&G.prototype.append&&G.prototype.getBlob;I.exports=function(){if(Z)return W?R.Blob:E;return Q?L:void 0}()}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],8:[function(){},{}],9:[function(D,I){"use strict";I.exports={hex2rgb:D("./lib/hex2rgb"),hsv2hex:D("./lib/hsv2hex"),hsv2rgb:D("./lib/hsv2rgb"),rgb2hex:D("./lib/rgb2hex"),rgb2hsv:D("./lib/rgb2hsv"),rgba:D("./lib/rgba"),rgba2rgb:D("./lib/rgba2rgb"),rgba2hex:D("./lib/rgba2hex"),hsl2hsv:D("./lib/hsl2hsv"),hsv2hsl:D("./lib/hsv2hsl"),hsl2rgb:D("./lib/hsl2rgb"),cssColor:D("./lib/css-color")}},{"./lib/css-color":11,"./lib/hex2rgb":12,"./lib/hsl2hsv":13,"./lib/hsl2rgb":14,"./lib/hsv2hex":15,"./lib/hsv2hsl":16,"./lib/hsv2rgb":17,"./lib/rgb2hex":18,"./lib/rgb2hsv":19,"./lib/rgba":20,"./lib/rgba2hex":21,"./lib/rgba2rgb":22}],10:[function(D,I){"use strict";I.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]}},{}],11:[function(D,I){"use strict";function R(J){var ee=$[J.toLowerCase()];if(ee)return{r:ee[0],g:ee[1],b:ee[2],a:100}}function T(J){if(0==J.indexOf("rgb(")){J=J.match(/rgb\(([^)]+)\)/)[1];var ee=J.split(/ *, */).map(Number);return{r:ee[0],g:ee[1],b:ee[2],a:100}}}function L(J){if(0===J.indexOf("rgba(")){J=J.match(/rgba\(([^)]+)\)/)[1];var ee=J.split(/ *, */).map(Number);return{r:ee[0],g:ee[1],b:ee[2],a:100*ee[3]}}}function E(J){if("#"===J[0]&&7===J.length)return{r:parseInt(J.slice(1,3),16),g:parseInt(J.slice(3,5),16),b:parseInt(J.slice(5,7),16),a:100}}function G(J){if("#"===J[0]&&4===J.length)return{r:parseInt(J[1]+J[1],16),g:parseInt(J[2]+J[2],16),b:parseInt(J[3]+J[3],16),a:100}}function Z(J){if(0===J.indexOf("hsl(")){J=J.match(/hsl\(([^)]+)\)/)[1];var ee=J.split(/ *, */),te=parseInt(ee[0],10),ae=parseInt(ee[1],10),ie=parseInt(ee[2],10),ne=Q(te,ae,ie);return ne.a=100,ne}}function W(J){if(0===J.indexOf("hsla(")){J=J.match(/hsla\(([^)]+)\)/)[1];var ee=J.split(/ *, */),te=parseInt(ee[0],10),ae=parseInt(ee[1],10),ie=parseInt(ee[2],10),ne=parseInt(100*ee[3],10),oe=Q(te,ae,ie);return oe.a=ne,oe}}var Q=D("./hsl2rgb"),$=D("./_colors");I.exports=function(ee){return R(ee)||G(ee)||E(ee)||T(ee)||L(ee)||Z(ee)||W(ee)}},{"./_colors":10,"./hsl2rgb":14}],12:[function(D,I){"use strict";I.exports=function(R){return("#"===R[0]&&(R=R.substr(1)),6===R.length)?{r:parseInt(R.substr(0,2),16),g:parseInt(R.substr(2,2),16),b:parseInt(R.substr(4,2),16)}:3===R.length?{r:parseInt(R[0]+R[0],16),g:parseInt(R[1]+R[1],16),b:parseInt(R[2]+R[2],16)}:void 0}},{}],13:[function(D,I){"use strict";I.exports=function(R,T,L){return T*=(50>L?L:100-L)/100,console.log("s",T),{h:R,s:100*(2*T/(L+T)),v:L+T}}},{}],14:[function(D,I){"use strict";var R=D("./hsl2hsv"),T=D("./hsv2rgb");I.exports=function(L,E,G){var Z=R(L,E,G);return T(Z.h,Z.s,Z.v)}},{"./hsl2hsv":13,"./hsv2rgb":17}],15:[function(D,I){"use strict";var R=D("./hsv2rgb"),T=D("./rgb2hex");I.exports=function(L,E,G){var Z=R(L,E,G);return T(Z.r,Z.g,Z.b)}},{"./hsv2rgb":17,"./rgb2hex":18}],16:[function(D,I){"use strict";I.exports=function(R,T,L){var E=(200-T)*L/100;return{h:R,s:T*L/(100>E?E:200-E),l:E/2}}},{}],17:[function(D,I){"use strict";I.exports=function(R,T,L){var T=T/100,L=L/100,E=[],G=L*T,Z=R/60,W=G*(1-Math.abs(Z%2-1)),Q=L-G;switch(parseInt(Z,10)){case 0:E=[G,W,0];break;case 1:E=[W,G,0];break;case 2:E=[0,G,W];break;case 3:E=[0,W,G];break;case 4:E=[W,0,G];break;case 5:E=[G,0,W];}return{r:Math.round(255*(E[0]+Q)),g:Math.round(255*(E[1]+Q)),b:Math.round(255*(E[2]+Q))}}},{}],18:[function(D,I){"use strict";I.exports=function(R,T,L){function E(G){var Z=G.toString(16);return 1===Z.length?"0"+Z:Z}return[E(R),E(T),E(L)].join("")}},{}],19:[function(D,I){"use strict";I.exports=function(R,T,L){var W=Math.max(R,T,L),Q=Math.min(R,T,L),$=W-Q,E,G,Z;return 0==$?E=0:R===W?E=(T-L)/$%6:T===W?E=(L-R)/$+2:L===W&&(E=(R-T)/$+4),E=Math.round(60*E),0>E&&(E+=360),G=Math.round(100*(0===W?0:$/W)),Z=Math.round(100*(W/255)),{h:E,s:G,v:Z}}},{}],20:[function(D,I){"use strict";I.exports=function(R,T,L,E){return"rgba("+[R,T,L,E/100].join(",")+")"}},{}],21:[function(D,I){"use strict";var R=D("./rgba2rgb"),T=D("./rgb2hex");I.exports=function(L,E,G,Z){var W=R(L,E,G,Z);return T(W.r,W.g,W.b)}},{"./rgb2hex":18,"./rgba2rgb":22}],22:[function(D,I){"use strict";I.exports=function(R,T,L,E){return E=E/100,{r:parseInt(255*(1-E)+E*R,10),g:parseInt(255*(1-E)+E*T,10),b:parseInt(255*(1-E)+E*L,10)}}},{}],23:[function(D,I){"use strict";var R=D("object-keys"),T=D("foreach"),L="function"==typeof Symbol&&"symbol"==typeof Symbol(),E=Object.prototype.toString,G=function(J){return"function"==typeof J&&"[object Function]"===E.call(J)},Z=Object.defineProperty&&function(){var J={};try{for(var ee in Object.defineProperty(J,"x",{enumerable:!1,value:J}),J)return!1;return J.x===J}catch(te){return!1}}(),W=function(J,ee,te,ae){(!(ee in J)||G(ae)&&ae())&&(Z?Object.defineProperty(J,ee,{configurable:!0,enumerable:!1,value:te,writable:!0}):J[ee]=te)},Q=function(J,ee){var te=2<arguments.length?arguments[2]:{},ae=R(ee);L&&(ae=ae.concat(Object.getOwnPropertySymbols(ee))),T(ae,function(ie){W(J,ie,ee[ie],te[ie])})};Q.supportsDescriptors=!!Z,I.exports=Q},{foreach:41,"object-keys":117}],24:[function(D,I){"use strict";var R=D("./helpers/isNaN"),T=D("./helpers/isFinite"),L=D("./helpers/sign"),E=D("./helpers/mod"),G=D("is-callable"),Z=D("es-to-primitive/es5");I.exports={ToPrimitive:Z,ToBoolean:function(Q){return!!Q},ToNumber:function(Q){return+Q},ToInteger:function(Q){var $=this.ToNumber(Q);return R($)?0:0!==$&&T($)?L($)*Math.floor(Math.abs($)):$},ToInt32:function(Q){return this.ToNumber(Q)>>0},ToUint32:function(Q){return this.ToNumber(Q)>>>0},ToUint16:function(Q){var $=this.ToNumber(Q);if(R($)||0===$||!T($))return 0;var J=L($)*Math.floor(Math.abs($));return E(J,65536)},ToString:function(Q){return Q+""},ToObject:function(Q){return this.CheckObjectCoercible(Q),Object(Q)},CheckObjectCoercible:function(Q,$){if(null==Q)throw new TypeError($||"Cannot call method on "+Q);return Q},IsCallable:G,SameValue:function(Q,$){return Q===$?0!==Q||1/Q==1/$:R(Q)&&R($)},Type:function(Q){return null===Q?"Null":"undefined"==typeof Q?"Undefined":"function"==typeof Q||"object"==typeof Q?"Object":"number"==typeof Q?"Number":"boolean"==typeof Q?"Boolean":"string"==typeof Q?"String":void 0}}},{"./helpers/isFinite":27,"./helpers/isNaN":28,"./helpers/mod":30,"./helpers/sign":31,"es-to-primitive/es5":32,"is-callable":50}],25:[function(D,I){"use strict";var R=Object.prototype.toString,T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,L=T?Symbol.prototype.toString:R,E=D("./helpers/isNaN"),G=D("./helpers/isFinite"),Z=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,W=D("./helpers/assign"),Q=D("./helpers/sign"),$=D("./helpers/mod"),J=D("./helpers/isPrimitive"),ee=D("es-to-primitive/es6"),te=parseInt,ae=D("function-bind"),ie=ae.call(Function.call,String.prototype.slice),ne=ae.call(Function.call,RegExp.prototype.test,/^0b[01]+$/i),oe=ae.call(Function.call,RegExp.prototype.test,/^0o[0-7]+$/i),le=["\x85","\u200B","\uFFFE"].join(""),se=new RegExp("["+le+"]","g"),de=ae.call(Function.call,RegExp.prototype.test,se),ue=/^[\-\+]0x[0-9a-f]+$/i,he=ae.call(Function.call,RegExp.prototype.test,ue),me=["\t\n\x0B\f\r \xA0\u1680\u180E\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028","\u2029\uFEFF"].join(""),ce=new RegExp("(^["+me+"]+)|(["+me+"]+$)","g"),ge=ae.call(Function.call,String.prototype.replace),pe=function(xe){return ge(xe,ce,"")},fe=D("./es5"),_e=D("is-regex"),be=W(W({},fe),{Call:function(xe,ke){var we=2<arguments.length?arguments[2]:[];if(!this.IsCallable(xe))throw new TypeError(xe+" is not a function");return xe.apply(ke,we)},ToPrimitive:ee,ToNumber:function(xe){var ke=J(xe)?xe:ee(xe,"number");if("symbol"==typeof ke)throw new TypeError("Cannot convert a Symbol value to a number");if("string"==typeof ke){if(ne(ke))return this.ToNumber(te(ie(ke,2),2));if(oe(ke))return this.ToNumber(te(ie(ke,2),8));if(de(ke)||he(ke))return NaN;var we=pe(ke);if(we!==ke)return this.ToNumber(we)}return+ke},ToInt16:function(xe){var ke=this.ToUint16(xe);return 32768<=ke?ke-65536:ke},ToInt8:function(xe){var ke=this.ToUint8(xe);return 128<=ke?ke-256:ke},ToUint8:function(xe){var ke=this.ToNumber(xe);if(E(ke)||0===ke||!G(ke))return 0;var we=Q(ke)*Math.floor(Math.abs(ke));return $(we,256)},ToUint8Clamp:function(xe){var ke=this.ToNumber(xe);if(E(ke)||0>=ke)return 0;if(255<=ke)return 255;var we=Math.floor(xe);return we+0.5<ke?we+1:ke<we+0.5?we:0==we%2?we:we+1},ToString:function(xe){if("symbol"==typeof xe)throw new TypeError("Cannot convert a Symbol value to a string");return xe+""},ToObject:function(xe){return this.RequireObjectCoercible(xe),Object(xe)},ToPropertyKey:function(xe){var ke=this.ToPrimitive(xe,String);return"symbol"==typeof ke?L.call(ke):this.ToString(ke)},ToLength:function(xe){var ke=this.ToInteger(xe);return 0>=ke?0:ke>Z?Z:ke},CanonicalNumericIndexString:function(xe){if("[object String]"!==R.call(xe))throw new TypeError("must be a string");if("-0"===xe)return-0;var ke=this.ToNumber(xe);return this.SameValue(this.ToString(ke),xe)?ke:void 0},RequireObjectCoercible:fe.CheckObjectCoercible,IsArray:Array.isArray||function(xe){return"[object Array]"===R.call(xe)},IsConstructor:function(xe){return"function"==typeof xe&&!!xe.prototype},IsExtensible:function(xe){return!Object.preventExtensions||!J(xe)&&Object.isExtensible(xe)},IsInteger:function(xe){if("number"!=typeof xe||E(xe)||!G(xe))return!1;var ke=Math.abs(xe);return Math.floor(ke)===ke},IsPropertyKey:function(xe){return"string"==typeof xe||"symbol"==typeof xe},IsRegExp:function(xe){if(!xe||"object"!=typeof xe)return!1;if(T){var ke=xe[Symbol.match];if("undefined"!=typeof ke)return fe.ToBoolean(ke)}return _e(xe)},SameValueZero:function(xe,ke){return xe===ke||E(xe)&&E(ke)},Type:function(xe){return"symbol"==typeof xe?"Symbol":fe.Type(xe)},SpeciesConstructor:function(xe,ke){if("Object"!==this.Type(xe))throw new TypeError("Assertion failed: Type(O) is not Object");var we=xe.constructor;if("undefined"==typeof we)return ke;if("Object"!==this.Type(we))throw new TypeError("O.constructor is not an Object");var ve=T&&Symbol.species?we[Symbol.species]:void 0;if(null==ve)return ke;if(this.IsConstructor(ve))return ve;throw new TypeError("no constructor found")}});delete be.CheckObjectCoercible,I.exports=be},{"./es5":24,"./helpers/assign":26,"./helpers/isFinite":27,"./helpers/isNaN":28,"./helpers/isPrimitive":29,"./helpers/mod":30,"./helpers/sign":31,"es-to-primitive/es6":33,"function-bind":43,"is-regex":54}],26:[function(D,I){"use strict";var R=Object.prototype.hasOwnProperty;I.exports=Object.assign||function(L,E){for(var G in E)R.call(E,G)&&(L[G]=E[G]);return L}},{}],27:[function(D,I){"use strict";var R=Number.isNaN||function(T){return T!==T};I.exports=Number.isFinite||function(T){return"number"==typeof T&&!R(T)&&T!==1/0&&T!==-(1/0)}},{}],28:[function(D,I){"use strict";I.exports=Number.isNaN||function(T){return T!==T}},{}],29:[function(D,I){"use strict";I.exports=function(T){return null===T||"function"!=typeof T&&"object"!=typeof T}},{}],30:[function(D,I){"use strict";I.exports=function(T,L){var E=T%L;return Math.floor(0<=E?E:E+L)}},{}],31:[function(D,I){"use strict";I.exports=function(T){return 0<=T?1:-1}},{}],32:[function(D,I){"use strict";var R=Object.prototype.toString,T=D("./helpers/isPrimitive"),L=D("is-callable"),E={"[[DefaultValue]]":function(Z,W){var Q=W||("[object Date]"===R.call(Z)?String:Number);if(Q===String||Q===Number){var $=Q===String?["toString","valueOf"]:["valueOf","toString"],J,ee;for(ee=0;ee<$.length;++ee)if(L(Z[$[ee]])&&(J=Z[$[ee]](),T(J)))return J;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};I.exports=function(Z,W){return T(Z)?Z:E["[[DefaultValue]]"](Z,W)}},{"./helpers/isPrimitive":34,"is-callable":50}],33:[function(D,I){"use strict";var R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,T=D("./helpers/isPrimitive"),L=D("is-callable"),E=D("is-date-object"),G=D("is-symbol"),Z=function($,J){if("undefined"==typeof $||null===$)throw new TypeError("Cannot call method on "+$);if("string"!=typeof J||"number"!==J&&"string"!==J)throw new TypeError("hint must be \"string\" or \"number\"");var ee="string"===J?["toString","valueOf"]:["valueOf","toString"],te,ae,ie;for(ie=0;ie<ee.length;++ie)if(te=$[ee[ie]],L(te)&&(ae=te.call($),T(ae)))return ae;throw new TypeError("No default value")},W=function($,J){var ee=$[J];if(null!==ee&&"undefined"!=typeof ee){if(!L(ee))throw new TypeError(ee+" returned for property "+J+" of object "+$+" is not a function");return ee}};I.exports=function($,J){if(T($))return $;var ee="default";1<arguments.length&&(J===String?ee="string":J===Number&&(ee="number"));var te;if(R&&(Symbol.toPrimitive?te=W($,Symbol.toPrimitive):G($)&&(te=Symbol.prototype.valueOf)),"undefined"!=typeof te){var ae=te.call($,ee);if(T(ae))return ae;throw new TypeError("unable to convert exotic object to primitive")}return"default"==ee&&(E($)||G($))&&(ee="string"),Z($,"default"==ee?"number":ee)}},{"./helpers/isPrimitive":34,"is-callable":50,"is-date-object":51,"is-symbol":55}],34:[function(D,I,R){arguments[4][29][0].apply(R,arguments)},{dup:29}],35:[function(D,I){"use strict";var R=Object.prototype.hasOwnProperty,T=Object.prototype.toString,L=function(Z){return"function"==typeof Array.isArray?Array.isArray(Z):"[object Array]"===T.call(Z)},E=function(Z){if(!Z||"[object Object]"!==T.call(Z))return!1;var W=R.call(Z,"constructor"),Q=Z.constructor&&Z.constructor.prototype&&R.call(Z.constructor.prototype,"isPrototypeOf");if(Z.constructor&&!W&&!Q)return!1;for(var $ in Z);return"undefined"==typeof $||R.call(Z,$)};I.exports=function G(){var te=arguments[0],ae=1,ie=arguments.length,ne=!1,Z,W,Q,$,J,ee;for("boolean"==typeof te?(ne=te,te=arguments[1]||{},ae=2):("object"!=typeof te&&"function"!=typeof te||null==te)&&(te={});ae<ie;++ae)if(Z=arguments[ae],null!=Z)for(W in Z)Q=te[W],$=Z[W],te!==$&&(ne&&$&&(E($)||(J=L($)))?(J?(J=!1,ee=Q&&L(Q)?Q:[]):ee=Q&&E(Q)?Q:{},te[W]=G(ne,ee,$)):"undefined"!=typeof $&&(te[W]=$));return te}},{}],36:[function(D,I){"use strict";var R=D("iobuffer"),T=D("tiff");I.exports=function(E){var G=new R(E),Z={};G.setBigEndian();var W=G.readUint16();if(65496!==W)throw new Error("SOI marker not found. Not a valid JPEG file");var Q=G.readUint16();if(65505===Q){G.readUint16();var $=G.readBytes(6);if(69===$[0]&&120===$[1]&&105===$[2]&&102===$[3]&&0===$[4]&&0===$[5]){var J=T.decode(G,{onlyFirst:!0,ignoreImageData:!0,offset:G.offset});Z.exif=J}}return Z}},{iobuffer:48,tiff:138}],37:[function(D,I,R){"use strict";R.decode=D("./decode")},{"./decode":36}],38:[function(D,I){"use strict";function R(ee,te,ae){for(var ie=0;ie<ae;ie++)te[ie]=ee[ie]}function T(ee,te,ae,ie){for(var ne=0;ne<ie;ne++)te[ne]=ee[ne];for(;ne<ae;ne++)te[ne]=255&ee[ne]+te[ne-ie]}function L(ee,te,ae,ie){var ne=0;if(0===ae.length)for(;ne<ie;ne++)te[ne]=ee[ne];else for(;ne<ie;ne++)te[ne]=255&ee[ne]+ae[ne]}function E(ee,te,ae,ie,ne){var oe=0;if(0===ae.length){for(;oe<ne;oe++)te[oe]=ee[oe];for(;oe<ie;oe++)te[oe]=255&ee[oe]+(te[oe-ne]>>1)}else{for(;oe<ne;oe++)te[oe]=255&ee[oe]+(ae[oe]>>1);for(;oe<ie;oe++)te[oe]=255&ee[oe]+(te[oe-ne]+ae[oe]>>1)}}function G(ee,te,ae,ie,ne){var oe=0;if(0===ae.length){for(;oe<ne;oe++)te[oe]=ee[oe];for(;oe<ie;oe++)te[oe]=255&ee[oe]+te[oe-ne]}else{for(;oe<ne;oe++)te[oe]=255&ee[oe]+ae[oe];for(;oe<ie;oe++)te[oe]=255&ee[oe]+Z(te[oe-ne],ae[oe],ae[oe-ne])}}function Z(ee,te,ae){var ie=ee+te-ae,ne=Math.abs(ie-ee),oe=Math.abs(ie-te),le=Math.abs(ie-ae);if(ne<=oe&&ne<=le)return ee;return oe<=le?te:ae}var W=D("iobuffer"),Q=D("pako").Inflate,$=new Uint8Array(0),J=[137,80,78,71,13,10,26,10];I.exports=class extends W{constructor(te){super(te),this._decoded=!1,this._inflator=new Q,this._png=null,this._end=!1,this.setBigEndian()}decode(){if(this._decoded)return this._png;for(this._png={tEXt:{}},this.decodeSignature();!this._end;)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(var te=0;8>te;te++)if(this.readUint8()!==J[te])throw new Error(`Wrong PNG signature. Byte at ${te} should be ${J[te]}.`)}decodeChunk(){var te=this.readUint32(),ae=this.readChars(4),ie=this.offset;switch(ae){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(te);break;case"IDAT":this.decodeIDAT(te);break;case"tEXt":this.decodetEXt(te);break;case"IEND":this._end=!0;break;default:this.skip(te);}if(this.offset-ie!==te)throw new Error("Length mismatch while decoding chunk "+ae);this.readUint32()}decodeIHDR(){var te=this._png;if(te.width=this.readUint32(),te.height=this.readUint32(),te.bitDepth=this.readUint8(),te.colourType=this.readUint8(),te.compressionMethod=this.readUint8(),te.filterMethod=this.readUint8(),te.interlaceMethod=this.readUint8(),0!==this._png.compressionMethod)throw new Error("Unsupported compression method: "+te.compressionMethod)}decodePLTE(te){if(0!=te%3)throw new RangeError("PLTE field length must be a multiple of 3. Got "+te);var ae=te/3;this._hasPalette=!0;var ie=this._palette=Array(ae);for(var ne=0;ne<ae;ne++)ie[ne]=[this.readUint8(),this.readUint8(),this.readUint8()]}decodeIDAT(te){this._inflator.push(new Uint8Array(this.buffer,this.offset,te)),this.skip(te)}decodetEXt(te){for(var ae="",ie;"\0"!==(ie=this.readChar());)ae+=ie;this._png.tEXt[ae]=this.readChars(te-ae.length-1)}decodeImage(){if(this._inflator.push($,!0),this._inflator.err)throw new Error("Error while decompressing the data");var te=this._inflator.result;if(this._inflator=null,0!==this._png.filterMethod)throw new Error("Filter method "+this._png.filterMethod+" not supported");if(0===this._png.interlaceMethod)this.decodeInterlaceNull(te);else throw new Error("Interlace method "+this._png.interlaceMethod+" not supported")}decodeInterlaceNull(te){var ae;switch(this._png.colourType){case 0:ae=1;break;case 2:ae=3;break;case 3:if(!this._hasPalette)throw new Error("Missing palette");ae=1;break;case 4:ae=2;break;case 6:ae=4;break;default:throw new Error("Unknown colour type: "+this._png.colourType);}var ie=this._png.height,ne=ae*this._png.bitDepth/8,oe=this._png.width*ne,le=new Uint8Array(this._png.height*oe),se=$,de=0,ue,he;for(var me=0;me<ie;me++){switch(ue=te.subarray(de+1,de+1+oe),he=le.subarray(me*oe,(me+1)*oe),te[de]){case 0:R(ue,he,oe);break;case 1:T(ue,he,oe,ne);break;case 2:L(ue,he,se,oe);break;case 3:E(ue,he,se,oe,ne);break;case 4:G(ue,he,se,oe,ne);break;default:throw new Error("Unsupported filter: "+te[de]);}se=he,de+=oe+1}this._hasPalette&&(this._png.palette=this._palette),this._png.data=le}}},{iobuffer:48,pako:119}],39:[function(D,I,R){"use strict";R.PNGDecoder=D("./PNGDecoder")},{"./PNGDecoder":38}],40:[function(D,I){"use strict";I.exports=function(R){return R&&1<R.length?255===R[0]&&216===R[1]&&255===R[2]?{ext:"jpg",mime:"image/jpeg"}:137===R[0]&&80===R[1]&&78===R[2]&&71===R[3]?{ext:"png",mime:"image/png"}:71===R[0]&&73===R[1]&&70===R[2]?{ext:"gif",mime:"image/gif"}:87===R[8]&&69===R[9]&&66===R[10]&&80===R[11]?{ext:"webp",mime:"image/webp"}:70===R[0]&&76===R[1]&&73===R[2]&&70===R[3]?{ext:"flif",mime:"image/flif"}:(73===R[0]&&73===R[1]&&42===R[2]&&0===R[3]||77===R[0]&&77===R[1]&&0===R[2]&&42===R[3])&&67===R[8]&&82===R[9]?{ext:"cr2",mime:"image/x-canon-cr2"}:73===R[0]&&73===R[1]&&42===R[2]&&0===R[3]||77===R[0]&&77===R[1]&&0===R[2]&&42===R[3]?{ext:"tif",mime:"image/tiff"}:66===R[0]&&77===R[1]?{ext:"bmp",mime:"image/bmp"}:73===R[0]&&73===R[1]&&188===R[2]?{ext:"jxr",mime:"image/vnd.ms-photo"}:56===R[0]&&66===R[1]&&80===R[2]&&83===R[3]?{ext:"psd",mime:"image/vnd.adobe.photoshop"}:80===R[0]&&75===R[1]&&3===R[2]&&4===R[3]&&109===R[30]&&105===R[31]&&109===R[32]&&101===R[33]&&116===R[34]&&121===R[35]&&112===R[36]&&101===R[37]&&97===R[38]&&112===R[39]&&112===R[40]&&108===R[41]&&105===R[42]&&99===R[43]&&97===R[44]&&116===R[45]&&105===R[46]&&111===R[47]&&110===R[48]&&47===R[49]&&101===R[50]&&112===R[51]&&117===R[52]&&98===R[53]&&43===R[54]&&122===R[55]&&105===R[56]&&112===R[57]?{ext:"epub",mime:"application/epub+zip"}:80===R[0]&&75===R[1]&&3===R[2]&&4===R[3]&&77===R[30]&&69===R[31]&&84===R[32]&&65===R[33]&&45===R[34]&&73===R[35]&&78===R[36]&&70===R[37]&&47===R[38]&&109===R[39]&&111===R[40]&&122===R[41]&&105===R[42]&&108===R[43]&&108===R[44]&&97===R[45]&&46===R[46]&&114===R[47]&&115===R[48]&&97===R[49]?{ext:"xpi",mime:"application/x-xpinstall"}:80===R[0]&&75===R[1]&&(3===R[2]||5===R[2]||7===R[2])&&(4===R[3]||6===R[3]||8===R[3])?{ext:"zip",mime:"application/zip"}:117===R[257]&&115===R[258]&&116===R[259]&&97===R[260]&&114===R[261]?{ext:"tar",mime:"application/x-tar"}:82===R[0]&&97===R[1]&&114===R[2]&&33===R[3]&&26===R[4]&&7===R[5]&&(0===R[6]||1===R[6])?{ext:"rar",mime:"application/x-rar-compressed"}:31===R[0]&&139===R[1]&&8===R[2]?{ext:"gz",mime:"application/gzip"}:66===R[0]&&90===R[1]&&104===R[2]?{ext:"bz2",mime:"application/x-bzip2"}:55===R[0]&&122===R[1]&&188===R[2]&&175===R[3]&&39===R[4]&&28===R[5]?{ext:"7z",mime:"application/x-7z-compressed"}:120===R[0]&&1===R[1]?{ext:"dmg",mime:"application/x-apple-diskimage"}:0===R[0]&&0===R[1]&&0===R[2]&&(24===R[3]||32===R[3])&&102===R[4]&&116===R[5]&&121===R[6]&&112===R[7]||51===R[0]&&103===R[1]&&112===R[2]&&53===R[3]||0===R[0]&&0===R[1]&&0===R[2]&&28===R[3]&&102===R[4]&&116===R[5]&&121===R[6]&&112===R[7]&&109===R[8]&&112===R[9]&&52===R[10]&&50===R[11]&&109===R[16]&&112===R[17]&&52===R[18]&&49===R[19]&&109===R[20]&&112===R[21]&&52===R[22]&&50===R[23]&&105===R[24]&&115===R[25]&&111===R[26]&&109===R[27]||0===R[0]&&0===R[1]&&0===R[2]&&28===R[3]&&102===R[4]&&116===R[5]&&121===R[6]&&112===R[7]&&105===R[8]&&115===R[9]&&111===R[10]&&109===R[11]||0===R[0]&&0===R[1]&&0===R[2]&&28===R[3]&&102===R[4]&&116===R[5]&&121===R[6]&&112===R[7]&&109===R[8]&&112===R[9]&&52===R[10]&&50===R[11]&&0===R[12]&&0===R[13]&&0===R[14]&&0===R[15]?{ext:"mp4",mime:"video/mp4"}:0===R[0]&&0===R[1]&&0===R[2]&&28===R[3]&&102===R[4]&&116===R[5]&&121===R[6]&&112===R[7]&&77===R[8]&&52===R[9]&&86===R[10]?{ext:"m4v",mime:"video/x-m4v"}:77===R[0]&&84===R[1]&&104===R[2]&&100===R[3]?{ext:"mid",mime:"audio/midi"}:109===R[31]&&97===R[32]&&116===R[33]&&114===R[34]&&111===R[35]&&115===R[36]&&107===R[37]&&97===R[38]?{ext:"mkv",mime:"video/x-matroska"}:26===R[0]&&69===R[1]&&223===R[2]&&163===R[3]?{ext:"webm",mime:"video/webm"}:0===R[0]&&0===R[1]&&0===R[2]&&20===R[3]&&102===R[4]&&116===R[5]&&121===R[6]&&112===R[7]?{ext:"mov",mime:"video/quicktime"}:82===R[0]&&73===R[1]&&70===R[2]&&70===R[3]&&65===R[8]&&86===R[9]&&73===R[10]?{ext:"avi",mime:"video/x-msvideo"}:48===R[0]&&38===R[1]&&178===R[2]&&117===R[3]&&142===R[4]&&102===R[5]&&207===R[6]&&17===R[7]&&166===R[8]&&217===R[9]?{ext:"wmv",mime:"video/x-ms-wmv"}:0===R[0]&&0===R[1]&&1===R[2]&&"b"===R[3].toString(16)[0]?{ext:"mpg",mime:"video/mpeg"}:73===R[0]&&68===R[1]&&51===R[2]||255===R[0]&&251===R[1]?{ext:"mp3",mime:"audio/mpeg"}:102===R[4]&&116===R[5]&&121===R[6]&&112===R[7]&&77===R[8]&&52===R[9]&&65===R[10]||77===R[0]&&52===R[1]&&65===R[2]&&32===R[3]?{ext:"m4a",mime:"audio/m4a"}:79===R[28]&&112===R[29]&&117===R[30]&&115===R[31]&&72===R[32]&&101===R[33]&&97===R[34]&&100===R[35]?{ext:"opus",mime:"audio/opus"}:79===R[0]&&103===R[1]&&103===R[2]&&83===R[3]?{ext:"ogg",mime:"audio/ogg"}:102===R[0]&&76===R[1]&&97===R[2]&&67===R[3]?{ext:"flac",mime:"audio/x-flac"}:82===R[0]&&73===R[1]&&70===R[2]&&70===R[3]&&87===R[8]&&65===R[9]&&86===R[10]&&69===R[11]?{ext:"wav",mime:"audio/x-wav"}:35===R[0]&&33===R[1]&&65===R[2]&&77===R[3]&&82===R[4]&&10===R[5]?{ext:"amr",mime:"audio/amr"}:37===R[0]&&80===R[1]&&68===R[2]&&70===R[3]?{ext:"pdf",mime:"application/pdf"}:77===R[0]&&90===R[1]?{ext:"exe",mime:"application/x-msdownload"}:(67===R[0]||70===R[0])&&87===R[1]&&83===R[2]?{ext:"swf",mime:"application/x-shockwave-flash"}:123===R[0]&&92===R[1]&&114===R[2]&&116===R[3]&&102===R[4]?{ext:"rtf",mime:"application/rtf"}:119===R[0]&&79===R[1]&&70===R[2]&&70===R[3]&&(0===R[4]&&1===R[5]&&0===R[6]&&0===R[7]||79===R[4]&&84===R[5]&&84===R[6]&&79===R[7])?{ext:"woff",mime:"application/font-woff"}:119===R[0]&&79===R[1]&&70===R[2]&&50===R[3]&&(0===R[4]&&1===R[5]&&0===R[6]&&0===R[7]||79===R[4]&&84===R[5]&&84===R[6]&&79===R[7])?{ext:"woff2",mime:"application/font-woff"}:76===R[34]&&80===R[35]&&(0===R[8]&&0===R[9]&&1===R[10]||1===R[8]&&0===R[9]&&2===R[10]||2===R[8]&&0===R[9]&&2===R[10])?{ext:"eot",mime:"application/octet-stream"}:0===R[0]&&1===R[1]&&0===R[2]&&0===R[3]&&0===R[4]?{ext:"ttf",mime:"application/font-sfnt"}:79===R[0]&&84===R[1]&&84===R[2]&&79===R[3]&&0===R[4]?{ext:"otf",mime:"application/font-sfnt"}:0===R[0]&&0===R[1]&&1===R[2]&&0===R[3]?{ext:"ico",mime:"image/x-icon"}:70===R[0]&&76===R[1]&&86===R[2]&&1===R[3]?{ext:"flv",mime:"video/x-flv"}:37===R[0]&&33===R[1]?{ext:"ps",mime:"application/postscript"}:253===R[0]&&55===R[1]&&122===R[2]&&88===R[3]&&90===R[4]&&0===R[5]?{ext:"xz",mime:"application/x-xz"}:83===R[0]&&81===R[1]&&76===R[2]&&105===R[3]?{ext:"sqlite",mime:"application/x-sqlite3"}:78===R[0]&&69===R[1]&&83===R[2]&&26===R[3]?{ext:"nes",mime:"application/x-nintendo-nes-rom"}:67===R[0]&&114===R[1]&&50===R[2]&&52===R[3]?{ext:"crx",mime:"application/x-google-chrome-extension"}:77===R[0]&&83===R[1]&&67===R[2]&&70===R[3]||73===R[0]&&83===R[1]&&99===R[2]&&40===R[3]?{ext:"cab",mime:"application/vnd.ms-cab-compressed"}:33===R[0]&&60===R[1]&&97===R[2]&&114===R[3]&&99===R[4]&&104===R[5]&&62===R[6]&&10===R[7]&&100===R[8]&&101===R[9]&&98===R[10]&&105===R[11]&&97===R[12]&&110===R[13]&&45===R[14]&&98===R[15]&&105===R[16]&&110===R[17]&&97===R[18]&&114===R[19]&&121===R[20]?{ext:"deb",mime:"application/x-deb"}:33===R[0]&&60===R[1]&&97===R[2]&&114===R[3]&&99===R[4]&&104===R[5]&&62===R[6]?{ext:"ar",mime:"application/x-unix-archive"}:237===R[0]&&171===R[1]&&238===R[2]&&219===R[3]?{ext:"rpm",mime:"application/x-rpm"}:31===R[0]&&160===R[1]||31===R[0]&&157===R[1]?{ext:"Z",mime:"application/x-compress"}:76===R[0]&&90===R[1]&&73===R[2]&&80===R[3]?{ext:"lz",mime:"application/x-lzip"}:208===R[0]&&207===R[1]&&17===R[2]&&224===R[3]&&161===R[4]&&177===R[5]&&26===R[6]&&225===R[7]?{ext:"msi",mime:"application/x-msi"}:null:null}},{}],41:[function(D,I){"use strict";var R=Object.prototype.hasOwnProperty,T=Object.prototype.toString;I.exports=function(E,G,Z){if("[object Function]"!==T.call(G))throw new TypeError("iterator must be a function");var W=E.length;if(W===+W)for(var Q=0;Q<W;Q++)G.call(Z,E[Q],Q,E);else for(var $ in E)R.call(E,$)&&G.call(Z,E[$],$,E)}},{}],42:[function(D,I){"use strict";var R=Array.prototype.slice,T=Object.prototype.toString;I.exports=function(E){var G=this;if("function"!=typeof G||"[object Function]"!==T.call(G))throw new TypeError("Function.prototype.bind called on incompatible "+G);var Z=R.call(arguments,1),Q=Math.max(0,G.length-Z.length),$=[],W;for(var J=0;J<Q;J++)$.push("$"+J);if(W=Function("binder","return function ("+$.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof W){var ae=G.apply(this,Z.concat(R.call(arguments)));return Object(ae)===ae?ae:this}return G.apply(E,Z.concat(R.call(arguments)))}),G.prototype){var ee=function(){};ee.prototype=G.prototype,W.prototype=new ee,ee.prototype=null}return W}},{}],43:[function(D,I){"use strict";var R=D("./implementation");I.exports=Function.prototype.bind||R},{"./implementation":42}],44:[function(D,I,R){"use strict";var T=Object.prototype.hasOwnProperty;I.exports=R=function(E,G){return T.call(G,E)},R.version=D("./package").version},{"./package":45}],45:[function(D,I){I.exports={name:"has-own",version:"1.0.0",description:"A safer .hasOwnProperty() - hasOwn(name, obj)",main:"index.js",scripts:{test:"make test"},author:"Aaron Heckmann <aaron.heckmann+github@gmail.com>",license:"MIT",repository:{type:"git",url:"git://github.com/pebble/has-own.git"},homepage:"https://github.com/pebble/has-own/",devDependencies:{mocha:"^1.21.0"}}},{}],46:[function(D,I){"use strict";var R=D("file-type");I.exports=function(T){var L=R(T);return-1===["jpg","png","gif","webp","tif","bmp","jxr","psd"].indexOf(L&&L.ext)?null:L}},{"file-type":40}],47:[function(D,I){(function(R){"use strict";function T(){$=!0;for(var ae=J.length,ee,te;ae;){for(te=J,J=[],ee=-1;++ee<ae;)te[ee]();ae=J.length}$=!1}var L=R.MutationObserver||R.WebKitMutationObserver,E;if(L){var G=0,Z=new L(T),W=R.document.createTextNode("");Z.observe(W,{characterData:!0}),E=function(){W.data=G=++G%2}}else if(!R.setImmediate&&"undefined"!=typeof R.MessageChannel){var Q=new R.MessageChannel;Q.port1.onmessage=T,E=function(){Q.port2.postMessage(0)}}else E="document"in R&&"onreadystatechange"in R.document.createElement("script")?function(){var te=R.document.createElement("script");te.onreadystatechange=function(){T(),te.onreadystatechange=null,te.parentNode.removeChild(te),te=null},R.document.documentElement.appendChild(te)}:function(){setTimeout(T,0)};var $,J=[];I.exports=function(te){1!==J.push(te)||$||E()}}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],48:[function(D,I){"use strict";var R=8192,T=[];I.exports=class{constructor(E,G){G=G||{},E===void 0&&(E=R),"number"==typeof E&&(E=new ArrayBuffer(E));var Z=E.byteLength,W=G.offset?G.offset>>>0:0;E.buffer&&(Z=E.byteLength-W,E=E.byteLength===E.buffer.byteLength?W?E.buffer.slice(W):E.buffer:E.buffer.slice(E.byteOffset+W,E.byteOffset+E.byteLength)),this.buffer=E,this.length=Z,this.byteLength=Z,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=Z||R,this._mark=0}available(E){return void 0===E&&(E=1),this.offset+E<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(E){E===void 0&&(E=1),this.offset+=E}seek(E){this.offset=E}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(E){if(void 0===E&&(E=1),!this.available(E)){var G=this._increment+this._increment;this._increment=G;var Z=this.length+G,W=new Uint8Array(Z);W.set(new Uint8Array(this.buffer)),this.buffer=W.buffer,this.length=Z,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(E){E===void 0&&(E=1);var G=new Uint8Array(E);for(var Z=0;Z<E;Z++)G[Z]=this.readByte();return G}readInt16(){var E=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,E}readUint16(){var E=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,E}readInt32(){var E=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,E}readUint32(){var E=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,E}readFloat32(){var E=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,E}readFloat64(){var E=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,E}readChar(){return String.fromCharCode(this.readInt8())}readChars(E){E===void 0&&(E=1),T.length=E;for(var G=0;G<E;G++)T[G]=this.readChar();return T.join("")}writeBoolean(E){this.writeUint8(E?255:0)}writeInt8(E){this.ensureAvailable(1),this._data.setInt8(this.offset++,E)}writeUint8(E){this.ensureAvailable(1),this._data.setUint8(this.offset++,E)}writeByte(E){this.writeUint8(E)}writeBytes(E){this.ensureAvailable(E.length);for(var G=0;G<E.length;G++)this._data.setUint8(this.offset++,E[G])}writeInt16(E){this.ensureAvailable(2),this._data.setInt16(this.offset,E,this.littleEndian),this.offset+=2}writeUint16(E){this.ensureAvailable(2),this._data.setUint16(this.offset,E,this.littleEndian),this.offset+=2}writeInt32(E){this.ensureAvailable(4),this._data.setInt32(this.offset,E,this.littleEndian),this.offset+=4}writeUint32(E){this.ensureAvailable(4),this._data.setUint32(this.offset,E,this.littleEndian),this.offset+=4}writeFloat32(E){this.ensureAvailable(4),this._data.setFloat32(this.offset,E,this.littleEndian),this.offset+=4}writeFloat64(E){this.ensureAvailable(8),this._data.setFloat64(this.offset,E,this.littleEndian),this.offset+=8}writeChar(E){this.writeUint8(E.charCodeAt(0))}writeChars(E){for(var G=0;G<E.length;G++)this.writeUint8(E.charCodeAt(G))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}},{}],49:[function(D,I){"use strict";var R=Object.prototype.toString;I.exports=function(L){return"Array"===R.call(L).substr(-6,5)}},{}],50:[function(D,I){"use strict";var R=Function.prototype.toString,T=/^\s*class /,L=function(Q){try{var $=R.call(Q),J=$.replace(/\/\/.*\n/g,""),ee=J.replace(/\/\*[.\s\S]*\*\//g,""),te=ee.replace(/\n/mg," ").replace(/ {2}/g," ");return T.test(te)}catch(ae){return!1}},E=function(Q){try{return!L(Q)&&(R.call(Q),!0)}catch($){return!1}},G=Object.prototype.toString,Z="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;I.exports=function(Q){if(!Q)return!1;if("function"!=typeof Q&&"object"!=typeof Q)return!1;if(Z)return E(Q);if(L(Q))return!1;var $=G.call(Q);return"[object Function]"===$||"[object GeneratorFunction]"===$}},{}],51:[function(D,I){"use strict";var R=Date.prototype.getDay,T=function(Z){try{return R.call(Z),!0}catch(W){return!1}},L=Object.prototype.toString,E="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;I.exports=function(Z){return"object"!=typeof Z||null===Z?!1:E?T(Z):"[object Date]"===L.call(Z)}},{}],52:[function(D,I){"use strict";var R=D("number-is-nan");I.exports=Number.isFinite||function(T){return!("number"!=typeof T||R(T)||T===1/0||T===-(1/0))}},{"number-is-nan":116}],53:[function(D,I){"use strict";var R=D("is-finite");I.exports=Number.isInteger||function(T){return"number"==typeof T&&R(T)&&Math.floor(T)===T}},{"is-finite":52}],54:[function(D,I){"use strict";var R=RegExp.prototype.exec,T=function(Z){try{return R.call(Z),!0}catch(W){return!1}},L=Object.prototype.toString,E="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;I.exports=function(Z){return!("object"!=typeof Z)&&(E?T(Z):"[object RegExp]"===L.call(Z))}},{}],55:[function(D,I){"use strict";var R=Object.prototype.toString,T="function"==typeof Symbol&&"symbol"==typeof Symbol();if(T){var L=Symbol.prototype.toString,E=/^Symbol\(.*\)$/,G=function(W){return!("symbol"!=typeof W.valueOf())&&E.test(L.call(W))};I.exports=function(W){if("symbol"==typeof W)return!0;if("[object Symbol]"!==R.call(W))return!1;try{return G(W)}catch(Q){return!1}}}else I.exports=function(){return!1}},{}],56:[function(D,I,R){(function(T){"use strict";(function(L){if("object"==typeof R&&"undefined"!=typeof I)I.exports=L();else if("function"==typeof define&&define.amd)define([],L);else{var E;E="undefined"==typeof window?"undefined"==typeof T?"undefined"==typeof self?this:self:T:window,E.PriorityQueue=L()}})(function(){return function L(E,G,Z){function W(J,ee){if(!G[J]){if(!E[J]){var te="function"==typeof D&&D;if(!ee&&te)return te(J,!0);if(Q)return Q(J,!0);var ae=new Error("Cannot find module '"+J+"'");throw ae.code="MODULE_NOT_FOUND",ae}var ie=G[J]={exports:{}};E[J][0].call(ie.exports,function(ne){var oe=E[J][1][ne];return W(oe?oe:ne)},ie,ie.exports,L,E,G,Z)}return G[J].exports}var Q="function"==typeof D&&D;for(var $=0;$<Z.length;$++)W(Z[$]);return W}({1:[function(L,E){var J=function(ae,ie){function ne(){this.constructor=ae}for(var oe in ie)ee.call(ie,oe)&&(ae[oe]=ie[oe]);return ne.prototype=ie.prototype,ae.prototype=new ne,ae.__super__=ie.prototype,ae},ee={}.hasOwnProperty,G,Z,W,Q,$;G=L("./PriorityQueue/AbstractPriorityQueue"),Z=L("./PriorityQueue/ArrayStrategy"),Q=L("./PriorityQueue/BinaryHeapStrategy"),W=L("./PriorityQueue/BHeapStrategy"),$=function(te){function ae(ie){ie||(ie={}),ie.strategy||(ie.strategy=Q),ie.comparator||(ie.comparator=function(ne,oe){return(ne||0)-(oe||0)}),ae.__super__.constructor.call(this,ie)}return J(ae,te),ae}(G),$.ArrayStrategy=Z,$.BinaryHeapStrategy=Q,$.BHeapStrategy=W,E.exports=$},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(L,E){var G;E.exports=G=function(){function Z(W){var Q;if(null==(null==W?void 0:W.strategy))throw"Must pass options.strategy, a strategy";if(null==(null==W?void 0:W.comparator))throw"Must pass options.comparator, a comparator";this.priv=new W.strategy(W),this.length=(null==W||null==(Q=W.initialValues)?void 0:Q.length)||0}return Z.prototype.queue=function(W){return this.length++,this.priv.queue(W),void 0},Z.prototype.dequeue=function(){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},Z.prototype.peek=function(){if(!this.length)throw"Empty queue";return this.priv.peek()},Z.prototype.clear=function(){return this.length=0,this.priv.clear()},Z}()},{}],3:[function(L,E){var G,Z;Z=function(Q,$,J){var ee,te,ae;for(te=0,ee=Q.length;te<ee;)ae=te+ee>>>1,0<=J(Q[ae],$)?te=ae+1:ee=ae;return te},E.exports=G=function(){function W(Q){var $;this.options=Q,this.comparator=this.options.comparator,this.data=(null==($=this.options.initialValues)?void 0:$.slice(0))||[],this.data.sort(this.comparator).reverse()}return W.prototype.queue=function(Q){var $=Z(this.data,Q,this.comparator);return this.data.splice($,0,Q),void 0},W.prototype.dequeue=function(){return this.data.pop()},W.prototype.peek=function(){return this.data[this.data.length-1]},W.prototype.clear=function(){return this.data.length=0,void 0},W}()},{}],4:[function(L,E){var G;E.exports=G=function(){function Z(W){var Q,$,J,ee,te,ae,ie,ne,oe;for(this.comparator=(null==W?void 0:W.comparator)||function(le,se){return le-se},this.pageSize=(null==W?void 0:W.pageSize)||512,this.length=0,ne=0;1<<ne<this.pageSize;)ne+=1;if(1<<ne!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=ne,this._emptyMemoryPageTemplate=Q=[],($=J=0,ae=this.pageSize);0<=ae?J<ae:J>ae;$=0<=ae?++J:--J)Q.push(null);if(this._memory=[],this._mask=this.pageSize-1,W.initialValues)for(ie=W.initialValues,ee=0,te=ie.length;ee<te;ee++)oe=ie[ee],this.queue(oe)}return Z.prototype.queue=function(W){return this.length+=1,this._write(this.length,W),this._bubbleUp(this.length,W),void 0},Z.prototype.dequeue=function(){var W,Q;return W=this._read(1),Q=this._read(this.length),this.length-=1,0<this.length&&(this._write(1,Q),this._bubbleDown(1,Q)),W},Z.prototype.peek=function(){return this._read(1)},Z.prototype.clear=function(){return this.length=0,this._memory.length=0,void 0},Z.prototype._write=function(W,Q){for(var $=W>>this._shift;$>=this._memory.length;)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[$][W&this._mask]=Q},Z.prototype._read=function(W){return this._memory[W>>this._shift][W&this._mask]},Z.prototype._bubbleUp=function(W,Q){var $,J,ee,te;for($=this.comparator;1<W&&(J=W&this._mask,W<this.pageSize||3<J?ee=W&~this._mask|J>>1:2>J?(ee=W-this.pageSize>>this._shift,ee+=ee&~(this._mask>>1),ee|=this.pageSize>>1):ee=W-2,te=this._read(ee),!(0>$(te,Q)));)this._write(ee,Q),this._write(W,te),W=ee;0},Z.prototype._bubbleDown=function(W,Q){var $,J,ee,te,ae;for(ae=this.comparator;W<this.length;)if(W>this._mask&&!(W&this._mask-1)?$=J=W+2:W&this.pageSize>>1?($=(W&~this._mask)>>1,$|=W&this._mask>>1,$=$+1<<this._shift,J=$+1):($=W+(W&this._mask),J=$+1),$!==J&&J<=this.length){if(ee=this._read($),te=this._read(J),0>ae(ee,Q)&&0>=ae(ee,te))this._write($,Q),this._write(W,ee),W=$;else if(0>ae(te,Q))this._write(J,Q),this._write(W,te),W=J;else break;}else if(!($<=this.length))break;else if(ee=this._read($),0>ae(ee,Q))this._write($,Q),this._write(W,ee),W=$;else break;0},Z}()},{}],5:[function(L,E){var G;E.exports=G=function(){function Z(W){var Q;this.comparator=(null==W?void 0:W.comparator)||function($,J){return $-J},this.length=0,this.data=(null==(Q=W.initialValues)?void 0:Q.slice(0))||[],this._heapify()}return Z.prototype._heapify=function(){var W,Q,$;if(0<this.data.length)for(W=Q=1,$=this.data.length;1<=$?Q<$:Q>$;W=1<=$?++Q:--Q)this._bubbleUp(W);0},Z.prototype.queue=function(W){return this.data.push(W),this._bubbleUp(this.data.length-1),void 0},Z.prototype.dequeue=function(){var W,Q;return Q=this.data[0],W=this.data.pop(),0<this.data.length&&(this.data[0]=W,this._bubbleDown(0)),Q},Z.prototype.peek=function(){return this.data[0]},Z.prototype.clear=function(){return this.length=0,this.data.length=0,void 0},Z.prototype._bubbleUp=function(W){for(var Q,$;0<W&&(Q=W-1>>>1,0>this.comparator(this.data[W],this.data[Q]));)$=this.data[Q],this.data[Q]=this.data[W],this.data[W]=$,W=Q;0},Z.prototype._bubbleDown=function(W){var Q,$,J,ee,te;for(Q=this.data.length-1;$=(W<<1)+1,ee=$+1,J=W,$<=Q&&0>this.comparator(this.data[$],this.data[J])&&(J=$),ee<=Q&&0>this.comparator(this.data[ee],this.data[J])&&(J=ee),J!==W;)te=this.data[J],this.data[J]=this.data[W],this.data[W]=te,W=J;0},Z}()},{}]},{},[1])(1)})}).call(this,"undefined"==typeof global?"undefined"==typeof self?"undefined"==typeof window?{}:window:self:global)},{}],57:[function(D,I){"use strict";function R(){}function T(ae){if("function"!=typeof ae)throw new TypeError("resolver must be a function");this.state=te,this.queue=[],this.outcome=void 0,ae!==R&&Z(this,ae)}function L(ae,ie,ne){this.promise=ae,"function"==typeof ie&&(this.onFulfilled=ie,this.callFulfilled=this.otherCallFulfilled),"function"==typeof ne&&(this.onRejected=ne,this.callRejected=this.otherCallRejected)}function E(ae,ie,ne){Q(function(){var oe;try{oe=ie(ne)}catch(le){return $.reject(ae,le)}oe===ae?$.reject(ae,new TypeError("Cannot resolve promise with itself")):$.resolve(ae,oe)})}function G(ae){var ie=ae&&ae.then;if(ae&&"object"==typeof ae&&"function"==typeof ie)return function(){ie.apply(ae,arguments)}}function Z(ae,ie){function ne(de){le||(le=!0,$.reject(ae,de))}function oe(de){le||(le=!0,$.resolve(ae,de))}var le=!1,se=W(function(){ie(oe,ne)});"error"===se.status&&ne(se.value)}function W(ae,ie){var ne={};try{ne.value=ae(ie),ne.status="success"}catch(oe){ne.status="error",ne.value=oe}return ne}var Q=D("immediate"),$={},J=["REJECTED"],ee=["FULFILLED"],te=["PENDING"];I.exports=T,T.prototype["catch"]=function(ae){return this.then(null,ae)},T.prototype.then=function(ae,ie){if("function"!=typeof ae&&this.state===ee||"function"!=typeof ie&&this.state===J)return this;var ne=new this.constructor(R);if(this.state!==te){var oe=this.state===ee?ae:ie;E(ne,oe,this.outcome)}else this.queue.push(new L(ne,ae,ie));return ne},L.prototype.callFulfilled=function(ae){$.resolve(this.promise,ae)},L.prototype.otherCallFulfilled=function(ae){E(this.promise,this.onFulfilled,ae)},L.prototype.callRejected=function(ae){$.reject(this.promise,ae)},L.prototype.otherCallRejected=function(ae){E(this.promise,this.onRejected,ae)},$.resolve=function(ae,ie){var ne=W(G,ie);if("error"===ne.status)return $.reject(ae,ne.value);var oe=ne.value;if(oe)Z(ae,oe);else{ae.state=ee,ae.outcome=ie;for(var le=-1,se=ae.queue.length;++le<se;)ae.queue[le].callFulfilled(ie)}return ae},$.reject=function(ae,ie){ae.state=J,ae.outcome=ie;for(var ne=-1,oe=ae.queue.length;++ne<oe;)ae.queue[ne].callRejected(ie);return ae},T.resolve=function(ie){return ie instanceof this?ie:$.resolve(new this(R),ie)},T.reject=function(ie){var ne=new this(R);return $.reject(ne,ie)},T.all=function(ie){function ne(ce,ge){oe.resolve(ce).then(function(fe){de[ge]=fe,++ue!==le||se||(se=!0,$.resolve(me,de))},function(pe){se||(se=!0,$.reject(me,pe))})}var oe=this;if("[object Array]"!==Object.prototype.toString.call(ie))return this.reject(new TypeError("must be an array"));var le=ie.length,se=!1;if(!le)return this.resolve([]);for(var de=Array(le),ue=0,he=-1,me=new this(R);++he<le;)ne(ie[he],he);return me},T.race=function(ie){function ne(he){oe.resolve(he).then(function(me){se||(se=!0,$.resolve(ue,me))},function(me){se||(se=!0,$.reject(ue,me))})}var oe=this;if("[object Array]"!==Object.prototype.toString.call(ie))return this.reject(new TypeError("must be an array"));var le=ie.length,se=!1;if(!le)return this.resolve([]);for(var de=-1,ue=new this(R);++de<le;)ne(ie[de]);return ue}},{immediate:47}],58:[function(D,I){"use strict";function R(L){var E=Array(L[0].length);for(var G=0;G<E.length;++G)E[G]=Array(L.length);for(G=0;G<L.length;++G)for(var Z=0;Z<L[0].length;++Z)E[Z][G]=L[G][Z];return E}var T=D("ml-stat").array;I.exports={coordArrayToPoints:function(E,G){if(0!=E.length%G)throw new RangeError("Dimensions number must be accordance with the size of the array.");var Z=E.length/G,W=Array(Z),Q=0;for(var $=0;$<E.length;$+=G){var J=Array(G);for(var ee=0;ee<G;++ee)J[ee]=E[$+ee];W[Q]=J,Q++}return W},coordArrayToCoordMatrix:function(E,G){if(0!=E.length%G)throw new RangeError("Dimensions number must be accordance with the size of the array.");var Z=Array(G),W=E.length/G;for(var Q=0;Q<Z.length;Q++)Z[Q]=Array(W);for(Q=0;Q<E.length;Q+=G)for(var $=0;$<G;++$){var J=Math.floor(Q/G);Z[$][J]=E[Q+$]}return Z},coordMatrixToCoordArray:function(E){var G=Array(E.length*E[0].length),Z=0;for(var W=0;W<E[0].length;++W)for(var Q=0;Q<E.length;++Q)G[Z]=E[Q][W],++Z;return G},coordMatrixToPoints:R,pointsToCoordArray:function(E){var G=Array(E.length*E[0].length),Z=0;for(var W=0;W<E.length;++W)for(var Q=0;Q<E[0].length;++Q)G[Z]=E[W][Q],++Z;return G},pointsToCoordMatrix:R,applyDotProduct:function(E,G){var Z,W;E.length<=G.length?(W=E,Z=G):(W=G,Z=E);var Q=Z.length-W.length+1,$=Array(Q);for(var J=0;J<Q;++J){var ee=0;for(var te=0;te<W.length;++te)ee+=W[te]*Z[J+te];$[J]=ee}return $},scale:function(E,G){var Z;Z=G.inPlace?E:Array(E.length);var W=G.max,Q=G.min;if("number"==typeof W){if("number"==typeof Q){var $=T.minMax(E),J=(W-Q)/($.max-$.min);for(var ee=0;ee<Z.length;ee++)Z[ee]=(E[ee]-$.min)*J+Q}else{var te=T.max(E),J=W/te;for(var ee=0;ee<Z.length;ee++)Z[ee]=E[ee]*J}}else if("number"==typeof Q){var te=T.min(E),J=Q/te;for(var ee=0;ee<Z.length;ee++)Z[ee]=E[ee]*J}return Z}}},{"ml-stat":111}],59:[function(D,I,R){"use strict";function T(G,Z,W,Q,$){function J(ke,we,ve,Me){return(Me-we)/(ve-ke)}var ee=G.length,te=(Q-W)/($-1),ae=W-te/2,ie=Array($),ne=G[1]-G[0],oe=G[G.length-1]-G[G.length-2],le=ae,se=ae+te,de=Number.MIN_VALUE,ue=0,he=G[0]-ne,me=0,ce=0,ge=0,pe=0,fe=0,_e=0,be=0,ye=0;main:for(;!0;){for(;0<=he-se;){var xe=E(0,se-de,ge,ue);if(_e=ce+xe,ie[ye]=(_e-fe)/te,ye++,ye===$)break main;le=se,se+=te,fe=_e}de<=le&&le<=he&&(xe=E(0,le-de,ge,ue),fe=ce+xe),ce+=E(de,he,ge,pe),de=he,ue=me,be<ee?(he=G[be],me=Z[be],be++):be===ee&&(he+=oe,me=0),ge=J(de,ue,he,me),pe=-ge*de+ue}return ie}function L(G,Z,W,Q,$){var J=G.length,ee=(Q-W)/($-1),te=G[G.length-1]-G[G.length-2],ae=W-ee/2,ie=Array($),ne=ae,oe=ae+ee,le=-Number.MAX_VALUE,se=0,de=G[0],ue=Z[0],he=0,me=!0,ce=0,ge=0,pe=1,fe=0;main:for(;!0;){if(le>=de)throw new Error("x must be an increasing serie");for(;0<le-oe;){if(me&&(ge++,me=!1),ie[fe]=0>=ge?0:ce/ge,fe++,fe===$)break main;ne=oe,oe+=ee,ce=0,ge=0}le>ne&&(ce+=se,ge++),(le==-Number.MAX_VALUE||1<he)&&ge--,le=de,se=ue,pe<J?(de=G[pe],ue=Z[pe],pe++):(de+=te,ue=0,he++)}return ie}function E(G,Z,W,Q){return 0.5*W*Z*Z+Q*Z-(0.5*W*G*G+Q*G)}R.getEquallySpacedData=function(Z,W,Q){1<Z.length&&Z[0]>Z[1]&&(Z=Z.slice().reverse(),W=W.slice().reverse());var $=Z.length;if($!==W.length)throw new RangeError("the x and y vector doesn't have the same size.");Q===void 0&&(Q={});var J=Q.from===void 0?Z[0]:Q.from;if(isNaN(J)||!isFinite(J))throw new RangeError("'From' value must be a number");var ee=Q.to===void 0?Z[Z.length-1]:Q.to;if(isNaN(ee)||!isFinite(ee))throw new RangeError("'To' value must be a number");var te=J>ee;if(te){var ae=J;J=ee,ee=ae}var ie=Q.numberOfPoints===void 0?100:Q.numberOfPoints;if(isNaN(ie)||!isFinite(ie))throw new RangeError("'Number of points' value must be a number");if(1>ie)throw new RangeError("the number of point must be higher than 1");var ne="slot"===Q.variant?"slot":"smooth",oe="slot"==ne?L(Z,W,J,ee,ie):T(Z,W,J,ee,ie);return te?oe.reverse():oe},R.integral=E},{}],60:[function(D,I,R){"use strict";I.exports=R=D("./ArrayUtils"),R.getEquallySpacedData=D("./getEquallySpaced").getEquallySpacedData,R.SNV=D("./snv").SNV},{"./ArrayUtils":58,"./getEquallySpaced":59,"./snv":61}],61:[function(D,I,R){"use strict";R.SNV=function(E){var G=T.mean(E),Z=T.standardDeviation(E),W=E.slice();for(var Q=0;Q<E.length;Q++)W[Q]=(W[Q]-G)/Z;return W};var T=D("ml-stat").array},{"ml-stat":111}],62:[function(D,I){"use strict";function R(T){this.value=T,this.parent=null,this.rank=0}I.exports=class{constructor(){this.nodes=new Map}add(L){var E=this.nodes.get(L);return E||(E=new R(L),this.nodes.set(L,E)),E}union(L,E){var G=this.find(L),Z=this.find(E);G===Z||(G.rank<Z.rank?G.parent=Z:G.rank>Z.rank?Z.parent=G:(Z.parent=G,G.rank++))}find(L){for(var E=L;null!==E.parent;)E=E.parent;for(var G=L;null!==G.parent;){var Z=G;G=G.parent,Z.parent=E}return E}connected(L,E){return this.find(L)===this.find(E)}}},{}],63:[function(D,I){"use strict";function R(L,E){var G=0;for(var Z=0;Z<L.length;Z++)G+=(L[Z]-E[Z])*(L[Z]-E[Z]);return G}function T(L,E){return Math.sqrt(R(L,E))}I.exports=T,T.squared=R},{}],64:[function(D,I){"use strict";var R=D("./fftlib");I.exports={DEBUG:!1,ifft2DArray:function(L,E,G){var Z=Array(E*G),W=E/2,Q=2*(G-1);R.init(W);var $={re:Array(W),im:Array(W)};for(var J=0;J<G;J++){for(var ee=W-1;0<=ee;ee--)$.re[ee]=L[2*ee*G+J],$.im[ee]=L[(2*ee+1)*G+J];R.bt($.re,$.im);for(var ee=W-1;0<=ee;ee--)Z[2*ee*G+J]=$.re[ee],Z[(2*ee+1)*G+J]=$.im[ee]}var te=Array(W*Q);R.init(Q);var ae={re:Array(Q),im:Array(Q)};for(var ee=0;ee<E;ee+=2){ae.re[0]=Z[ee*G],ae.im[0]=Z[(ee+1)*G];for(var J=1;J<G;J++)ae.re[J]=Z[ee*G+J],ae.im[J]=Z[(ee+1)*G+J],ae.re[Q-J]=Z[ee*G+J],ae.im[Q-J]=-Z[(ee+1)*G+J];R.bt(ae.re,ae.im);var ie=ee/2*Q;for(var J=Q-1;0<=J;J--)te[ie+J]=ae.re[J]/(Q*W)}return te},fft2DArray:function(L,E,G){Object.assign({},{inplace:!0});var Z=G/2+1,W=2*E,Q=Array(W*Z);R.init(G);var $={re:Array(G),im:Array(G)},J={re:Array(G),im:Array(G)},ee={re:Array(G),im:Array(G)},te,ae,ie,ne,oe;for(var le=0;le<E/2;le++){te=2*le*G,$.re=L.slice(te,te+G),te=(2*le+1)*G,$.im=L.slice(te,te+G),R.fft1d($.re,$.im),this.reconstructTwoRealFFT($,J,ee),ae=4*le*Z,ie=(4*le+1)*Z,ne=(4*le+2)*Z,oe=(4*le+3)*Z;for(var se=Z-1;0<=se;se--)Q[ae+se]=J.re[se],Q[ie+se]=J.im[se],Q[ne+se]=ee.re[se],Q[oe+se]=ee.im[se]}J=null,ee=null;var de=Array(W*Z);R.init(E);var ue={re:Array(E),im:Array(E)};for(var he=Z-1;0<=he;he--){for(var le=E-1;0<=le;le--)ue.re[le]=Q[2*le*Z+he],ue.im[le]=Q[(2*le+1)*Z+he],isNaN(ue.re[le])&&(ue.re[le]=0),isNaN(ue.im[le])&&(ue.im[le]=0);R.fft1d(ue.re,ue.im);for(var le=E-1;0<=le;le--)de[2*le*Z+he]=ue.re[le],de[(2*le+1)*Z+he]=ue.im[le]}return de},reconstructTwoRealFFT:function(L,E,G){var Z=L.re.length;E.re[0]=L.re[0],E.im[0]=0,G.re[0]=L.im[0],G.im[0]=0;var W,Q,$,J,ee;for(var te=Z/2;0<te;te--)ee=Z-te,W=0.5*(L.re[te]-L.re[ee]),Q=0.5*(L.re[te]+L.re[ee]),$=0.5*(L.im[te]-L.im[ee]),J=0.5*(L.im[te]+L.im[ee]),E.re[te]=Q,E.im[te]=$,E.re[ee]=Q,E.im[ee]=-$,G.re[te]=J,G.im[te]=-W,G.re[ee]=J,G.im[ee]=W},convolute2DI:function(L,E,G,Z){var W,Q;for(var $=0;$<G/2;$++)for(var J=0;J<Z;J++)W=L[2*$*Z+J]*E[2*$*Z+J]-L[(2*$+1)*Z+J]*E[(2*$+1)*Z+J],Q=L[2*$*Z+J]*E[(2*$+1)*Z+J]+L[(2*$+1)*Z+J]*E[2*$*Z+J],L[2*$*Z+J]=W,L[(2*$+1)*Z+J]=Q},convolute:function(L,E,G,Z){var W=Array(Z*G);for(var Q=0;Q<G*Z;Q++)W[Q]=L[Q];W=this.fft2DArray(W,G,Z);var $=E.length,J=E[0].length,ee=Array(Z*G);for(var Q=0;Q<Z*G;Q++)ee[Q]=0;var ie=Math.floor(($-1)/2),ne=Math.floor((J-1)/2),te,ae;for(var oe=0;oe<$;oe++){te=(oe-ie+G)%G;for(var le=0;le<J;le++)ae=(le-ne+Z)%Z,ee[te*Z+ae]=E[oe][le]}ee=this.fft2DArray(ee,G,Z);var se=2*G,de=Z/2+1;return this.convolute2DI(W,ee,se,de),this.ifft2DArray(W,se,de)},toRadix2:function(L,E,G){var Z,W,Q,$,J=G,ee=E;if(0===G||0!=(G&G-1)){for(J=0;0!=G>>++J;);J=1<<J}if(0===E||0!=(E&E-1)){for(ee=0;0!=E>>++ee;);ee=1<<ee}if(ee==E&&J==G)return{data:L,rows:E,cols:G};var te=Array(ee*J),ae=Math.floor((ee-E)/2)-E,ie=Math.floor((J-G)/2)-G;for(Z=0;Z<ee;Z++)for(Q=Z*J,$=(Z-ae)%E*G,W=0;W<J;W++)te[Q+W]=L[$+(W-ie)%G];return{data:te,rows:ee,cols:J}},crop:function(L,E,G,Z,W,Q){if(E==Z&&G==W)return L;Object.assign({},Q);var $=Array(W*Z),J=Math.floor((E-Z)/2),ee=Math.floor((G-W)/2),te,ae,ie,ne;for(ie=0;ie<Z;ie++)for(te=ie*W,ae=(ie+J)*G,ne=0;ne<W;ne++)$[te+ne]=L[ae+(ne+ee)];return $}}},{"./fftlib":65}],65:[function(D,I,R){"use strict";(function(){var T;T="undefined"==typeof R?{}:R;var L={release:"0.3.0",date:"2013-03"};T.toString=function(){return"version "+L.release+", released "+L.date};var E=0,G=null,Z=null,W={init:function(ee){if(0!==ee&&0==(ee&ee-1))E=ee,W._initArray(),W._makeBitReversalTable(),W._makeCosSinTable();else throw new Error("init: radix-2 required")},fft1d:function(ee,te){W.fft(ee,te,1)},ifft1d:function(ee,te){var ae=1/E;W.fft(ee,te,-1);for(var ie=0;ie<E;ie++)ee[ie]*=ae,te[ie]*=ae},bt1d:function(ee,te){W.fft(ee,te,-1)},fft2d:function(ee,te){var ae=[],ie=[],ne=0;for(var oe=0;oe<E;oe++){ne=oe*E;for(var le=0;le<E;le++)ae[le]=ee[le+ne],ie[le]=te[le+ne];W.fft1d(ae,ie);for(var se=0;se<E;se++)ee[se+ne]=ae[se],te[se+ne]=ie[se]}for(var de=0;de<E;de++){for(var ue=0;ue<E;ue++)ne=de+ue*E,ae[ue]=ee[ne],ie[ue]=te[ne];W.fft1d(ae,ie);for(var he=0;he<E;he++)ne=de+he*E,ee[ne]=ae[he],te[ne]=ie[he]}},ifft2d:function(ee,te){var ae=[],ie=[],ne=0;for(var oe=0;oe<E;oe++){ne=oe*E;for(var le=0;le<E;le++)ae[le]=ee[le+ne],ie[le]=te[le+ne];W.ifft1d(ae,ie);for(var se=0;se<E;se++)ee[se+ne]=ae[se],te[se+ne]=ie[se]}for(var de=0;de<E;de++){for(var ue=0;ue<E;ue++)ne=de+ue*E,ae[ue]=ee[ne],ie[ue]=te[ne];W.ifft1d(ae,ie);for(var he=0;he<E;he++)ne=de+he*E,ee[ne]=ae[he],te[ne]=ie[he]}},fft:function(ee,te,ae){var ce=E>>2,ie,ne,oe,le,se,de,ue,he,me;for(var ge=0;ge<E;ge++)le=G[ge],ge<le&&(se=ee[ge],ee[ge]=ee[le],ee[le]=se,se=te[ge],te[ge]=te[le],te[le]=se);for(var pe=1;pe<E;pe<<=1){ne=0,ie=E/(pe<<1);for(var fe=0;fe<pe;fe++){de=Z[ne+ce],ue=ae*Z[ne];for(var _e=fe;_e<E;_e+=pe<<1)oe=_e+pe,he=de*ee[oe]+ue*te[oe],me=de*te[oe]-ue*ee[oe],ee[oe]=ee[_e]-he,ee[_e]+=he,te[oe]=te[_e]-me,te[_e]+=me;ne+=ie}}},_initArray:function(){G="undefined"==typeof Uint32Array?[]:new Uint32Array(E),Z="undefined"==typeof Float64Array?[]:new Float64Array(1.25*E)},_paddingZero:function(){},_makeBitReversalTable:function(){var ee=0,te=0,ae=0;for(G[0]=0;++ee<E;){for(ae=E>>1;ae<=te;)te-=ae,ae>>=1;te+=ae,G[ee]=te}},_makeCosSinTable:function(){var ee=E>>1,te=E>>2,ae=E>>3,ie=Math.sin(Math.PI/E),ne=2*ie*ie,oe=Math.sqrt(ne*(2-ne)),le=Z[te]=1,se=Z[0]=0;ie=2*ne;for(var de=1;de<ae;de++)le-=ne,ne+=ie*le,se+=oe,oe-=ie*se,Z[de]=se,Z[te-de]=le;0!=ae&&(Z[ae]=Math.sqrt(0.5));for(var ue=0;ue<te;ue++)Z[ee-ue]=Z[ue];for(var he=0;he<ee+te;he++)Z[he+ee]=-Z[he]}},Q=["init","fft1d","ifft1d","fft2d","ifft2d"];for(var $=0;$<Q.length;$++)T[Q[$]]=W[Q[$]];return T.bt=W.bt1d,T.fft=W.fft1d,T.ifft=W.ifft1d,T}).call(void 0)},{}],66:[function(D,I,R){"use strict";R.FFTUtils=D("./FFTUtils"),R.FFT=D("./fftlib")},{"./FFTUtils":64,"./fftlib":65}],67:[function(D,I){"use strict";var R=D("ml-distance-euclidean").squared,T={sigma:1};I.exports=class{constructor(E){E=Object.assign({},T,E),this.sigma=E.sigma,this.divisor=2*E.sigma*E.sigma}compute(E,G){var Z=R(E,G);return Math.exp(-Z/this.divisor)}}},{"ml-distance-euclidean":63}],68:[function(D,I){"use strict";var R={degree:1,constant:1,scale:1};I.exports=class{constructor(L){L=Object.assign({},R,L),this.degree=L.degree,this.constant=L.constant,this.scale=L.scale}compute(L,E){var G=0;for(var Z=0;Z<L.length;Z++)G+=L[Z]*E[Z];return Math.pow(this.scale*G+this.constant,this.degree)}}},{}],69:[function(D,I){"use strict";var R={alpha:0.01,constant:-Math.E};I.exports=class{constructor(L){L=Object.assign({},R,L),this.alpha=L.alpha,this.constant=L.constant}compute(L,E){var G=0;for(var Z=0;Z<L.length;Z++)G+=L[Z]*E[Z];return Math.tanh(this.alpha*G+this.constant)}}},{}],70:[function(D,I){"use strict";var R=D("ml-matrix"),T=D("ml-kernel-gaussian"),L=D("ml-kernel-polynomial"),E=D("./kernels/anova-kernel"),G=D("./kernels/cauchy-kernel"),Z=D("./kernels/exponential-kernel"),W=D("./kernels/histogram-intersection-kernel"),Q=D("./kernels/laplacian-kernel"),$=D("./kernels/multiquadratic-kernel"),J=D("./kernels/rational-quadratic-kernel"),ee=D("ml-kernel-sigmoid"),te={gaussian:T,rbf:T,polynomial:L,poly:L,anova:E,cauchy:G,exponential:Z,histogram:W,min:W,laplacian:Q,multiquadratic:$,rational:J,sigmoid:ee,mlp:ee};I.exports=class{constructor(ie,ne){if(this.kernelType=ie,"linear"!==ie)if("string"==typeof ie){ie=ie.toLowerCase();var oe=te[ie];if(oe)this.kernelFunction=new oe(ne);else throw new Error("unsupported kernel type: "+ie)}else if("object"==typeof ie&&"function"==typeof ie.compute)this.kernelFunction=ie;else throw new TypeError("first argument must be a valid kernel type or instance")}compute(ie,ne){if(void 0===ne&&(ne=ie),"linear"===this.kernelType){var oe=new R(ie);return oe.mmul(new R(ne).transpose())}var le=new R(ie.length,ne.length),se,de;if(ie===ne)for(se=0;se<ie.length;se++)for(de=se;de<ie.length;de++)le[se][de]=le[de][se]=this.kernelFunction.compute(ie[se],ie[de]);else for(se=0;se<ie.length;se++)for(de=0;de<ne.length;de++)le[se][de]=this.kernelFunction.compute(ie[se],ne[de]);return le}}},{"./kernels/anova-kernel":71,"./kernels/cauchy-kernel":72,"./kernels/exponential-kernel":73,"./kernels/histogram-intersection-kernel":74,"./kernels/laplacian-kernel":75,"./kernels/multiquadratic-kernel":76,"./kernels/rational-quadratic-kernel":77,"ml-kernel-gaussian":67,"ml-kernel-polynomial":68,"ml-kernel-sigmoid":69,"ml-matrix":87}],71:[function(D,I){"use strict";var R={sigma:1,degree:1};I.exports=class{constructor(L){L=Object.assign({},R,L),this.sigma=L.sigma,this.degree=L.degree}compute(L,E){var G=0,Z=Math.min(L.length,E.length);for(var W=1;W<=Z;++W)G+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(L[W-1],W)-Math.pow(E[W-1],W),2)),this.degree);return G}}},{}],72:[function(D,I){"use strict";var R=D("ml-distance-euclidean").squared,T={sigma:1};I.exports=class{constructor(E){E=Object.assign({},T,E),this.sigma=E.sigma}compute(E,G){return 1/(1+R(E,G)/(this.sigma*this.sigma))}}},{"ml-distance-euclidean":63}],73:[function(D,I){"use strict";var R=D("ml-distance-euclidean"),T={sigma:1};I.exports=class{constructor(E){E=Object.assign({},T,E),this.sigma=E.sigma,this.divisor=2*E.sigma*E.sigma}compute(E,G){var Z=R(E,G);return Math.exp(-Z/this.divisor)}}},{"ml-distance-euclidean":63}],74:[function(D,I){"use strict";I.exports=class{compute(T,L){var E=Math.min(T.length,L.length),G=0;for(var Z=0;Z<E;++Z)G+=Math.min(T[Z],L[Z]);return G}}},{}],75:[function(D,I){"use strict";var R=D("ml-distance-euclidean"),T={sigma:1};I.exports=class{constructor(E){E=Object.assign({},T,E),this.sigma=E.sigma}compute(E,G){var Z=R(E,G);return Math.exp(-Z/this.sigma)}}},{"ml-distance-euclidean":63}],76:[function(D,I){"use strict";var R=D("ml-distance-euclidean").squared,T={constant:1};I.exports=class{constructor(E){E=Object.assign({},T,E),this.constant=E.constant}compute(E,G){return Math.sqrt(R(E,G)+this.constant*this.constant)}}},{"ml-distance-euclidean":63}],77:[function(D,I){"use strict";var R=D("ml-distance-euclidean").squared,T={constant:1};I.exports=class{constructor(E){E=Object.assign({},T,E),this.constant=E.constant}compute(E,G){var Z=R(E,G);return 1-Z/(Z+this.constant)}}},{"ml-distance-euclidean":63}],78:[function(D,I){"use strict";"use strict;";function R(L){var E=L,G,Z;if("number"!=typeof L[0]){G=L.length,Z=L[0].length,E=Array(G*Z);for(var W=0;W<G;W++)for(var Q=0;Q<Z;Q++)E[W*Z+Q]=L[W][Q]}else{var $=Math.sqrt(L.length);Number.isInteger($)&&(G=$,Z=$)}return{data:E,rows:G,cols:Z}}var T=D("ml-fft").FFTUtils;I.exports={fft:function(E,G,Z){var W=R(E),Q=W.data,$=Object.assign({normalize:!1,divisor:1,rows:W.rows,cols:W.cols},Z),J,ee;if($.rows&&$.cols)J=$.rows,ee=$.cols;else throw new Error("Invalid number of rows or columns "+J+" "+ee);var te=$.divisor,ne=G.length,oe=G[0].length,ae,ie;if($.normalize)for(te=0,ae=0;ae<ne;ae++)for(ie=0;ie<oe;ie++)te+=G[ae][ie];if(0===te)throw new RangeError("convolution: The divisor is equal to zero");var le=T.toRadix2(Q,J,ee),se=T.convolute(le.data,G,le.rows,le.cols);if(se=T.crop(se,le.rows,le.cols,J,ee),0!=te&&1!=te)for(ae=0;ae<se.length;ae++)se[ae]/=te;return se},direct:function(E,G,Z){var W=R(E),Q=W.data,$=Object.assign({normalize:!1,divisor:1,rows:W.rows,cols:W.cols},Z),J,ee;if($.rows&&$.cols)J=$.rows,ee=$.cols;else throw new Error("Invalid number of rows or columns "+J+" "+ee);var te=$.divisor,ae=G.length,ie=G[0].length,ne,oe,le,se,de,ue,he,me,ce;if($.normalize)for(te=0,ne=0;ne<ae;ne++)for(oe=0;oe<ie;oe++)te+=G[ne][oe];if(0===te)throw new RangeError("convolution: The divisor is equal to zero");var ge=Array(J*ee),pe=Math.floor(ae/2),fe=Math.floor(ie/2);for(se=0;se<J;se++)for(le=0;le<ee;le++){for(ue=0,oe=0;oe<ae;oe++)for(ne=0;ne<ie;ne++)he=G[ae-oe-1][ie-ne-1],me=(se+oe-pe+J)%J,ce=(le+ne-fe+ee)%ee,de=me*ee+ce,ue+=Q[de]*he;de=se*ee+le,ge[de]=ue/te}return ge},kernelFactory:{LoG:function(E,G,Z){var W=1e3;Z&&Z.factor&&(W=Z.factor);var Q=Array(G),$,J,ee,te;W*=-1;var ae=(G-1)/2;for($=0;$<G;$++)for(Q[$]=Array(G),te=($-ae)*($-ae),J=0;J<G;J++)ee=-((J-ae)*(J-ae)+te)/(2*E*E),Q[$][J]=Math.round(W*(1+ee)*Math.exp(ee));return Q}},matrix2Array:R}},{"ml-fft":66}],79:[function(require,module){"use strict";module.exports=function(superCtor){function compareNumbers(D,I){return D-I}function fillTemplateFunction(D,I){for(var R in I)D=D.replace(new RegExp("%"+R+"%","g"),I[R]);return D}superCtor===void 0&&(superCtor=Object);class D extends superCtor{static get[Symbol.species](){return this}static from1DArray(I,R,T){if(I*R!==T.length)throw new RangeError("Data length does not match given dimensions");var L=new this(I,R);for(var E=0;E<I;E++)for(var G=0;G<R;G++)L.set(E,G,T[E*R+G]);return L}static rowVector(I){var R=new this(1,I.length);for(var T=0;T<I.length;T++)R.set(0,T,I[T]);return R}static columnVector(I){var R=new this(I.length,1);for(var T=0;T<I.length;T++)R.set(T,0,I[T]);return R}static empty(I,R){return new this(I,R)}static zeros(I,R){return this.empty(I,R).fill(0)}static ones(I,R){return this.empty(I,R).fill(1)}static rand(I,R,T){T===void 0&&(T=Math.random);var L=this.empty(I,R);for(var E=0;E<I;E++)for(var G=0;G<R;G++)L.set(E,G,T());return L}static randInt(I,R,T,L){T===void 0&&(T=1e3),L===void 0&&(L=Math.random);var E=this.empty(I,R);for(var G=0;G<I;G++)for(var Z=0;Z<R;Z++){var W=Math.floor(L()*T);E.set(G,Z,W)}return E}static eye(I,R,T){T===void 0&&(T=1),R===void 0&&(R=I);var L=Math.min(I,R),E=this.zeros(I,R);for(var G=0;G<L;G++)E.set(G,G,T);return E}static diag(I,R,T){var L=I.length;R===void 0&&(R=L),T===void 0&&(T=R);var E=Math.min(L,R,T),G=this.zeros(R,T);for(var Z=0;Z<E;Z++)G.set(Z,Z,I[Z]);return G}static min(I,R){I=this.checkMatrix(I),R=this.checkMatrix(R);var T=I.rows,L=I.columns,E=new this(T,L);for(var G=0;G<T;G++)for(var Z=0;Z<L;Z++)E.set(G,Z,Math.min(I.get(G,Z),R.get(G,Z)));return E}static max(I,R){I=this.checkMatrix(I),R=this.checkMatrix(R);var T=I.rows,L=I.columns,E=new this(T,L);for(var G=0;G<T;G++)for(var Z=0;Z<L;Z++)E.set(G,Z,Math.max(I.get(G,Z),R.get(G,Z)));return E}static checkMatrix(I){return D.isMatrix(I)?I:new this(I)}static isMatrix(I){return null!=I&&"Matrix"===I.klass}get size(){return this.rows*this.columns}apply(I){if("function"!=typeof I)throw new TypeError("callback must be a function");var R=this.rows,T=this.columns;for(var L=0;L<R;L++)for(var E=0;E<T;E++)I.call(this,L,E);return this}to1DArray(){var I=Array(this.size);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)I[R*this.columns+T]=this.get(R,T);return I}to2DArray(){var I=Array(this.rows);for(var R=0;R<this.rows;R++){I[R]=Array(this.columns);for(var T=0;T<this.columns;T++)I[R][T]=this.get(R,T)}return I}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var I=0;I<this.rows;I++)for(var R=0;R<=I;R++)if(this.get(I,R)!==this.get(R,I))return!1;return!0}return!1}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(I,R){I=I||1,R=R||1;var T=new this.constructor[Symbol.species](this.rows*I,this.columns*R);for(var L=0;L<I;L++)for(var E=0;E<R;E++)T.setSubMatrix(this,this.rows*L,this.columns*E);return T}fill(I){for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,I);return this}neg(){return this.mulS(-1)}getRow(I){util.checkRowIndex(this,I);var R=Array(this.columns);for(var T=0;T<this.columns;T++)R[T]=this.get(I,T);return R}getRowVector(I){return this.constructor.rowVector(this.getRow(I))}setRow(I,R){util.checkRowIndex(this,I),R=util.checkRowVector(this,R);for(var T=0;T<this.columns;T++)this.set(I,T,R[T]);return this}swapRows(I,R){util.checkRowIndex(this,I),util.checkRowIndex(this,R);for(var T=0;T<this.columns;T++){var L=this.get(I,T);this.set(I,T,this.get(R,T)),this.set(R,T,L)}return this}getColumn(I){util.checkColumnIndex(this,I);var R=Array(this.rows);for(var T=0;T<this.rows;T++)R[T]=this.get(T,I);return R}getColumnVector(I){return this.constructor.columnVector(this.getColumn(I))}setColumn(I,R){util.checkColumnIndex(this,I),R=util.checkColumnVector(this,R);for(var T=0;T<this.rows;T++)this.set(T,I,R[T]);return this}swapColumns(I,R){util.checkColumnIndex(this,I),util.checkColumnIndex(this,R);for(var T=0;T<this.rows;T++){var L=this.get(T,I);this.set(T,I,this.get(T,R)),this.set(T,R,L)}return this}addRowVector(I){I=util.checkRowVector(this,I);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,this.get(R,T)+I[T]);return this}subRowVector(I){I=util.checkRowVector(this,I);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,this.get(R,T)-I[T]);return this}mulRowVector(I){I=util.checkRowVector(this,I);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,this.get(R,T)*I[T]);return this}divRowVector(I){I=util.checkRowVector(this,I);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,this.get(R,T)/I[T]);return this}addColumnVector(I){I=util.checkColumnVector(this,I);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,this.get(R,T)+I[R]);return this}subColumnVector(I){I=util.checkColumnVector(this,I);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,this.get(R,T)-I[R]);return this}mulColumnVector(I){I=util.checkColumnVector(this,I);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,this.get(R,T)*I[R]);return this}divColumnVector(I){I=util.checkColumnVector(this,I);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.set(R,T,this.get(R,T)/I[R]);return this}mulRow(I,R){util.checkRowIndex(this,I);for(var T=0;T<this.columns;T++)this.set(I,T,this.get(I,T)*R);return this}mulColumn(I,R){util.checkColumnIndex(this,I);for(var T=0;T<this.rows;T++)this.set(T,I,this.get(T,I)*R)}max(){var I=this.get(0,0);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.get(R,T)>I&&(I=this.get(R,T));return I}maxIndex(){var I=this.get(0,0),R=[0,0];for(var T=0;T<this.rows;T++)for(var L=0;L<this.columns;L++)this.get(T,L)>I&&(I=this.get(T,L),R[0]=T,R[1]=L);return R}min(){var I=this.get(0,0);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)this.get(R,T)<I&&(I=this.get(R,T));return I}minIndex(){var I=this.get(0,0),R=[0,0];for(var T=0;T<this.rows;T++)for(var L=0;L<this.columns;L++)this.get(T,L)<I&&(I=this.get(T,L),R[0]=T,R[1]=L);return R}maxRow(I){util.checkRowIndex(this,I);var R=this.get(I,0);for(var T=1;T<this.columns;T++)this.get(I,T)>R&&(R=this.get(I,T));return R}maxRowIndex(I){util.checkRowIndex(this,I);var R=this.get(I,0),T=[I,0];for(var L=1;L<this.columns;L++)this.get(I,L)>R&&(R=this.get(I,L),T[1]=L);return T}minRow(I){util.checkRowIndex(this,I);var R=this.get(I,0);for(var T=1;T<this.columns;T++)this.get(I,T)<R&&(R=this.get(I,T));return R}minRowIndex(I){util.checkRowIndex(this,I);var R=this.get(I,0),T=[I,0];for(var L=1;L<this.columns;L++)this.get(I,L)<R&&(R=this.get(I,L),T[1]=L);return T}maxColumn(I){util.checkColumnIndex(this,I);var R=this.get(0,I);for(var T=1;T<this.rows;T++)this.get(T,I)>R&&(R=this.get(T,I));return R}maxColumnIndex(I){util.checkColumnIndex(this,I);var R=this.get(0,I),T=[0,I];for(var L=1;L<this.rows;L++)this.get(L,I)>R&&(R=this.get(L,I),T[0]=L);return T}minColumn(I){util.checkColumnIndex(this,I);var R=this.get(0,I);for(var T=1;T<this.rows;T++)this.get(T,I)<R&&(R=this.get(T,I));return R}minColumnIndex(I){util.checkColumnIndex(this,I);var R=this.get(0,I),T=[0,I];for(var L=1;L<this.rows;L++)this.get(L,I)<R&&(R=this.get(L,I),T[0]=L);return T}diag(){var I=Math.min(this.rows,this.columns),R=Array(I);for(var T=0;T<I;T++)R[T]=this.get(T,T);return R}sum(){var I=0;for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)I+=this.get(R,T);return I}mean(){return this.sum()/this.size}prod(){var I=1;for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)I*=this.get(R,T);return I}cumulativeSum(){var I=0;for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)I+=this.get(R,T),this.set(R,T,I);return this}dot(I){D.isMatrix(I)&&(I=I.to1DArray());var R=this.to1DArray();if(R.length!==I.length)throw new RangeError("vectors do not have the same size");var T=0;for(var L=0;L<R.length;L++)T+=R[L]*I[L];return T}mmul(I){I=this.constructor.checkMatrix(I),this.columns!==I.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");var R=this.rows,T=this.columns,L=I.columns,E=new this.constructor[Symbol.species](R,L),G=Array(T);for(var Z=0;Z<L;Z++){for(var W=0;W<T;W++)G[W]=I.get(W,Z);for(var Q=0;Q<R;Q++){var $=0;for(W=0;W<T;W++)$+=this.get(Q,W)*G[W];E.set(Q,Z,$)}}return E}strassen_2x2(I){var R=new this.constructor[Symbol.species](2,2),T=this.get(0,0),L=I.get(0,0),E=this.get(0,1),G=I.get(0,1),Z=this.get(1,0),W=I.get(1,0),Q=this.get(1,1),$=I.get(1,1),J=(T+Q)*(L+$),ee=(Z+Q)*L,te=T*(G-$),ae=Q*(W-L),ie=(T+E)*$;return R.set(0,0,J+ae-ie+(E-Q)*(W+$)),R.set(0,1,te+ie),R.set(1,0,ee+ae),R.set(1,1,J-ee+te+(Z-T)*(L+G)),R}strassen_3x3(I){var R=new this.constructor[Symbol.species](3,3),T=this.get(0,0),L=this.get(0,1),E=this.get(0,2),G=this.get(1,0),Z=this.get(1,1),W=this.get(1,2),Q=this.get(2,0),$=this.get(2,1),J=this.get(2,2),ee=I.get(0,0),te=I.get(0,1),ae=I.get(0,2),ie=I.get(1,0),ne=I.get(1,1),oe=I.get(1,2),le=I.get(2,0),se=I.get(2,1),de=I.get(2,2),ue=(T-G)*(-te+ne),he=(-T+G+Z)*(ee-te+ne),me=(G+Z)*(-ee+te),ce=T*ee,ge=(-T+Q+$)*(ee-ae+oe),pe=(-T+Q)*(ae-oe),fe=(Q+$)*(-ee+ae),_e=(-E+$+J)*(ne+le-se),be=(E-J)*(ne-se),ye=E*le,xe=($+J)*(-le+se),ke=(-E+Z+W)*(oe+le-de),we=(E-W)*(oe-de),ve=(Z+W)*(-le+de);return R.set(0,0,ce+ye+L*ie),R.set(0,1,(T+L+E-G-Z-$-J)*ne+he+me+ce+_e+ye+xe),R.set(0,2,ce+ge+fe+(T+L+E-Z-W-Q-$)*oe+ye+ke+ve),R.set(1,0,ue+Z*(-ee+te+ie-ne-oe-le+de)+he+ce+ye+ke+we),R.set(1,1,ue+he+me+ce+W*se),R.set(1,2,ye+ke+we+ve+G*ae),R.set(2,0,ce+ge+pe+$*(-ee+ae+ie-ne-oe-le+se)+_e+be+ye),R.set(2,1,_e+be+ye+xe+Q*te),R.set(2,2,ce+ge+pe+fe+J*de),R}mmul_strassen(I){function R(ee,te,ae){var ie=ee.rows,ne=ee.columns;if(ie==te&&ne==ae)return ee;var oe=D.zeros(te,ae);return oe=oe.setSubMatrix(ee,0,0),oe}function T(ee,te,ae,ie){if(512>=ae||512>=ie)return ee.mmul(te);1==ae%2&&1==ie%2?(ee=R(ee,ae+1,ie+1),te=R(te,ae+1,ie+1)):1==ae%2?(ee=R(ee,ae+1,ie),te=R(te,ae+1,ie)):1==ie%2&&(ee=R(ee,ae,ie+1),te=R(te,ae,ie+1));var ne=parseInt(ee.rows/2),oe=parseInt(ee.columns/2),le=ee.subMatrix(0,ne-1,0,oe-1),se=te.subMatrix(0,ne-1,0,oe-1),de=ee.subMatrix(0,ne-1,oe,ee.columns-1),ue=te.subMatrix(0,ne-1,oe,te.columns-1),he=ee.subMatrix(ne,ee.rows-1,0,oe-1),me=te.subMatrix(ne,te.rows-1,0,oe-1),ce=ee.subMatrix(ne,ee.rows-1,oe,ee.columns-1),ge=te.subMatrix(ne,te.rows-1,oe,te.columns-1),pe=T(D.add(le,ce),D.add(se,ge),ne,oe),fe=T(D.add(he,ce),se,ne,oe),_e=T(le,D.sub(ue,ge),ne,oe),be=T(ce,D.sub(me,se),ne,oe),ye=T(D.add(le,de),ge,ne,oe),xe=T(D.sub(he,le),D.add(se,ue),ne,oe),ke=T(D.sub(de,ce),D.add(me,ge),ne,oe),we=D.add(pe,be);we.sub(ye),we.add(ke);var ve=D.add(_e,ye),Me=D.add(fe,be),je=D.sub(pe,fe);je.add(_e),je.add(xe);var Pe=D.zeros(2*we.rows,2*we.columns);return Pe=Pe.setSubMatrix(we,0,0),Pe=Pe.setSubMatrix(ve,we.rows,0),Pe=Pe.setSubMatrix(Me,0,we.columns),Pe=Pe.setSubMatrix(je,we.rows,we.columns),Pe.subMatrix(0,ae-1,0,ie-1)}var L=this.clone(),E=L.rows,G=L.columns,Z=I.rows,W=I.columns;G!=Z&&console.log(`Multiplying ${E} x ${G} and ${Z} x ${W} matrix: dimensions do not match.`);var Q=Math.max(E,Z),$=Math.max(G,W),L=R(L,Q,$),I=R(I,Q,$),J=T(L,I,Q,$);return J}scaleRows(I,R){if(I=void 0===I?0:I,R=void 0===R?1:R,I>=R)throw new RangeError("min should be strictly smaller than max");var T=this.constructor.empty(this.rows,this.columns);for(var L=0;L<this.rows;L++){var E=arrayUtils.scale(this.getRow(L),{min:I,max:R});T.setRow(L,E)}return T}scaleColumns(I,R){if(I=void 0===I?0:I,R=void 0===R?1:R,I>=R)throw new RangeError("min should be strictly smaller than max");var T=this.constructor.empty(this.rows,this.columns);for(var L=0;L<this.columns;L++){var E=arrayUtils.scale(this.getColumn(L),{min:I,max:R});T.setColumn(L,E)}return T}kroneckerProduct(I){I=this.constructor.checkMatrix(I);var R=this.rows,T=this.columns,L=I.rows,E=I.columns,G=new this.constructor[Symbol.species](R*L,T*E);for(var Z=0;Z<R;Z++)for(var W=0;W<T;W++)for(var Q=0;Q<L;Q++)for(var $=0;$<E;$++)G[L*Z+Q][E*W+$]=this.get(Z,W)*I.get(Q,$);return G}transpose(){var I=new this.constructor[Symbol.species](this.columns,this.rows);for(var R=0;R<this.rows;R++)for(var T=0;T<this.columns;T++)I.set(T,R,this.get(R,T));return I}sortRows(I){I===void 0&&(I=compareNumbers);for(var R=0;R<this.rows;R++)this.setRow(R,this.getRow(R).sort(I));return this}sortColumns(I){I===void 0&&(I=compareNumbers);for(var R=0;R<this.columns;R++)this.setColumn(R,this.getColumn(R).sort(I));return this}subMatrix(I,R,T,L){util.checkRange(this,I,R,T,L);var E=new this.constructor[Symbol.species](R-I+1,L-T+1);for(var G=I;G<=R;G++)for(var Z=T;Z<=L;Z++)E[G-I][Z-T]=this.get(G,Z);return E}subMatrixRow(I,R,T){if(void 0===R&&(R=0),void 0===T&&(T=this.columns-1),R>T||0>R||R>=this.columns||0>T||T>=this.columns)throw new RangeError("Argument out of range");var L=new this.constructor[Symbol.species](I.length,T-R+1);for(var E=0;E<I.length;E++)for(var G=R;G<=T;G++){if(0>I[E]||I[E]>=this.rows)throw new RangeError("Row index out of range: "+I[E]);L.set(E,G-R,this.get(I[E],G))}return L}subMatrixColumn(I,R,T){if(void 0===R&&(R=0),void 0===T&&(T=this.rows-1),R>T||0>R||R>=this.rows||0>T||T>=this.rows)throw new RangeError("Argument out of range");var L=new this.constructor[Symbol.species](T-R+1,I.length);for(var E=0;E<I.length;E++)for(var G=R;G<=T;G++){if(0>I[E]||I[E]>=this.columns)throw new RangeError("Column index out of range: "+I[E]);L.set(G-R,E,this.get(G,I[E]))}return L}setSubMatrix(I,R,T){I=this.constructor.checkMatrix(I);var L=R+I.rows-1,E=T+I.columns-1;util.checkRange(this,R,L,T,E);for(var G=0;G<I.rows;G++)for(var Z=0;Z<I.columns;Z++)this[R+G][T+Z]=I.get(G,Z);return this}selection(I,R){var T=util.checkIndices(this,I,R),L=new this.constructor[Symbol.species](I.length,R.length);for(var E=0;E<T.row.length;E++){var G=T.row[E];for(var Z=0;Z<T.column.length;Z++){var W=T.column[Z];L[E][Z]=this.get(G,W)}}return L}trace(){var I=Math.min(this.rows,this.columns),R=0;for(var T=0;T<I;T++)R+=this.get(T,T);return R}transposeView(){return new MatrixTransposeView(this)}rowView(I){return util.checkRowIndex(this,I),new MatrixRowView(this,I)}columnView(I){return util.checkColumnIndex(this,I),new MatrixColumnView(this,I)}flipRowView(){return new MatrixFlipRowView(this)}flipColumnView(){return new MatrixFlipColumnView(this)}subMatrixView(I,R,T,L){return new MatrixSubView(this,I,R,T,L)}selectionView(I,R){return new MatrixSelectionView(this,I,R)}}D.prototype.klass="Matrix",D.random=D.rand,D.diagonal=D.diag,D.prototype.diagonal=D.prototype.diag,D.identity=D.eye,D.prototype.negate=D.prototype.neg,D.prototype.tensorProduct=D.prototype.kroneckerProduct;var inplaceOperator=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,inplaceOperatorScalar=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,inplaceOperatorMatrix=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,staticOperator=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,inplaceMethod=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,staticMethod=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,inplaceMethodWithArgs=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,staticMethodWithArgs=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,inplaceMethodWithOneArgScalar=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,inplaceMethodWithOneArgMatrix=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,inplaceMethodWithOneArg=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,operators=[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]];for(var operator of operators){var inplaceOp=eval(fillTemplateFunction(inplaceOperator,{name:operator[1],op:operator[0]})),inplaceOpS=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[1]+"S",op:operator[0]})),inplaceOpM=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[1]+"M",op:operator[0]})),staticOp=eval(fillTemplateFunction(staticOperator,{name:operator[1]}));for(var i=1;i<operator.length;i++)D.prototype[operator[i]]=inplaceOp,D.prototype[operator[i]+"S"]=inplaceOpS,D.prototype[operator[i]+"M"]=inplaceOpM,D[operator[i]]=staticOp}var methods=[["~","not"]];["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(D){methods.push(["Math."+D,D])});for(var method of methods){var inplaceMeth=eval(fillTemplateFunction(inplaceMethod,{name:method[1],method:method[0]})),staticMeth=eval(fillTemplateFunction(staticMethod,{name:method[1]}));for(var i=1;i<method.length;i++)D.prototype[method[i]]=inplaceMeth,D[method[i]]=staticMeth}var methodsWithArgs=[["Math.pow",1,"pow"]];for(var methodWithArg of methodsWithArgs){var args="arg0";for(var i=1;i<methodWithArg[1];i++)args+=`, arg${i}`;if(1!==methodWithArg[1]){var inplaceMethWithArgs=eval(fillTemplateFunction(inplaceMethodWithArgs,{name:methodWithArg[2],method:methodWithArg[0],args:args})),staticMethWithArgs=eval(fillTemplateFunction(staticMethodWithArgs,{name:methodWithArg[2],args:args}));for(var i=2;i<methodWithArg.length;i++)D.prototype[methodWithArg[i]]=inplaceMethWithArgs,D[methodWithArg[i]]=staticMethWithArgs}else{var tmplVar={name:methodWithArg[2],args:args,method:methodWithArg[0]},inplaceMethod=eval(fillTemplateFunction(inplaceMethodWithOneArg,tmplVar)),inplaceMethodS=eval(fillTemplateFunction(inplaceMethodWithOneArgScalar,tmplVar)),inplaceMethodM=eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix,tmplVar)),staticMethod=eval(fillTemplateFunction(staticMethodWithArgs,tmplVar));for(var i=2;i<methodWithArg.length;i++)D.prototype[methodWithArg[i]]=inplaceMethod,D.prototype[methodWithArg[i]+"M"]=inplaceMethodM,D.prototype[methodWithArg[i]+"S"]=inplaceMethodS,D[methodWithArg[i]]=staticMethod}}return D};var arrayUtils=require("ml-array-utils"),util=require("./util"),MatrixTransposeView=require("./views/transpose"),MatrixRowView=require("./views/row"),MatrixSubView=require("./views/sub"),MatrixSelectionView=require("./views/selection"),MatrixColumnView=require("./views/column"),MatrixFlipRowView=require("./views/flipRow"),MatrixFlipColumnView=require("./views/flipColumn")},{"./util":90,"./views/column":92,"./views/flipColumn":93,"./views/flipRow":94,"./views/row":95,"./views/selection":96,"./views/sub":97,"./views/transpose":98,"ml-array-utils":60}],80:[function(D,I){"use strict";function R(L){if(!(this instanceof R))return new R(L);if(L=T.checkMatrix(L),!L.isSymmetric())throw new Error("Matrix is not symmetric");var E=L,G=E.rows,Z=new T(G,G),W=!0,Q,$,J;for($=0;$<G;$++){var ee=Z[$],te=0;for(J=0;J<$;J++){var ae=Z[J],ie=0;for(Q=0;Q<J;Q++)ie+=ae[Q]*ee[Q];ee[J]=ie=(E[$][J]-ie)/Z[J][J],te=te+ie*ie}for(te=E[$][$]-te,W&=0<te,Z[$][$]=Math.sqrt(Math.max(te,0)),J=$+1;J<G;J++)Z[$][J]=0}if(!W)throw new Error("Matrix is not positive definite");this.L=Z}var T=D("../matrix");R.prototype={get lowerTriangularMatrix(){return this.L},solve:function(E){E=T.checkMatrix(E);var G=this.L,Z=G.rows;if(E.rows!==Z)throw new Error("Matrix dimensions do not match");var W=E.columns,Q=E.clone(),$,J,ee;for(ee=0;ee<Z;ee++)for(J=0;J<W;J++){for($=0;$<ee;$++)Q[ee][J]-=Q[$][J]*G[ee][$];Q[ee][J]/=G[ee][ee]}for(ee=Z-1;0<=ee;ee--)for(J=0;J<W;J++){for($=ee+1;$<Z;$++)Q[ee][J]-=Q[$][J]*G[$][ee];Q[ee][J]/=G[ee][ee]}return Q}},I.exports=R},{"../matrix":88}],81:[function(D,I){"use strict";function R(te,ae){if(ae=Object.assign({},ee,ae),!(this instanceof R))return new R(te,ae);if(te=W.checkMatrix(te),!te.isSquare())throw new Error("Matrix is not a square matrix");var ie=te.columns,ne=J(ie,ie,0),oe=Array(ie),le=Array(ie),se=te,he=!1,de,ue;if(he=!!ae.assumeSymmetric||te.isSymmetric(),he){for(de=0;de<ie;de++)for(ue=0;ue<ie;ue++)ne[de][ue]=se.get(de,ue);T(ie,le,oe,ne),L(ie,le,oe,ne)}else{var me=J(ie,ie,0),ce=Array(ie);for(ue=0;ue<ie;ue++)for(de=0;de<ie;de++)me[de][ue]=se.get(de,ue);E(ie,me,ce,ne),G(ie,le,oe,ne,me)}this.n=ie,this.e=le,this.d=oe,this.V=ne}function T(te,ae,ie,ne){var oe,le,se,de,ue,he,me,ce;for(ue=0;ue<te;ue++)ie[ue]=ne[te-1][ue];for(de=te-1;0<de;de--){for(ce=0,se=0,he=0;he<de;he++)ce=ce+Math.abs(ie[he]);if(0===ce)for(ae[de]=ie[de-1],ue=0;ue<de;ue++)ie[ue]=ne[de-1][ue],ne[de][ue]=0,ne[ue][de]=0;else{for(he=0;he<de;he++)ie[he]/=ce,se+=ie[he]*ie[he];for(oe=ie[de-1],le=Math.sqrt(se),0<oe&&(le=-le),ae[de]=ce*le,se=se-oe*le,ie[de-1]=oe-le,ue=0;ue<de;ue++)ae[ue]=0;for(ue=0;ue<de;ue++){for(oe=ie[ue],ne[ue][de]=oe,le=ae[ue]+ne[ue][ue]*oe,he=ue+1;he<=de-1;he++)le+=ne[he][ue]*ie[he],ae[he]+=ne[he][ue]*oe;ae[ue]=le}for(oe=0,ue=0;ue<de;ue++)ae[ue]/=se,oe+=ae[ue]*ie[ue];for(me=oe/(se+se),ue=0;ue<de;ue++)ae[ue]-=me*ie[ue];for(ue=0;ue<de;ue++){for(oe=ie[ue],le=ae[ue],he=ue;he<=de-1;he++)ne[he][ue]-=oe*ae[he]+le*ie[he];ie[ue]=ne[de-1][ue],ne[de][ue]=0}}ie[de]=se}for(de=0;de<te-1;de++){if(ne[te-1][de]=ne[de][de],ne[de][de]=1,se=ie[de+1],0!==se){for(he=0;he<=de;he++)ie[he]=ne[he][de+1]/se;for(ue=0;ue<=de;ue++){for(le=0,he=0;he<=de;he++)le+=ne[he][de+1]*ne[he][ue];for(he=0;he<=de;he++)ne[he][ue]-=le*ie[he]}}for(he=0;he<=de;he++)ne[he][de+1]=0}for(ue=0;ue<te;ue++)ie[ue]=ne[te-1][ue],ne[te-1][ue]=0;ne[te-1][te-1]=1,ae[0]=0}function L(te,ae,ie,ne){var oe,le,se,de,ue,he,me,ce,ge,pe,fe,_e,be,ye,xe,ke,we;for(se=1;se<te;se++)ae[se-1]=ae[se];ae[te-1]=0;var ve=0,Me=0,je=Math.pow(2,-52);for(he=0;he<te;he++){for(Me=Math.max(Me,Math.abs(ie[he])+Math.abs(ae[he])),me=he;me<te&&!(Math.abs(ae[me])<=je*Me);)me++;if(me>he){we=0;do{for(we=we+1,oe=ie[he],ce=(ie[he+1]-oe)/(2*ae[he]),ge=$(ce,1),0>ce&&(ge=-ge),ie[he]=ae[he]/(ce+ge),ie[he+1]=ae[he]*(ce+ge),pe=ie[he+1],le=oe-ie[he],se=he+2;se<te;se++)ie[se]-=le;for(ve=ve+le,ce=ie[me],fe=1,_e=fe,be=fe,ye=ae[he+1],xe=0,ke=0,se=me-1;se>=he;se--)for(be=_e,_e=fe,ke=xe,oe=fe*ae[se],le=fe*ce,ge=$(ce,ae[se]),ae[se+1]=xe*ge,xe=ae[se]/ge,fe=ce/ge,ce=fe*ie[se]-xe*oe,ie[se+1]=le+xe*(fe*oe+xe*ie[se]),ue=0;ue<te;ue++)le=ne[ue][se+1],ne[ue][se+1]=xe*ne[ue][se]+fe*le,ne[ue][se]=fe*ne[ue][se]-xe*le;ce=-xe*ke*be*ye*ae[he]/pe,ae[he]=xe*ce,ie[he]=fe*ce}while(Math.abs(ae[he])>je*Me)}ie[he]=ie[he]+ve,ae[he]=0}for(se=0;se<te-1;se++){for(ue=se,ce=ie[se],de=se+1;de<te;de++)ie[de]<ce&&(ue=de,ce=ie[de]);if(ue!==se)for(ie[ue]=ie[se],ie[se]=ce,de=0;de<te;de++)ce=ne[de][se],ne[de][se]=ne[de][ue],ne[de][ue]=ce}}function E(te,ae,ie,ne){var oe=0,le=te-1,se,de,ue,he,me,ce,ge;for(ce=oe+1;ce<=le-1;ce++){for(ge=0,he=ce;he<=le;he++)ge=ge+Math.abs(ae[he][ce-1]);if(0!==ge){for(ue=0,he=le;he>=ce;he--)ie[he]=ae[he][ce-1]/ge,ue+=ie[he]*ie[he];for(de=Math.sqrt(ue),0<ie[ce]&&(de=-de),ue=ue-ie[ce]*de,ie[ce]=ie[ce]-de,me=ce;me<te;me++){for(se=0,he=le;he>=ce;he--)se+=ie[he]*ae[he][me];for(se=se/ue,he=ce;he<=le;he++)ae[he][me]-=se*ie[he]}for(he=0;he<=le;he++){for(se=0,me=le;me>=ce;me--)se+=ie[me]*ae[he][me];for(se=se/ue,me=ce;me<=le;me++)ae[he][me]-=se*ie[me]}ie[ce]=ge*ie[ce],ae[ce][ce-1]=ge*de}}for(he=0;he<te;he++)for(me=0;me<te;me++)ne[he][me]=he===me?1:0;for(ce=le-1;ce>=oe+1;ce--)if(0!==ae[ce][ce-1]){for(he=ce+1;he<=le;he++)ie[he]=ae[he][ce-1];for(me=ce;me<=le;me++){for(de=0,he=ce;he<=le;he++)de+=ie[he]*ne[he][me];for(de=de/ie[ce]/ae[ce][ce-1],he=ce;he<=le;he++)ne[he][me]+=de*ie[he]}}}function G(te,ae,ie,ne,oe){var le=te-1,se=0,de=te-1,ue=Math.pow(2,-52),he=0,me=0,ce=0,ge=0,pe=0,fe=0,_e=0,be=0,ye,xe,ke,we,ve,Me,je,Pe,De,Se,Ie,Ce,Ae,Re,Be;for(ye=0;ye<te;ye++)for((ye<se||ye>de)&&(ie[ye]=oe[ye][ye],ae[ye]=0),xe=Math.max(ye-1,0);xe<te;xe++)me=me+Math.abs(oe[ye][xe]);for(;le>=se;){for(we=le;we>se&&(fe=Math.abs(oe[we-1][we-1])+Math.abs(oe[we][we]),0==fe&&(fe=me),!(Math.abs(oe[we][we-1])<ue*fe));)we--;if(we===le)oe[le][le]=oe[le][le]+he,ie[le]=oe[le][le],ae[le]=0,le--,be=0;else if(we===le-1){if(je=oe[le][le-1]*oe[le-1][le],ce=(oe[le-1][le-1]-oe[le][le])/2,ge=ce*ce+je,_e=Math.sqrt(Math.abs(ge)),oe[le][le]=oe[le][le]+he,oe[le-1][le-1]=oe[le-1][le-1]+he,Pe=oe[le][le],0<=ge){for(_e=0<=ce?ce+_e:ce-_e,ie[le-1]=Pe+_e,ie[le]=ie[le-1],0!=_e&&(ie[le]=Pe-je/_e),ae[le-1]=0,ae[le]=0,Pe=oe[le][le-1],fe=Math.abs(Pe)+Math.abs(_e),ce=Pe/fe,ge=_e/fe,pe=Math.sqrt(ce*ce+ge*ge),ce=ce/pe,ge=ge/pe,xe=le-1;xe<te;xe++)_e=oe[le-1][xe],oe[le-1][xe]=ge*_e+ce*oe[le][xe],oe[le][xe]=ge*oe[le][xe]-ce*_e;for(ye=0;ye<=le;ye++)_e=oe[ye][le-1],oe[ye][le-1]=ge*_e+ce*oe[ye][le],oe[ye][le]=ge*oe[ye][le]-ce*_e;for(ye=se;ye<=de;ye++)_e=ne[ye][le-1],ne[ye][le-1]=ge*_e+ce*ne[ye][le],ne[ye][le]=ge*ne[ye][le]-ce*_e}else ie[le-1]=Pe+ce,ie[le]=Pe+ce,ae[le-1]=_e,ae[le]=-_e;le=le-2,be=0}else{if(Pe=oe[le][le],De=0,je=0,we<le&&(De=oe[le-1][le-1],je=oe[le][le-1]*oe[le-1][le]),10==be){for(he+=Pe,ye=se;ye<=le;ye++)oe[ye][ye]-=Pe;fe=Math.abs(oe[le][le-1])+Math.abs(oe[le-1][le-2]),Pe=De=0.75*fe,je=-0.4375*fe*fe}if(30==be&&(fe=(De-Pe)/2,fe=fe*fe+je,0<fe)){for(fe=Math.sqrt(fe),De<Pe&&(fe=-fe),fe=Pe-je/((De-Pe)/2+fe),ye=se;ye<=le;ye++)oe[ye][ye]-=fe;he+=fe,Pe=De=je=0.964}for(be=be+1,ve=le-2;ve>=we&&(_e=oe[ve][ve],pe=Pe-_e,fe=De-_e,ce=(pe*fe-je)/oe[ve+1][ve]+oe[ve][ve+1],ge=oe[ve+1][ve+1]-_e-pe-fe,pe=oe[ve+2][ve+1],fe=Math.abs(ce)+Math.abs(ge)+Math.abs(pe),ce=ce/fe,ge=ge/fe,pe=pe/fe,ve!=we)&&!(Math.abs(oe[ve][ve-1])*(Math.abs(ge)+Math.abs(pe))<ue*(Math.abs(ce)*(Math.abs(oe[ve-1][ve-1])+Math.abs(_e)+Math.abs(oe[ve+1][ve+1]))));)ve--;for(ye=ve+2;ye<=le;ye++)oe[ye][ye-2]=0,ye>ve+2&&(oe[ye][ye-3]=0);for(ke=ve;ke<=le-1&&(Re=ke!==le-1,ke!=ve&&(ce=oe[ke][ke-1],ge=oe[ke+1][ke-1],pe=Re?oe[ke+2][ke-1]:0,Pe=Math.abs(ce)+Math.abs(ge)+Math.abs(pe),0!==Pe&&(ce=ce/Pe,ge=ge/Pe,pe=pe/Pe)),0!==Pe);ke++)if(fe=Math.sqrt(ce*ce+ge*ge+pe*pe),0>ce&&(fe=-fe),0!==fe){for(ke==ve?we!==ve&&(oe[ke][ke-1]=-oe[ke][ke-1]):oe[ke][ke-1]=-fe*Pe,ce=ce+fe,Pe=ce/fe,De=ge/fe,_e=pe/fe,ge=ge/ce,pe=pe/ce,xe=ke;xe<te;xe++)ce=oe[ke][xe]+ge*oe[ke+1][xe],Re&&(ce=ce+pe*oe[ke+2][xe],oe[ke+2][xe]=oe[ke+2][xe]-ce*_e),oe[ke][xe]=oe[ke][xe]-ce*Pe,oe[ke+1][xe]=oe[ke+1][xe]-ce*De;for(ye=0;ye<=Math.min(le,ke+3);ye++)ce=Pe*oe[ye][ke]+De*oe[ye][ke+1],Re&&(ce=ce+_e*oe[ye][ke+2],oe[ye][ke+2]=oe[ye][ke+2]-ce*pe),oe[ye][ke]=oe[ye][ke]-ce,oe[ye][ke+1]=oe[ye][ke+1]-ce*ge;for(ye=se;ye<=de;ye++)ce=Pe*ne[ye][ke]+De*ne[ye][ke+1],Re&&(ce=ce+_e*ne[ye][ke+2],ne[ye][ke+2]=ne[ye][ke+2]-ce*pe),ne[ye][ke]=ne[ye][ke]-ce,ne[ye][ke+1]=ne[ye][ke+1]-ce*ge}}}if(0!==me){for(le=te-1;0<=le;le--)if(ce=ie[le],ge=ae[le],0===ge)for(we=le,oe[le][le]=1,ye=le-1;0<=ye;ye--){for(je=oe[ye][ye]-ce,pe=0,xe=we;xe<=le;xe++)pe=pe+oe[ye][xe]*oe[xe][le];if(0>ae[ye])_e=je,fe=pe;else if(we=ye,0===ae[ye]?oe[ye][le]=0===je?-pe/(ue*me):-pe/je:(Pe=oe[ye][ye+1],De=oe[ye+1][ye],ge=(ie[ye]-ce)*(ie[ye]-ce)+ae[ye]*ae[ye],Me=(Pe*fe-_e*pe)/ge,oe[ye][le]=Me,oe[ye+1][le]=Math.abs(Pe)>Math.abs(_e)?(-pe-je*Me)/Pe:(-fe-De*Me)/_e),Me=Math.abs(oe[ye][le]),1<ue*Me*Me)for(xe=ye;xe<=le;xe++)oe[xe][le]=oe[xe][le]/Me}else if(0>ge)for(we=le-1,Math.abs(oe[le][le-1])>Math.abs(oe[le-1][le])?(oe[le-1][le-1]=ge/oe[le][le-1],oe[le-1][le]=-(oe[le][le]-ce)/oe[le][le-1]):(Be=Z(0,-oe[le-1][le],oe[le-1][le-1]-ce,ge),oe[le-1][le-1]=Be[0],oe[le-1][le]=Be[1]),oe[le][le-1]=0,oe[le][le]=1,ye=le-2;0<=ye;ye--){for(Se=0,Ie=0,xe=we;xe<=le;xe++)Se=Se+oe[ye][xe]*oe[xe][le-1],Ie=Ie+oe[ye][xe]*oe[xe][le];if(je=oe[ye][ye]-ce,0>ae[ye])_e=je,pe=Se,fe=Ie;else if(we=ye,0===ae[ye]?(Be=Z(-Se,-Ie,je,ge),oe[ye][le-1]=Be[0],oe[ye][le]=Be[1]):(Pe=oe[ye][ye+1],De=oe[ye+1][ye],Ce=(ie[ye]-ce)*(ie[ye]-ce)+ae[ye]*ae[ye]-ge*ge,Ae=2*(ie[ye]-ce)*ge,0===Ce&&0===Ae&&(Ce=ue*me*(Math.abs(je)+Math.abs(ge)+Math.abs(Pe)+Math.abs(De)+Math.abs(_e))),Be=Z(Pe*pe-_e*Se+ge*Ie,Pe*fe-_e*Ie-ge*Se,Ce,Ae),oe[ye][le-1]=Be[0],oe[ye][le]=Be[1],Math.abs(Pe)>Math.abs(_e)+Math.abs(ge)?(oe[ye+1][le-1]=(-Se-je*oe[ye][le-1]+ge*oe[ye][le])/Pe,oe[ye+1][le]=(-Ie-je*oe[ye][le]-ge*oe[ye][le-1])/Pe):(Be=Z(-pe-De*oe[ye][le-1],-fe-De*oe[ye][le],_e,ge),oe[ye+1][le-1]=Be[0],oe[ye+1][le]=Be[1])),Me=Math.max(Math.abs(oe[ye][le-1]),Math.abs(oe[ye][le])),1<ue*Me*Me)for(xe=ye;xe<=le;xe++)oe[xe][le-1]=oe[xe][le-1]/Me,oe[xe][le]=oe[xe][le]/Me}for(ye=0;ye<te;ye++)if(ye<se||ye>de)for(xe=ye;xe<te;xe++)ne[ye][xe]=oe[ye][xe];for(xe=te-1;xe>=se;xe--)for(ye=se;ye<=de;ye++){for(_e=0,ke=se;ke<=Math.min(xe,de);ke++)_e=_e+ne[ye][ke]*oe[ke][xe];ne[ye][xe]=_e}}}function Z(te,ae,ie,ne){var oe,le;return Math.abs(ie)>Math.abs(ne)?(oe=ne/ie,le=ie+oe*ne,[(te+oe*ae)/le,(ae-oe*te)/le]):(oe=ie/ne,le=ne+oe*ie,[(oe*te+ae)/le,(oe*ae-te)/le])}var W=D("../matrix"),Q=D("./util"),$=Q.hypotenuse,J=Q.getFilled2DArray,ee={assumeSymmetric:!1};R.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return W.isMatrix(this.V)||(this.V=new W(this.V)),this.V},get diagonalMatrix(){var te=this.n,ae=this.e,ie=this.d,ne=new W(te,te),oe,le;for(oe=0;oe<te;oe++){for(le=0;le<te;le++)ne[oe][le]=0;ne[oe][oe]=ie[oe],0<ae[oe]?ne[oe][oe+1]=ae[oe]:0>ae[oe]&&(ne[oe][oe-1]=ae[oe])}return ne}},I.exports=R},{"../matrix":88,"./util":85}],82:[function(D,I){"use strict";function R(L){if(!(this instanceof R))return new R(L);L=T.checkMatrix(L);var E=L.clone(),G=E.rows,Z=E.columns,W=Array(G),Q=1,$,J,ee,te,ae,ie,ne,oe,le,se;for($=0;$<G;$++)W[$]=$;for(le=Array(G),J=0;J<Z;J++){for($=0;$<G;$++)le[$]=E[$][J];for($=0;$<G;$++){for(oe=E[$],se=Math.min($,J),ae=0,ee=0;ee<se;ee++)ae+=oe[ee]*le[ee];oe[J]=le[$]-=ae}for(te=J,$=J+1;$<G;$++)Math.abs(le[$])>Math.abs(le[te])&&(te=$);if(te!==J){for(ee=0;ee<Z;ee++)ie=E[te][ee],E[te][ee]=E[J][ee],E[J][ee]=ie;ne=W[te],W[te]=W[J],W[J]=ne,Q=-Q}if(J<G&&0!==E[J][J])for($=J+1;$<G;$++)E[$][J]/=E[J][J]}this.LU=E,this.pivotVector=W,this.pivotSign=Q}var T=D("../matrix");R.prototype={isSingular:function(){var E=this.LU,G=E.columns;for(var Z=0;Z<G;Z++)if(0===E[Z][Z])return!0;return!1},get determinant(){var L=this.LU;if(!L.isSquare())throw new Error("Matrix must be square");var E=this.pivotSign,G=L.columns;for(var Z=0;Z<G;Z++)E*=L[Z][Z];return E},get lowerTriangularMatrix(){var L=this.LU,E=L.rows,G=L.columns,Z=new T(E,G);for(var W=0;W<E;W++)for(var Q=0;Q<G;Q++)Z[W][Q]=W>Q?L[W][Q]:W===Q?1:0;return Z},get upperTriangularMatrix(){var L=this.LU,E=L.rows,G=L.columns,Z=new T(E,G);for(var W=0;W<E;W++)for(var Q=0;Q<G;Q++)Z[W][Q]=W<=Q?L[W][Q]:0;return Z},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(E){E=T.checkMatrix(E);var G=this.LU,Z=G.rows;if(Z!==E.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var W=E.columns,Q=E.subMatrixRow(this.pivotVector,0,W-1),$=G.columns,J,ee,te;for(te=0;te<$;te++)for(J=te+1;J<$;J++)for(ee=0;ee<W;ee++)Q[J][ee]-=Q[te][ee]*G[J][te];for(te=$-1;0<=te;te--){for(ee=0;ee<W;ee++)Q[te][ee]/=G[te][te];for(J=0;J<te;J++)for(ee=0;ee<W;ee++)Q[J][ee]-=Q[te][ee]*G[J][te]}return Q}},I.exports=R},{"../matrix":88}],83:[function(D,I){"use strict";function R(E){if(!(this instanceof R))return new R(E);E=T.checkMatrix(E);var G=E.clone(),Z=E.rows,W=E.columns,Q=Array(W),$,J,ee,te;for(ee=0;ee<W;ee++){var ae=0;for($=ee;$<Z;$++)ae=L(ae,G[$][ee]);if(0!==ae){for(0>G[ee][ee]&&(ae=-ae),$=ee;$<Z;$++)G[$][ee]/=ae;for(G[ee][ee]+=1,J=ee+1;J<W;J++){for(te=0,$=ee;$<Z;$++)te+=G[$][ee]*G[$][J];for(te=-te/G[ee][ee],$=ee;$<Z;$++)G[$][J]+=te*G[$][ee]}}Q[ee]=-ae}this.QR=G,this.Rdiag=Q}var T=D("../matrix"),L=D("./util").hypotenuse;R.prototype={solve:function(G){G=T.checkMatrix(G);var Z=this.QR,W=Z.rows;if(G.rows!==W)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var Q=G.columns,$=G.clone(),J=Z.columns,ee,te,ae,ie;for(ae=0;ae<J;ae++)for(te=0;te<Q;te++){for(ie=0,ee=ae;ee<W;ee++)ie+=Z[ee][ae]*$[ee][te];for(ie=-ie/Z[ae][ae],ee=ae;ee<W;ee++)$[ee][te]+=ie*Z[ee][ae]}for(ae=J-1;0<=ae;ae--){for(te=0;te<Q;te++)$[ae][te]/=this.Rdiag[ae];for(ee=0;ee<ae;ee++)for(te=0;te<Q;te++)$[ee][te]-=$[ae][te]*Z[ee][ae]}return $.subMatrix(0,J-1,0,Q-1)},isFullRank:function(){var G=this.QR.columns;for(var Z=0;Z<G;Z++)if(0===this.Rdiag[Z])return!1;return!0},get upperTriangularMatrix(){var E=this.QR,G=E.columns,Z=new T(G,G),W,Q;for(W=0;W<G;W++)for(Q=0;Q<G;Q++)Z[W][Q]=W<Q?E[W][Q]:W===Q?this.Rdiag[W]:0;return Z},get orthogonalMatrix(){var E=this.QR,G=E.rows,Z=E.columns,W=new T(G,Z),Q,$,J,ee;for(J=Z-1;0<=J;J--){for(Q=0;Q<G;Q++)W[Q][J]=0;for(W[J][J]=1,$=J;$<Z;$++)if(0!==E[J][J]){for(ee=0,Q=J;Q<G;Q++)ee+=E[Q][J]*W[Q][$];for(ee=-ee/E[J][J],Q=J;Q<G;Q++)W[Q][$]+=ee*E[Q][J]}}return W}},I.exports=R},{"../matrix":88,"./util":85}],84:[function(D,I){"use strict";function R(Z,W){if(!(this instanceof R))return new R(Z,W);Z=T.checkMatrix(Z),W=W||{};var Q=Z.rows,$=Z.columns,J=Math.min(Q,$),ee=!0,te=!0;!1===W.computeLeftSingularVectors&&(ee=!1),!1===W.computeRightSingularVectors&&(te=!1);var ae=!0===W.autoTranspose,ie=!1,ne;if(!(Q<$))ne=Z.clone();else if(!ae)ne=Z.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else{ne=Z.transpose(),Q=ne.rows,$=ne.columns,ie=!0;var oe=ee;ee=te,te=oe}var le=Array(Math.min(Q+1,$)),se=G(Q,J,0),de=G($,$,0),ue=Array($),he=Array(Q),me=Math.min(Q-1,$),ce=Math.max(0,Math.min($-2,Q)),ge,pe,fe,_e,be,ye,xe,ke,we,ve,Me,je,Pe,De,Se,Ie,Ce,Ae,Re,Be,ze;for(fe=0,ve=Math.max(me,ce);fe<ve;fe++){if(fe<me){for(le[fe]=0,ge=fe;ge<Q;ge++)le[fe]=E(le[fe],ne[ge][fe]);if(0!==le[fe]){for(0>ne[fe][fe]&&(le[fe]=-le[fe]),ge=fe;ge<Q;ge++)ne[ge][fe]/=le[fe];ne[fe][fe]+=1}le[fe]=-le[fe]}for(pe=fe+1;pe<$;pe++){if(fe<me&&0!==le[fe]){for(be=0,ge=fe;ge<Q;ge++)be+=ne[ge][fe]*ne[ge][pe];for(be=-be/ne[fe][fe],ge=fe;ge<Q;ge++)ne[ge][pe]+=be*ne[ge][fe]}ue[pe]=ne[fe][pe]}if(ee&&fe<me)for(ge=fe;ge<Q;ge++)se[ge][fe]=ne[ge][fe];if(fe<ce){for(ue[fe]=0,ge=fe+1;ge<$;ge++)ue[fe]=E(ue[fe],ue[ge]);if(0!==ue[fe]){for(0>ue[fe+1]&&(ue[fe]=-ue[fe]),ge=fe+1;ge<$;ge++)ue[ge]/=ue[fe];ue[fe+1]+=1}if(ue[fe]=-ue[fe],fe+1<Q&&0!==ue[fe]){for(ge=fe+1;ge<Q;ge++)he[ge]=0;for(pe=fe+1;pe<$;pe++)for(ge=fe+1;ge<Q;ge++)he[ge]+=ue[pe]*ne[ge][pe];for(pe=fe+1;pe<$;pe++)for(be=-ue[pe]/ue[fe+1],ge=fe+1;ge<Q;ge++)ne[ge][pe]+=be*he[ge]}if(te)for(ge=fe+1;ge<$;ge++)de[ge][fe]=ue[ge]}}if(_e=Math.min($,Q+1),me<$&&(le[me]=ne[me][me]),Q<_e&&(le[_e-1]=0),ce+1<_e&&(ue[ce]=ne[ce][_e-1]),ue[_e-1]=0,ee){for(pe=me;pe<J;pe++){for(ge=0;ge<Q;ge++)se[ge][pe]=0;se[pe][pe]=1}for(fe=me-1;0<=fe;fe--)if(0!==le[fe]){for(pe=fe+1;pe<J;pe++){for(be=0,ge=fe;ge<Q;ge++)be+=se[ge][fe]*se[ge][pe];for(be=-be/se[fe][fe],ge=fe;ge<Q;ge++)se[ge][pe]+=be*se[ge][fe]}for(ge=fe;ge<Q;ge++)se[ge][fe]=-se[ge][fe];for(se[fe][fe]=1+se[fe][fe],ge=0;ge<fe-1;ge++)se[ge][fe]=0}else{for(ge=0;ge<Q;ge++)se[ge][fe]=0;se[fe][fe]=1}}if(te)for(fe=$-1;0<=fe;fe--){if(fe<ce&&0!==ue[fe])for(pe=fe+1;pe<$;pe++){for(be=0,ge=fe+1;ge<$;ge++)be+=de[ge][fe]*de[ge][pe];for(be=-be/de[fe+1][fe],ge=fe+1;ge<$;ge++)de[ge][pe]+=be*de[ge][fe]}for(ge=0;ge<$;ge++)de[ge][fe]=0;de[fe][fe]=1}for(var Te=_e-1,Le=0,Ee=Math.pow(2,-52);0<_e;){for(fe=_e-2;-1<=fe&&-1!==fe;fe--)if(Math.abs(ue[fe])<=Ee*(Math.abs(le[fe])+Math.abs(le[fe+1]))){ue[fe]=0;break}if(fe===_e-2)Me=4;else{for(ye=_e-1;ye>=fe&&ye!==fe;ye--)if(be=(ye===_e?0:Math.abs(ue[ye]))+(ye===fe+1?0:Math.abs(ue[ye-1])),Math.abs(le[ye])<=Ee*be){le[ye]=0;break}ye===fe?Me=3:ye===_e-1?Me=1:(Me=2,fe=ye)}switch(fe++,Me){case 1:{for(xe=ue[_e-2],ue[_e-2]=0,pe=_e-2;pe>=fe;pe--)if(be=E(le[pe],xe),ke=le[pe]/be,we=xe/be,le[pe]=be,pe!==fe&&(xe=-we*ue[pe-1],ue[pe-1]=ke*ue[pe-1]),te)for(ge=0;ge<$;ge++)be=ke*de[ge][pe]+we*de[ge][_e-1],de[ge][_e-1]=-we*de[ge][pe]+ke*de[ge][_e-1],de[ge][pe]=be;break}case 2:{for(xe=ue[fe-1],ue[fe-1]=0,pe=fe;pe<_e;pe++)if(be=E(le[pe],xe),ke=le[pe]/be,we=xe/be,le[pe]=be,xe=-we*ue[pe],ue[pe]=ke*ue[pe],ee)for(ge=0;ge<Q;ge++)be=ke*se[ge][pe]+we*se[ge][fe-1],se[ge][fe-1]=-we*se[ge][pe]+ke*se[ge][fe-1],se[ge][pe]=be;break}case 3:{for(je=Math.max(Math.max(Math.max(Math.max(Math.abs(le[_e-1]),Math.abs(le[_e-2])),Math.abs(ue[_e-2])),Math.abs(le[fe])),Math.abs(ue[fe])),Pe=le[_e-1]/je,De=le[_e-2]/je,Se=ue[_e-2]/je,Ie=le[fe]/je,Ce=ue[fe]/je,Ae=((De+Pe)*(De-Pe)+Se*Se)/2,Re=Pe*Se*(Pe*Se),Be=0,(0!==Ae||0!==Re)&&(Be=Math.sqrt(Ae*Ae+Re),0>Ae&&(Be=-Be),Be=Re/(Ae+Be)),xe=(Ie+Pe)*(Ie-Pe)+Be,ze=Ie*Ce,pe=fe;pe<_e-1;pe++){if(be=E(xe,ze),ke=xe/be,we=ze/be,pe!==fe&&(ue[pe-1]=be),xe=ke*le[pe]+we*ue[pe],ue[pe]=ke*ue[pe]-we*le[pe],ze=we*le[pe+1],le[pe+1]=ke*le[pe+1],te)for(ge=0;ge<$;ge++)be=ke*de[ge][pe]+we*de[ge][pe+1],de[ge][pe+1]=-we*de[ge][pe]+ke*de[ge][pe+1],de[ge][pe]=be;if(be=E(xe,ze),ke=xe/be,we=ze/be,le[pe]=be,xe=ke*ue[pe]+we*le[pe+1],le[pe+1]=-we*ue[pe]+ke*le[pe+1],ze=we*ue[pe+1],ue[pe+1]=ke*ue[pe+1],ee&&pe<Q-1)for(ge=0;ge<Q;ge++)be=ke*se[ge][pe]+we*se[ge][pe+1],se[ge][pe+1]=-we*se[ge][pe]+ke*se[ge][pe+1],se[ge][pe]=be}ue[_e-2]=xe,Le=Le+1;break}case 4:{if(0>=le[fe]&&(le[fe]=0>le[fe]?-le[fe]:0,te))for(ge=0;ge<=Te;ge++)de[ge][fe]=-de[ge][fe];for(;fe<Te&&!(le[fe]>=le[fe+1]);){if(be=le[fe],le[fe]=le[fe+1],le[fe+1]=be,te&&fe<$-1)for(ge=0;ge<$;ge++)be=de[ge][fe+1],de[ge][fe+1]=de[ge][fe],de[ge][fe]=be;if(ee&&fe<Q-1)for(ge=0;ge<Q;ge++)be=se[ge][fe+1],se[ge][fe+1]=se[ge][fe],se[ge][fe]=be;fe++}Le=0,_e--;break}}}if(ie){var Fe=de;de=se,se=Fe}this.m=Q,this.n=$,this.s=le,this.U=se,this.V=de}var T=D("../matrix"),L=D("./util"),E=L.hypotenuse,G=L.getFilled2DArray;R.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){var Z=Math.pow(2,-52),W=Math.max(this.m,this.n)*this.s[0]*Z,Q=0,$=this.s;for(var J=0,ee=$.length;J<ee;J++)$[J]>W&&Q++;return Q},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return T.isMatrix(this.U)||(this.U=new T(this.U)),this.U},get rightSingularVectors(){return T.isMatrix(this.V)||(this.V=new T(this.V)),this.V},get diagonalMatrix(){return T.diag(this.s)},solve:function(W){var Q=this.threshold,$=this.s.length,J=T.zeros($,$),ee;for(ee=0;ee<$;ee++)J[ee][ee]=Math.abs(this.s[ee])<=Q?0:1/this.s[ee];var te=this.U,ae=this.rightSingularVectors,ie=ae.mmul(J),ne=ae.rows,oe=te.length,le=T.zeros(ne,oe),se,de,ue;for(ee=0;ee<ne;ee++)for(se=0;se<oe;se++){for(ue=0,de=0;de<$;de++)ue+=ie[ee][de]*te[se][de];le[ee][se]=ue}return le.mmul(W)},solveForDiagonal:function(W){return this.solve(T.diag(W))},inverse:function(){var W=this.V,Q=this.threshold,$=W.length,J=W[0].length,ee=new T($,this.s.length),te,ae;for(te=0;te<$;te++)for(ae=0;ae<J;ae++)ee[te][ae]=Math.abs(this.s[ae])>Q?W[te][ae]/this.s[ae]:0;var ie=this.U,ne=ie.length,oe=ie[0].length,le=new T($,ne),se,de;for(te=0;te<$;te++)for(ae=0;ae<ne;ae++){for(de=0,se=0;se<oe;se++)de+=ee[te][se]*ie[ae][se];le[te][ae]=de}return le}},I.exports=R},{"../matrix":88,"./util":85}],85:[function(D,I,R){"use strict";R.hypotenuse=function(L,E){if(Math.abs(L)>Math.abs(E)){var G=E/L;return Math.abs(L)*Math.sqrt(1+G*G)}if(0!==E){var G=L/E;return Math.abs(E)*Math.sqrt(1+G*G)}return 0},R.getEmpty2DArray=function(T,L){var E=Array(T);for(var G=0;G<T;G++)E[G]=Array(L);return E},R.getFilled2DArray=function(T,L,E){var G=Array(T);for(var Z=0;Z<T;Z++){G[Z]=Array(L);for(var W=0;W<L;W++)G[Z][W]=E}return G}},{}],86:[function(D,I){"use strict";function R($){return $=L.checkMatrix($),T($,L.eye($.rows))}function T($,J){return $=L.checkMatrix($),J=L.checkMatrix(J),$.isSquare()?new Z($).solve(J):new W($).solve(J)}var L=D("./matrix"),E=D("./dc/svd"),G=D("./dc/evd"),Z=D("./dc/lu"),W=D("./dc/qr"),Q=D("./dc/cholesky");L.inverse=L.inv=R,L.prototype.inverse=L.prototype.inv=function(){return R(this)},L.solve=T,L.prototype.solve=function($){return T(this,$)},I.exports={SingularValueDecomposition:E,SVD:E,EigenvalueDecomposition:G,EVD:G,LuDecomposition:Z,LU:Z,QrDecomposition:W,QR:W,CholeskyDecomposition:Q,CHO:Q,inverse:R,solve:T}},{"./dc/cholesky":80,"./dc/evd":81,"./dc/lu":82,"./dc/qr":83,"./dc/svd":84,"./matrix":88}],87:[function(D,I){"use strict";I.exports=D("./matrix"),I.exports.Decompositions=I.exports.DC=D("./decompositions")},{"./decompositions":86,"./matrix":88}],88:[function(D,I){"use strict";D("./symbol-species");var R=D("./abstractMatrix"),T=D("./util");class L extends R(Array){constructor(E,G){if(1===arguments.length&&"number"==typeof E)return Array(E);if(L.isMatrix(E))return E.clone();if(Number.isInteger(E)&&0<E){if(super(E),Number.isInteger(G)&&0<G)for(var Z=0;Z<E;Z++)this[Z]=Array(G);else throw new TypeError("nColumns must be a positive integer");}else if(Array.isArray(E)){var W=E;if(E=W.length,G=W[0].length,"number"!=typeof G||0===G)throw new TypeError("Data must be a 2D array with at least one element");super(E);for(var Z=0;Z<E;Z++){if(W[Z].length!==G)throw new RangeError("Inconsistent array dimensions");this[Z]=[].concat(W[Z])}}else throw new TypeError("First argument must be a positive number or an array");this.rows=E,this.columns=G}set(E,G,Z){return this[E][G]=Z,this}get(E,G){return this[E][G]}clone(){var E=new this.constructor[Symbol.species](this.rows,this.columns);for(var G=0;G<this.rows;G++)for(var Z=0;Z<this.columns;Z++)E.set(G,Z,this.get(G,Z));return E}removeRow(E){if(T.checkRowIndex(this,E),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(E,1),this.rows-=1,this}addRow(E,G){return void 0===G&&(G=E,E=this.rows),T.checkRowIndex(this,E,!0),G=T.checkRowVector(this,G,!0),this.splice(E,0,G),this.rows+=1,this}removeColumn(E){if(T.checkColumnIndex(this,E),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var G=0;G<this.rows;G++)this[G].splice(E,1);return this.columns-=1,this}addColumn(E,G){"undefined"==typeof G&&(G=E,E=this.columns),T.checkColumnIndex(this,E,!0),G=T.checkColumnVector(this,G);for(var Z=0;Z<this.rows;Z++)this[Z].splice(E,0,G[Z]);return this.columns+=1,this}}I.exports=L,L.abstractMatrix=R},{"./abstractMatrix":79,"./symbol-species":89,"./util":90}],89:[function(){"use strict";Symbol.species||(Symbol.species=Symbol.for("@@species"))},{}],90:[function(D,I,R){"use strict";R.checkRowIndex=function(L,E,G){var Z=G?L.rows:L.rows-1;if(0>E||E>Z)throw new RangeError("Row index out of range")},R.checkColumnIndex=function(L,E,G){var Z=G?L.columns:L.columns-1;if(0>E||E>Z)throw new RangeError("Column index out of range")},R.checkRowVector=function(L,E){if(E.to1DArray&&(E=E.to1DArray()),E.length!==L.columns)throw new RangeError("vector size must be the same as the number of columns");return E},R.checkColumnVector=function(L,E){if(E.to1DArray&&(E=E.to1DArray()),E.length!==L.rows)throw new RangeError("vector size must be the same as the number of rows");return E},R.checkIndices=function(L,E,G){var Z=E.some(Q=>{return 0>Q||Q>=L.rows}),W=G.some(Q=>{return 0>Q||Q>=L.columns});if(Z||W)throw new RangeError("Indices are out of range");if("object"!=typeof E||"object"!=typeof G)throw new TypeError("Unexpected type for row/column indices");return Array.isArray(E)||(E=Array.from(E)),Array.isArray(G)||(E=Array.from(G)),{row:E,column:G}},R.checkRange=function(L,E,G,Z,W){if(5!==arguments.length)throw new TypeError("Invalid argument type");var Q=Array.from(arguments).slice(1).some(function($){return"number"!=typeof $});if(Q)throw new TypeError("Invalid argument type");if(E>G||Z>W||0>E||E>=L.rows||0>G||G>=L.rows||0>Z||Z>=L.columns||0>W||W>=L.columns)throw new RangeError("Submatrix indices are out of range")},R.getRange=function(L,E){var G=Array(E-L+1);for(var Z=0;Z<G.length;Z++)G[Z]=L+Z;return G}},{}],91:[function(D,I){"use strict";var R=D("../abstractMatrix"),T;class L extends R(){constructor(E,G,Z){super(),this.matrix=E,this.rows=G,this.columns=Z}static get[Symbol.species](){return T||(T=D("../matrix")),T}}I.exports=L},{"../abstractMatrix":79,"../matrix":88}],92:[function(D,I){"use strict";var R=D("./base");I.exports=class extends R{constructor(L,E){super(L,L.rows,1),this.column=E}set(L,E,G){return this.matrix.set(L,this.column,G),this}get(L){return this.matrix.get(L,this.column)}}},{"./base":91}],93:[function(D,I){"use strict";var R=D("./base");I.exports=class extends R{constructor(L){super(L,L.rows,L.columns)}set(L,E,G){return this.matrix.set(L,this.columns-E-1,G),this}get(L,E){return this.matrix.get(L,this.columns-E-1)}}},{"./base":91}],94:[function(D,I){"use strict";var R=D("./base");I.exports=class extends R{constructor(L){super(L,L.rows,L.columns)}set(L,E,G){return this.matrix.set(this.rows-L-1,E,G),this}get(L,E){return this.matrix.get(this.rows-L-1,E)}}},{"./base":91}],95:[function(D,I){"use strict";var R=D("./base");I.exports=class extends R{constructor(L,E){super(L,1,L.columns),this.row=E}set(L,E,G){return this.matrix.set(this.row,E,G),this}get(L,E){return this.matrix.get(this.row,E)}}},{"./base":91}],96:[function(D,I){"use strict";var R=D("./base"),T=D("../util");I.exports=class extends R{constructor(E,G,Z){var W=T.checkIndices(E,G,Z);super(E,W.row.length,W.column.length),this.rowIndices=W.row,this.columnIndices=W.column}set(E,G,Z){return this.matrix.set(this.rowIndices[E],this.columnIndices[G],Z),this}get(E,G){return this.matrix.get(this.rowIndices[E],this.columnIndices[G])}}},{"../util":90,"./base":91}],97:[function(D,I){"use strict";var R=D("./base"),T=D("../util");I.exports=class extends R{constructor(E,G,Z,W,Q){T.checkRange(E,G,Z,W,Q),super(E,Z-G+1,Q-W+1),this.startRow=G,this.startColumn=W}set(E,G,Z){return this.matrix.set(this.startRow+E,this.startColumn+G,Z),this}get(E,G){return this.matrix.get(this.startRow+E,this.startColumn+G)}}},{"../util":90,"./base":91}],98:[function(D,I){"use strict";var R=D("./base");I.exports=class extends R{constructor(L){super(L,L.columns,L.rows)}set(L,E,G){return this.matrix.set(E,L,G),this}get(L,E){return this.matrix.get(E,L)}}},{"./base":91}],99:[function(D,I,R){"use strict";R.SimpleLinearRegression=R.SLR=D("./regression/simple-linear-regression"),R.NonLinearRegression=R.NLR={PolynomialRegression:D("./regression/polynomial-regression"),PotentialRegression:D("./regression/potential-regression"),ExpRegression:D("./regression/exp-regression"),PowerRegression:D("./regression/power-regression")},R.KernelRidgeRegression=R.KRR=D("./regression/kernel-ridge-regression"),R.PolinomialFitting2D=D("./regression/poly-fit-regression2d"),R.TheilSenRegression=D("./regression/theil-sen-regression")},{"./regression/exp-regression":101,"./regression/kernel-ridge-regression":102,"./regression/poly-fit-regression2d":103,"./regression/polynomial-regression":104,"./regression/potential-regression":105,"./regression/power-regression":106,"./regression/simple-linear-regression":107,"./regression/theil-sen-regression":108}],100:[function(D,I){"use strict";I.exports=class{predict(T){var L;if(Array.isArray(T)){L=Array(T.length);for(var E=0;E<T.length;E++)L[E]=this._predict(T[E])}else if(Number.isFinite(T))L=this._predict(T);else throw new TypeError("x must be a number or array");return L}_predict(){throw new Error("_compute not implemented")}train(){}toString(){return""}toLaTeX(){return""}modelQuality(T,L){var E=T.length,G=Array(E);for(var Z=0;Z<E;Z++)G[Z]=this._predict(T[Z]);var W=0,Q=0,$=0,J=0,ee=0,te=0,ae=0;for(var ie=0;ie<E;ie++)W+=G[ie],Q+=L[ie],ee+=G[ie]*G[ie],te+=L[ie]*L[ie],ae+=G[ie]*L[ie],0!==L[ie]&&($+=(L[ie]-G[ie])*(L[ie]-G[ie])/L[ie]),J=(L[ie]-G[ie])*(L[ie]-G[ie]);var ne=(E*ae-W*Q)/Math.sqrt((E*ee-W*W)*(E*te-Q*Q));return{r:ne,r2:ne*ne,chi2:$,rmsd:J*J/E}}}},{}],101:[function(D,I){"use strict";var R=D("./util").maybeToPrecision,T=D("./simple-linear-regression"),L=D("./base-regression");class E extends L{constructor(G,Z,W){if(super(),!0===G)this.A=Z.A,this.C=Z.C,Z.quality&&(this.quality=Z.quality);else{var Q=G.length;if(Q!==Z.length)throw new RangeError("input and output array have a different length");var $=Array(Q);for(var J=0;J<Q;J++)$[J]=Math.log(Z[J]);var ee=new T(G,$,{computeCoefficient:!1});this.A=ee.slope,this.C=Math.exp(ee.intercept),(W||{}).computeQuality&&(this.quality=this.modelQuality(G,Z))}}_predict(G){return this.C*Math.exp(G*this.A)}toJSON(){var G={name:"expRegression",A:this.A,C:this.C};return this.quality&&(G.quality=this.quality),G}toString(G){return"f(x) = "+R(this.C,G)+" * exp("+R(this.A,G)+" * x)"}toLaTeX(G){return 0<=this.A?"f(x) = "+R(this.C,G)+"e^{"+R(this.A,G)+"x}":"f(x) = \\frac{"+R(this.C,G)+"}{e^{"+R(-this.A,G)+"x}}"}static load(G){if("expRegression"!==G.name)throw new TypeError("not a exp regression model");return new E(!0,G)}}I.exports=E},{"./base-regression":100,"./simple-linear-regression":107,"./util":109}],102:[function(D,I){"use strict";var R=D("ml-matrix"),T=D("ml-kernel"),L=D("./base-regression"),E={lambda:0.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class G extends L{constructor(Z,W,Q){if(super(),!0===Z)this.alpha=W.alpha,this.inputs=W.inputs,this.kernelType=W.kernelType,this.kernelOptions=W.kernelOptions,this.kernel=new T(W.kernelType,W.kernelOptions),W.quality&&(this.quality=W.quality);else{Q=Object.assign({},E,Q);var $=new T(Q.kernelType,Q.kernelOptions),J=$.compute(Z),ee=Z.length;J.add(R.eye(ee,ee).mul(Q.lambda)),this.alpha=J.solve(W),this.inputs=Z,this.kernelType=Q.kernelType,this.kernelOptions=Q.kernelOptions,this.kernel=$,Q.computeQuality&&(this.quality=this.modelQuality(Z,W))}}_predict(Z){return this.kernel.compute([Z],this.inputs).mmul(this.alpha)[0]}toJSON(){var Z={name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions};return this.quality&&(Z.quality=this.quality),Z}static load(Z){if("kernelRidgeRegression"!==Z.name)throw new TypeError("not a KRR model");return new G(!0,Z)}}I.exports=G},{"./base-regression":100,"ml-kernel":70,"ml-matrix":87}],103:[function(D,I){"use strict";function R(Q,$){var J=Q.clone();for(var ee=0;ee<Q.rows;++ee)J[ee][0]=Math.pow(J[ee][0],$);return J}function T(Q,$){this[Q][$]=Math.abs(this[Q][$])}var L=D("ml-matrix"),E=L.DC.SingularValueDecomposition,G=D("./base-regression"),Z={order:2};class W extends G{constructor(Q,$,J){super(),!0===Q?(this.coefficients=L.columnVector($.coefficients),this.order=$.order,$.r&&(this.r=$.r,this.r2=$.r2),$.chi2&&(this.chi2=$.chi2)):(J=Object.assign({},Z,J),this.order=J.order,this.coefficients=[],this.X=Q,this.y=$,this.train(this.X,this.y,J),J.computeQuality&&(this.quality=this.modelQuality(Q,$)))}train(Q,$){if(L.isMatrix(Q)||(Q=new L(Q)),L.isMatrix($)||($=L.columnVector($)),$.rows!==Q.rows&&($=$.transpose()),2!==Q.columns)throw new RangeError("You give X with "+Q.columns+" columns and it must be 2");if(Q.rows!==$.rows)throw new RangeError("X and y must have the same rows");var J=Q.rows,ee=(this.order+2)*(this.order+1)/2;this.coefficients=Array(ee);var te=Q.getColumnVector(0),ae=Q.getColumnVector(1),ie=1/te.clone().apply(T).max(),ne=1/ae.clone().apply(T).max(),oe=1/$.clone().apply(T).max();te.mulColumn(0,ie),ae.mulColumn(0,ne),$.mulColumn(0,oe);var le=new L(J,ee),se=0;for(var de=0;de<=this.order;++de){var ue=this.order-de;for(var he=0;he<=ue;++he){var me=R(te,de).mulColumnVector(R(ae,he));le.setColumn(se,me),se++}}var ce=new E(le.transpose(),{computeLeftSingularVectors:!0,computeRightSingularVectors:!0,autoTranspose:!1}),ge=L.rowVector(ce.diagonal);ge=ge.apply(function(be,ye){this[be][ye]=1e-15<=this[be][ye]?1/this[be][ye]:0});var pe=L.zeros(J,ee);for(de=0;de<ee;++de)pe[de][de]=ge[0][de];ge=pe;var fe=ce.rightSingularVectors,_e=ce.leftSingularVectors;for(this.coefficients=_e.mmul(ge.transpose()).mmul(fe.transpose()).mmul($),se=0,de=0;de<=ee;++de)for(ue=this.order-de,he=0;he<=ue;++he)this.coefficients[se][0]=this.coefficients[se][0]*Math.pow(ie,de)*Math.pow(ne,he)/oe,se++}_predict(Q){var $=Q[0],J=Q[1],ee=0,te=0;for(var ae=0;ae<=this.order;ae++)for(var ie=0;ie<=this.order-ae;ie++)ee+=Math.pow($,ae)*Math.pow(J,ie)*this.coefficients[te][0],te++;return ee}toJSON(){var Q={name:"polyfit2D",order:this.order,coefficients:this.coefficients};return this.quality&&(Q.quality=this.quality),Q}static load(Q){if("polyfit2D"!==Q.name)throw new TypeError("not a polyfit2D model");return new W(!0,Q)}}I.exports=W},{"./base-regression":100,"ml-matrix":87}],104:[function(D,I){"use strict";var R=D("./util").maybeToPrecision,T=D("./base-regression"),L=D("ml-matrix");class E extends T{constructor(G,Z,W,Q){if(super(),!0===G)this.coefficients=Z.coefficients,this.powers=Z.powers,this.M=Z.M,Z.quality&&(this.quality=Z.quality);else{var $=G.length;if($!==Z.length)throw new RangeError("input and output array have a different length");var J=void 0;if(Array.isArray(W))J=W,W=J.length;else for(W++,J=Array(W),ae=0;ae<W;ae++)J[ae]=ae;var ee=new L($,W),te=new L([Z]),ae,ie;for(ae=0;ae<W;ae++)for(ie=0;ie<$;ie++)ee[ie][ae]=0===J[ae]?1:Math.pow(G[ie],J[ae]);var ne=ee.transposeView(),oe=ne.mmul(ee),le=ne.mmul(te.transposeView());this.coefficients=oe.solve(le).to1DArray(),this.powers=J,this.M=W-1,(Q||{}).computeQuality&&(this.quality=this.modelQuality(G,Z))}}_predict(G){var Z=0;for(var W=0;W<this.powers.length;W++)Z+=this.coefficients[W]*Math.pow(G,this.powers[W]);return Z}toJSON(){var G={name:"polynomialRegression",coefficients:this.coefficients,powers:this.powers,M:this.M};return this.quality&&(G.quality=this.quality),G}toString(G){return this._toFormula(G,!1)}toLaTeX(G){return this._toFormula(G,!0)}_toFormula(G,Z){var W="^",Q="",$=" * ";Z&&(W="^{",Q="}",$="");var J="",ee;for(var te=0;te<this.coefficients.length;te++)ee="",0!==this.coefficients[te]&&(ee=0===this.powers[te]?R(this.coefficients[te],G):1===this.powers[te]?R(this.coefficients[te],G)+$+"x":R(this.coefficients[te],G)+$+"x"+W+this.powers[te]+Q,0<this.coefficients[te]&&te!==this.coefficients.length-1?ee=" + "+ee:te!==this.coefficients.length-1&&(ee=" "+ee)),J=ee+J;return" + "===J.charAt(0)&&(J=J.slice(1)),"f(x) = "+J}static load(G){if("polynomialRegression"!==G.name)throw new TypeError("not a polynomial regression model");return new E(!0,G)}}I.exports=E},{"./base-regression":100,"./util":109,"ml-matrix":87}],105:[function(D,I){"use strict";var R=D("./util").maybeToPrecision,T=D("./polynomial-regression"),L=D("./base-regression");class E extends L{constructor(G,Z,W,Q){if(super(),!0===G)this.A=Z.A,this.M=Z.M,Z.quality&&(this.quality=Z.quality);else{var $=G.length;if($!==Z.length)throw new RangeError("input and output array have a different length");var J=new T(G,Z,[W],{computeCoefficient:!0});this.A=J.coefficients[0],this.M=W,(Q||{}).computeQuality&&(this.quality=this.modelQuality(G,Z))}}_predict(G){return this.A*Math.pow(G,this.M)}toJSON(){var G={name:"potentialRegression",A:this.A,M:this.M};return this.quality&&(G.quality=this.quality),G}toString(G){return"f(x) = "+R(this.A,G)+" * x^"+this.M}toLaTeX(G){return 0<=this.M?"f(x) = "+R(this.A,G)+"x^{"+this.M+"}":"f(x) = \\frac{"+R(this.A,G)+"}{x^{"+-this.M+"}}"}static load(G){if("potentialRegression"!==G.name)throw new TypeError("not a potential regression model");return new E(!0,G)}}I.exports=E},{"./base-regression":100,"./polynomial-regression":104,"./util":109}],106:[function(D,I){"use strict";var R=D("./util").maybeToPrecision,T=D("./simple-linear-regression"),L=D("./base-regression");class E extends L{constructor(G,Z,W){if(super(),!0===G)this.A=Z.A,this.B=Z.B,this.quality=Z.quality||{},Z.quality.r&&(this.quality.r=Z.quality.r,this.quality.r2=Z.quality.r2),Z.quality.chi2&&(this.quality.chi2=Z.quality.chi2);else{var Q=G.length;if(Q!==Z.length)throw new RangeError("input and output array have a different length");var $=Array(Q),J=Array(Q);for(var ee=0;ee<Q;ee++)$[ee]=Math.log(G[ee]),J[ee]=Math.log(Z[ee]);var te=new T($,J,{computeCoefficient:!1});this.A=Math.exp(te.intercept),this.B=te.slope,(W||{}).computeQuality&&(this.quality=this.modelQuality(G,Z))}}_predict(G){return this.A*Math.pow(G,this.B)}toJSON(){var G={name:"powerRegression",A:this.A,B:this.B};return this.quality&&(G.quality=this.quality),G}toString(G){return"f(x) = "+R(this.A,G)+" * x^"+R(this.B,G)}toLaTeX(G){return 0<=this.B?"f(x) = "+R(this.A,G)+"x^{"+R(this.B,G)+"}":"f(x) = \\frac{"+R(this.A,G)+"}{x^{"+R(-this.B,G)+"}}"}static load(G){if("powerRegression"!==G.name)throw new TypeError("not a power regression model");return new E(!0,G)}}I.exports=E},{"./base-regression":100,"./simple-linear-regression":107,"./util":109}],107:[function(D,I){"use strict";var R=D("./util").maybeToPrecision,T=D("./base-regression");class L extends T{constructor(E,G,Z){if(Z=Z||{},super(),!0===E)this.slope=G.slope,this.intercept=G.intercept,this.quality=G.quality||{},G.quality.r&&(this.quality.r=G.quality.r,this.quality.r2=G.quality.r2),G.quality.chi2&&(this.quality.chi2=G.quality.chi2);else{var W=E.length;if(W!==G.length)throw new RangeError("input and output array have a different length");var Q=0,$=0,J=0,ee=0;for(var te=0;te<W;te++)Q+=E[te],$+=G[te],J+=E[te]*E[te],ee+=E[te]*G[te];var ae=W*ee-Q*$;this.slope=ae/(W*J-Q*Q),this.intercept=1/W*$-this.slope*(1/W)*Q,this.coefficients=[this.intercept,this.slope],Z.computeQuality&&(this.quality=this.modelQuality(E,G))}}toJSON(){var E={name:"simpleLinearRegression",slope:this.slope,intercept:this.intercept};return this.quality&&(E.quality=this.quality),E}_predict(E){return this.slope*E+this.intercept}computeX(E){return(E-this.intercept)/this.slope}toString(E){var G="f(x) = ";if(this.slope){var Z=R(this.slope,E);if(G+=(1e-5>Math.abs(Z-1)?"":Z+" * ")+"x",this.intercept){var W=Math.abs(this.intercept),Q=W===this.intercept?"+":"-";G+=" "+Q+" "+R(W,E)}}else G+=R(this.intercept,E);return G}toLaTeX(E){return this.toString(E)}static load(E){if("simpleLinearRegression"!==E.name)throw new TypeError("not a SLR model");return new L(!0,E)}}I.exports=L},{"./base-regression":100,"./util":109}],108:[function(D,I){"use strict";var R=D("./base-regression"),T=D("./util").maybeToPrecision,L=D("ml-stat/array").median;class E extends R{constructor(G,Z,W){if(W=W||{},super(),!0===G)this.slope=Z.slope,this.intercept=Z.intercept,this.quality=Object.assign({},Z.quality,this.quality);else{var Q=G.length;if(Q!==Z.length)throw new RangeError("Input and output array have a different length");var $=Array(Q*Q),J=0;for(var ee=0;ee<Q;++ee)for(var te=ee+1;te<Q;++te)G[ee]!==G[te]&&($[J++]=(Z[te]-Z[ee])/(G[te]-G[ee]));$.length=J;var ae=L($),ie=Array(Q);for(var ne=0;ne<Q;++ne)ie[ne]=Z[ne]-ae*G[ne];this.slope=ae,this.intercept=L(ie),this.coefficients=[this.intercept,this.slope],W.computeQuality&&(this.quality=this.modelQuality(G,Z))}}toJSON(){var G={name:"TheilSenRegression",slope:this.slope,intercept:this.intercept};return this.quality&&(G.quality=this.quality),G}_predict(G){return this.slope*G+this.intercept}computeX(G){return(G-this.intercept)/this.slope}toString(G){var Z="f(x) = ";if(this.slope){var W=T(this.slope,G);if(Z+=(1e-5>Math.abs(W-1)?"":W+" * ")+"x",this.intercept){var Q=Math.abs(this.intercept),$=Q===this.intercept?"+":"-";Z+=" "+$+" "+T(Q,G)}}else Z+=T(this.intercept,G);return Z}toLaTeX(G){return this.toString(G)}static load(G){if("TheilSenRegression"!==G.name)throw new TypeError("not a Theil-Sen model");return new E(!0,G)}}I.exports=E},{"./base-regression":100,"./util":109,"ml-stat/array":110}],109:[function(D,I,R){"use strict";R.maybeToPrecision=function(L,E){return 0>L?(L=-1*L,E)?"- "+L.toPrecision(E):"- "+L.toString():E?L.toPrecision(E):L.toString()}},{}],110:[function(D,I,R){"use strict";function T(L,E){return L-E}R.sum=function(E){var L=0;for(var G=0;G<E.length;G++)L+=E[G];return L},R.max=function(E){var L=E[0],G=E.length;for(var Z=1;Z<G;Z++)E[Z]>L&&(L=E[Z]);return L},R.min=function(E){var L=E[0],G=E.length;for(var Z=1;Z<G;Z++)E[Z]<L&&(L=E[Z]);return L},R.minMax=function(E){var G=E[0],Z=E[0],W=E.length;for(var Q=1;Q<W;Q++)E[Q]<G&&(G=E[Q]),E[Q]>Z&&(Z=E[Q]);return{min:G,max:Z}},R.arithmeticMean=function(E){var G=0,Z=E.length;for(var W=0;W<Z;W++)G+=E[W];return G/Z},R.mean=R.arithmeticMean,R.geometricMean=function(E){var G=1,Z=E.length;for(var W=0;W<Z;W++)G*=E[W];return Math.pow(G,1/Z)},R.logMean=function(E){var G=0,Z=E.length;for(var W=0;W<Z;W++)G+=Math.log(E[W]);return G/Z},R.grandMean=function(E,G){var Z=0,W=0,Q=E.length;for(var $=0;$<Q;$++)Z+=G[$]*E[$],W+=G[$];return Z/W},R.truncatedMean=function(E,G,Z){Z===void 0&&(Z=!1),Z||(E=[].concat(E).sort(T));var W=E.length,Q=Math.floor(W*G),$=0;for(var J=Q;J<W-Q;J++)$+=E[J];return $/(W-2*Q)},R.harmonicMean=function(E){var G=0,Z=E.length;for(var W=0;W<Z;W++){if(0===E[W])throw new RangeError("value at index "+W+"is zero");G+=1/E[W]}return Z/G},R.contraHarmonicMean=function(E){var G=0,Z=0,W=E.length;for(var Q=0;Q<W;Q++)G+=E[Q]*E[Q],Z+=E[Q];if(0>Z)throw new RangeError("sum of values is negative");return G/Z},R.median=function(E,G){G===void 0&&(G=!1),G||(E=[].concat(E).sort(T));var Z=E.length,W=Math.floor(Z/2);return 0==Z%2?0.5*(E[W-1]+E[W]):E[W]},R.variance=function(E,G){G===void 0&&(G=!0);var Z=R.mean(E),W=0,Q=E.length;for(var $=0;$<Q;$++){var J=E[$]-Z;W+=J*J}return G?W/(Q-1):W/Q},R.standardDeviation=function(E,G){return Math.sqrt(R.variance(E,G))},R.standardError=function(E){return R.standardDeviation(E)/Math.sqrt(E.length)},R.robustMeanAndStdev=function(E){var G=0,Z=0,W=E.length,Q=0;for(Q=0;Q<W;Q++)G+=E[Q];G/=W;var $=Array(W);for(Q=0;Q<W;Q++)$[Q]=Math.abs(E[Q]-G);return $.sort(T),Z=1==W%2?$[(W-1)/2]/0.6745:0.5*($[W/2]+$[W/2-1])/0.6745,{mean:G,stdev:Z}},R.quartiles=function(E,G){"undefined"==typeof G&&(G=!1),G||(E=[].concat(E).sort(T));var Z=E.length/4,W=E[Math.ceil(Z)-1],Q=R.median(E,!0),$=E[Math.ceil(3*Z)-1];return{q1:W,q2:Q,q3:$}},R.pooledStandardDeviation=function(E,G){return Math.sqrt(R.pooledVariance(E,G))},R.pooledVariance=function(E,G){"undefined"==typeof G&&(G=!0);var Z=0,W=0,Q=E.length;for(var $=0;$<Q;$++){var J=E[$],ee=R.variance(J);Z+=(J.length-1)*ee,W+=G?J.length-1:J.length}return Z/W},R.mode=function(E){var G=E.length,Z=Array(G),W;for(W=0;W<G;W++)Z[W]=0;var Q=Array(G),$=0;for(W=0;W<G;W++){var J=Q.indexOf(E[W]);0<=J?Z[J]++:(Q[$]=E[W],Z[$]=1,$++)}var ee=0,te=0;for(W=0;W<$;W++)Z[W]>ee&&(ee=Z[W],te=W);return Q[te]},R.covariance=function(E,G,Z){"undefined"==typeof Z&&(Z=!0);var W=R.mean(E),Q=R.mean(G);if(E.length!==G.length)throw"Vectors do not have the same dimensions";var $=0,J=E.length;for(var ee=0;ee<J;ee++){var te=E[ee]-W,ae=G[ee]-Q;$+=te*ae}return Z?$/(J-1):$/J},R.skewness=function(E,G){"undefined"==typeof G&&(G=!0);var Z=R.mean(E),W=0,Q=0,$=E.length;for(var J=0;J<$;J++){var ee=E[J]-Z;W+=ee*ee,Q+=ee*ee*ee}var te=W/$,ae=Q/$,ie=ae/Math.pow(te,3/2);if(G){var ne=Math.sqrt($*($-1));return ne/($-2)*ie}return ie},R.kurtosis=function(E,G){"undefined"==typeof G&&(G=!0);var Z=R.mean(E),W=E.length,Q=0,$=0;for(var J=0;J<W;J++){var ee=E[J]-Z;Q+=ee*ee,$+=ee*ee*ee*ee}var te=Q/W,ae=$/W;if(G){var ie=Q/(W-1),ne=$/(ie*ie);return W*(W+1)/((W-1)*(W-2)*(W-3))*ne-3*((W-1)*(W-1)/((W-2)*(W-3)))}return ae/(te*te)-3},R.entropy=function(E,G){"undefined"==typeof G&&(G=0);var Z=0,W=E.length;for(var Q=0;Q<W;Q++)Z+=E[Q]*Math.log(E[Q]+G);return-Z},R.weightedMean=function(E,G){var Z=0,W=E.length;for(var Q=0;Q<W;Q++)Z+=E[Q]*G[Q];return Z},R.weightedStandardDeviation=function(E,G){return Math.sqrt(R.weightedVariance(E,G))},R.weightedVariance=function(E,G){var Z=R.weightedMean(E,G),W=0,Q=E.length,$=0,J=0;for(var ee=0;ee<Q;ee++){var te=E[ee]-Z,ae=G[ee];W+=ae*(te*te),J+=ae,$+=ae*ae}return W*(J/(J*J-$))},R.center=function(E,G){"undefined"==typeof G&&(G=!1);var Z=E;G||(Z=[].concat(E));var W=R.mean(Z),Q=Z.length;for(var $=0;$<Q;$++)Z[$]-=W},R.standardize=function(E,G,Z){"undefined"==typeof G&&(G=R.standardDeviation(E)),"undefined"==typeof Z&&(Z=!1);var W=E.length,Q=Z?E:Array(W);for(var $=0;$<W;$++)Q[$]=E[$]/G;return Q},R.cumulativeSum=function(E){var G=E.length,Z=Array(G);Z[0]=E[0];for(var W=1;W<G;W++)Z[W]=Z[W-1]+E[W];return Z}},{}],111:[function(D,I,R){"use strict";R.array=D("./array"),R.matrix=D("./matrix")},{"./array":110,"./matrix":112}],112:[function(D,I,R){"use strict";function T(E,G){return E-G}var L=D("./array");R.max=function(G){var E=-(1/0);for(var Z=0;Z<G.length;Z++)for(var W=0;W<G[Z].length;W++)G[Z][W]>E&&(E=G[Z][W]);return E},R.min=function(G){var E=1/0;for(var Z=0;Z<G.length;Z++)for(var W=0;W<G[Z].length;W++)G[Z][W]<E&&(E=G[Z][W]);return E},R.minMax=function(G){var Z=1/0,W=-(1/0);for(var Q=0;Q<G.length;Q++)for(var $=0;$<G[Q].length;$++)G[Q][$]<Z&&(Z=G[Q][$]),G[Q][$]>W&&(W=G[Q][$]);return{min:Z,max:W}},R.entropy=function(G,Z){"undefined"==typeof Z&&(Z=0);var W=0,Q=G.length,$=G[0].length;for(var J=0;J<Q;J++)for(var ee=0;ee<$;ee++)W+=G[J][ee]*Math.log(G[J][ee]+Z);return-W},R.mean=function(G,Z){"undefined"==typeof Z&&(Z=0);var W=G.length,Q=G[0].length,$,J,ee,te;if(-1===Z){for($=[0],J=W*Q,ee=0;ee<W;ee++)for(te=0;te<Q;te++)$[0]+=G[ee][te];$[0]/=J}else if(0===Z)for($=Array(Q),J=W,te=0;te<Q;te++){for($[te]=0,ee=0;ee<W;ee++)$[te]+=G[ee][te];$[te]/=J}else if(1===Z)for($=Array(W),J=Q,te=0;te<W;te++){for($[te]=0,ee=0;ee<Q;ee++)$[te]+=G[te][ee];$[te]/=J}else throw new Error("Invalid dimension");return $},R.sum=function(G,Z){"undefined"==typeof Z&&(Z=0);var W=G.length,Q=G[0].length,$,J,ee;if(-1===Z)for($=[0],J=0;J<W;J++)for(ee=0;ee<Q;ee++)$[0]+=G[J][ee];else if(0===Z)for($=Array(Q),ee=0;ee<Q;ee++)for($[ee]=0,J=0;J<W;J++)$[ee]+=G[J][ee];else if(1===Z)for($=Array(W),ee=0;ee<W;ee++)for($[ee]=0,J=0;J<Q;J++)$[ee]+=G[ee][J];else throw new Error("Invalid dimension");return $},R.product=function(G,Z){"undefined"==typeof Z&&(Z=0);var W=G.length,Q=G[0].length,$,J,ee;if(-1===Z)for($=[1],J=0;J<W;J++)for(ee=0;ee<Q;ee++)$[0]*=G[J][ee];else if(0===Z)for($=Array(Q),ee=0;ee<Q;ee++)for($[ee]=1,J=0;J<W;J++)$[ee]*=G[J][ee];else if(1===Z)for($=Array(W),ee=0;ee<W;ee++)for($[ee]=1,J=0;J<Q;J++)$[ee]*=G[ee][J];else throw new Error("Invalid dimension");return $},R.standardDeviation=function(G,Z,W){var Q=R.variance(G,Z,W),$=Q.length;for(var J=0;J<$;J++)Q[J]=Math.sqrt(Q[J]);return Q},R.variance=function(G,Z,W){"undefined"==typeof W&&(W=!0),Z=Z||R.mean(G);var Q=G.length;if(0===Q)return[];var $=G[0].length,J=Array($);for(var ee=0;ee<$;ee++){var te=0,ae=0,ie=0;for(var ne=0;ne<Q;ne++)ie=G[ne][ee]-Z[ee],te+=ie,ae+=ie*ie;J[ee]=W?(ae-te*te/Q)/(Q-1):(ae-te*te/Q)/Q}return J},R.median=function(G){var Z=G.length,W=G[0].length,Q=Array(W);for(var $=0;$<W;$++){var J=Array(Z);for(var ee=0;ee<Z;ee++)J[ee]=G[ee][$];J.sort(T);var te=J.length;Q[$]=0==te%2?0.5*(J[te/2]+J[te/2-1]):J[Math.floor(te/2)]}return Q},R.mode=function(G){var Z=G.length,W=G[0].length,Q=Array(W),$,J;for($=0;$<W;$++){var ee=Array(Z);for(var te=0;te<Z;te++)ee[te]=0;var ae=Array(Z),ie=0;for(J=0;J<Z;J++){var ne=ae.indexOf(G[J][$]);0<=ne?ee[ne]++:(ae[ie]=G[J][$],ee[ie]=1,ie++)}var oe=0,le=0;for(J=0;J<ie;J++)ee[J]>oe&&(oe=ee[J],le=J);Q[$]=ae[le]}return Q},R.skewness=function(G,Z){"undefined"==typeof Z&&(Z=!0);var W=R.mean(G),Q=G.length,$=W.length,J=Array($);for(var ee=0;ee<$;ee++){var te=0,ae=0;for(var ie=0;ie<Q;ie++){var ne=G[ie][ee]-W[ee];te+=ne*ne,ae+=ne*ne*ne}var oe=te/Q,le=ae/Q,se=le/Math.pow(oe,3/2);if(Z){var de=Math.sqrt(Q*(Q-1));J[ee]=de/(Q-2)*se}else J[ee]=se}return J},R.kurtosis=function(G,Z){"undefined"==typeof Z&&(Z=!0);var W=R.mean(G),Q=G.length,$=G[0].length,J=Array($);for(var ee=0;ee<$;ee++){var te=0,ae=0;for(var ie=0;ie<Q;ie++){var ne=G[ie][ee]-W[ee];te+=ne*ne,ae+=ne*ne*ne*ne}var oe=te/Q,le=ae/Q;if(Z){var se=te/(Q-1),de=ae/(se*se);J[ee]=Q*(Q+1)/((Q-1)*(Q-2)*(Q-3))*de-3*((Q-1)*(Q-1)/((Q-2)*(Q-3)))}else J[ee]=le/(oe*oe)-3}return J},R.standardError=function(G){var Z=G.length,W=R.standardDeviation(G),Q=W.length,$=Array(Q),J=Math.sqrt(Z);for(var ee=0;ee<Q;ee++)$[ee]=W[ee]/J;return $},R.covariance=function(G,Z){return R.scatter(G,void 0,Z)},R.scatter=function(G,Z,W){"undefined"==typeof W&&(W=0),"undefined"==typeof Z&&(0===W?Z=G.length-1:1==W&&(Z=G[0].length-1));var Q=R.mean(G,W),$=G.length;if(0===$)return[[]];var J=G[0].length,ee,te,ae,ie,ne;if(0===W){for(ee=Array(J),te=0;te<J;te++)ee[te]=Array(J);for(te=0;te<J;te++)for(ae=te;ae<J;ae++){for(ie=0,ne=0;ne<$;ne++)ie+=(G[ne][ae]-Q[ae])*(G[ne][te]-Q[te]);ie/=Z,ee[te][ae]=ie,ee[ae][te]=ie}}else if(1===W){for(ee=Array($),te=0;te<$;te++)ee[te]=Array($);for(te=0;te<$;te++)for(ae=te;ae<$;ae++){for(ie=0,ne=0;ne<J;ne++)ie+=(G[ae][ne]-Q[ae])*(G[te][ne]-Q[te]);ie/=Z,ee[te][ae]=ie,ee[ae][te]=ie}}else throw new Error("Invalid dimension");return ee},R.correlation=function(G){var Z=R.mean(G),W=R.standardDeviation(G,!0,Z),Q=R.zScores(G,Z,W),$=G.length,J=G[0].length,ee,te,ae=Array(J);for(ee=0;ee<J;ee++)ae[ee]=Array(J);for(ee=0;ee<J;ee++)for(te=ee;te<J;te++){var ie=0;for(var ne=0,oe=Q.length;ne<oe;ne++)ie+=Q[ne][te]*Q[ne][ee];ie/=$-1,ae[ee][te]=ie,ae[te][ee]=ie}return ae},R.zScores=function(G,Z,W){return Z=Z||R.mean(G),"undefined"==typeof W&&(W=R.standardDeviation(G,!0,Z)),R.standardize(R.center(G,Z,!1),W,!0)},R.center=function(G,Z,W){Z=Z||R.mean(G);var Q=G,$=G.length,J,ee,te;if(!W)for(Q=Array($),J=0;J<$;J++)Q[J]=Array(G[J].length);for(J=0;J<$;J++){var ae=Q[J];for(ee=0,te=ae.length;ee<te;ee++)ae[ee]=G[J][ee]-Z[ee]}return Q},R.standardize=function(G,Z,W){"undefined"==typeof Z&&(Z=R.standardDeviation(G));var Q=G,$=G.length,J,ee,te;if(!W)for(Q=Array($),J=0;J<$;J++)Q[J]=Array(G[J].length);for(J=0;J<$;J++){var ae=Q[J],ie=G[J];for(ee=0,te=ae.length;ee<te;ee++)0===Z[ee]||isNaN(Z[ee])||(ae[ee]=ie[ee]/Z[ee])}return Q},R.weightedVariance=function(G,Z){var W=R.mean(G),Q=G.length;if(0===Q)return[];var $=G[0].length,J=Array($);for(var ee=0;ee<$;ee++){var te=0,ae=0,ie=0;for(var ne=0;ne<Q;ne++){var oe=G[ne][ee]-W[ee],le=Z[ne];te+=le*(oe*oe),ie+=le,ae+=le*le}J[ee]=te*(ie/(ie*ie-ae))}return J},R.weightedMean=function(G,Z,W){"undefined"==typeof W&&(W=0);var Q=G.length;if(0===Q)return[];var $=G[0].length,J,ee,te,ae,ie,ne;if(0===W){for(J=Array($),ee=0;ee<$;ee++)J[ee]=0;for(ee=0;ee<Q;ee++)for(ne=G[ee],ie=Z[ee],ae=0;ae<$;ae++)J[ae]+=ne[ae]*ie}else if(1===W){for(J=Array(Q),ee=0;ee<Q;ee++)J[ee]=0;for(ae=0;ae<Q;ae++)for(ne=G[ae],ie=Z[ae],ee=0;ee<$;ee++)J[ae]+=ne[ee]*ie}else throw new Error("Invalid dimension");var oe=L.sum(Z);if(0!==oe)for(ee=0,te=J.length;ee<te;ee++)J[ee]/=oe;return J},R.weightedCovariance=function(G,Z,W,Q){Q=Q||0,W=W||R.weightedMean(G,Z,Q);var $=0,J=0;for(var ee=0,te=Z.length;ee<te;ee++)$+=Z[ee],J+=Z[ee]*Z[ee];var ae=$/($*$-J);return R.weightedScatter(G,Z,W,ae,Q)},R.weightedScatter=function(G,Z,W,Q,$){$=$||0,W=W||R.weightedMean(G,Z,$),"undefined"==typeof Q&&(Q=1);var J=G.length;if(0===J)return[[]];var ee=G[0].length,te,ae,ie,ne,oe;if(0===$){for(te=Array(ee),ae=0;ae<ee;ae++)te[ae]=Array(ee);for(ae=0;ae<ee;ae++)for(ie=ae;ie<ee;ie++){for(oe=0,ne=0;ne<J;ne++)oe+=Z[ne]*(G[ne][ie]-W[ie])*(G[ne][ae]-W[ae]);te[ae][ie]=oe*Q,te[ie][ae]=oe*Q}}else if(1===$){for(te=Array(J),ae=0;ae<J;ae++)te[ae]=Array(J);for(ae=0;ae<J;ae++)for(ie=ae;ie<J;ie++){for(oe=0,ne=0;ne<ee;ne++)oe+=Z[ne]*(G[ie][ne]-W[ie])*(G[ae][ne]-W[ae]);te[ae][ie]=oe*Q,te[ie][ae]=oe*Q}}else throw new Error("Invalid dimension");return te}},{"./array":110}],113:[function(D,I){"use strict";I.exports="function"==typeof Promise?Promise:D("lie")},{lie:57}],114:[function(D,I){"use strict";I.exports=function(T,L){T=T||0;var E=Array(T);for(var G=0;G<T;G++)E[G]=L;return E}},{}],115:[function(D,I,R){"use strict";function T(E){if("number"!=typeof E||L(E))throw new TypeError("Expected a number")}var L=D("number-is-nan");R.asc=function(E,G){return T(E),T(G),E-G},R.desc=function(E,G){return T(E),T(G),G-E}},{"number-is-nan":116}],116:[function(D,I){"use strict";I.exports=Number.isNaN||function(R){return R!==R}},{}],117:[function(D,I){"use strict";var R=Object.prototype.hasOwnProperty,T=Object.prototype.toString,L=Array.prototype.slice,E=D("./isArguments"),G=Object.prototype.propertyIsEnumerable,Z=!G.call({toString:null},"toString"),W=G.call(function(){},"prototype"),Q=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],$=function(ne){var oe=ne.constructor;return oe&&oe.prototype===ne},J={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},ee=function(){if("undefined"==typeof window)return!1;for(var ie in window)try{if(!J["$"+ie]&&R.call(window,ie)&&null!==window[ie]&&"object"==typeof window[ie])try{$(window[ie])}catch(ne){return!0}}catch(ne){return!0}return!1}(),te=function(ne){if("undefined"==typeof window||!ee)return $(ne);try{return $(ne)}catch(oe){return!1}},ae=function(ne){var oe=null!==ne&&"object"==typeof ne,le="[object Function]"===T.call(ne),se=E(ne),de=oe&&"[object String]"===T.call(ne),ue=[];if(!oe&&!le&&!se)throw new TypeError("Object.keys called on a non-object");if(de&&0<ne.length&&!R.call(ne,0))for(var he=0;he<ne.length;++he)ue.push(he+"");if(se&&0<ne.length)for(var me=0;me<ne.length;++me)ue.push(me+"");else for(var ce in ne)!(W&&le&&"prototype"===ce)&&R.call(ne,ce)&&ue.push(ce+"");if(Z){var ge=te(ne);for(var pe=0;pe<Q.length;++pe)!(ge&&"constructor"===Q[pe])&&R.call(ne,Q[pe])&&ue.push(Q[pe])}return ue};ae.shim=function(){if(Object.keys){var ne=function(){return 2===(Object.keys(arguments)||"").length}(1,2);if(!ne){var oe=Object.keys;Object.keys=function(se){return E(se)?oe(L.call(se)):oe(se)}}}else Object.keys=ae;return Object.keys||ae},I.exports=ae},{"./isArguments":118}],118:[function(D,I){"use strict";var R=Object.prototype.toString;I.exports=function(L){var E=R.call(L),G="[object Arguments]"===E;return G||(G="[object Array]"!==E&&null!==L&&"object"==typeof L&&"number"==typeof L.length&&0<=L.length&&"[object Function]"===R.call(L.callee)),G}},{}],119:[function(D,I){"use strict";var R=D("./lib/utils/common").assign,T=D("./lib/deflate"),L=D("./lib/inflate"),E=D("./lib/zlib/constants"),G={};R(G,T,L,E),I.exports=G},{"./lib/deflate":120,"./lib/inflate":121,"./lib/utils/common":122,"./lib/zlib/constants":125}],120:[function(D,I,R){"use strict";function T(ie){if(!(this instanceof T))return new T(ie);this.options=G.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},ie||{});var ne=this.options;ne.raw&&0<ne.windowBits?ne.windowBits=-ne.windowBits:ne.gzip&&0<ne.windowBits&&16>ne.windowBits&&(ne.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Q,this.strm.avail_out=0;var oe=E.deflateInit2(this.strm,ne.level,ne.method,ne.windowBits,ne.memLevel,ne.strategy);if(oe!==ee)throw new Error(W[oe]);if(ne.header&&E.deflateSetHeader(this.strm,ne.header),ne.dictionary){var le;if(le="string"==typeof ne.dictionary?Z.string2buf(ne.dictionary):"[object ArrayBuffer]"===$.call(ne.dictionary)?new Uint8Array(ne.dictionary):ne.dictionary,oe=E.deflateSetDictionary(this.strm,le),oe!==ee)throw new Error(W[oe]);this._dict_set=!0}}function L(ie,ne){var oe=new T(ne);if(oe.push(ie,!0),oe.err)throw oe.msg;return oe.result}var E=D("./zlib/deflate"),G=D("./utils/common"),Z=D("./utils/strings"),W=D("./zlib/messages"),Q=D("./zlib/zstream"),$=Object.prototype.toString,J=4,ee=0,te=1,ae=2;T.prototype.push=function(ie,ne){var oe=this.strm,le=this.options.chunkSize,se,de;if(this.ended)return!1;de=ne===~~ne?ne:!0===ne?J:0,oe.input="string"==typeof ie?Z.string2buf(ie):"[object ArrayBuffer]"===$.call(ie)?new Uint8Array(ie):ie,oe.next_in=0,oe.avail_in=oe.input.length;do{if(0===oe.avail_out&&(oe.output=new G.Buf8(le),oe.next_out=0,oe.avail_out=le),se=E.deflate(oe,de),se!==te&&se!==ee)return this.onEnd(se),this.ended=!0,!1;(0===oe.avail_out||0===oe.avail_in&&(de===J||de===ae))&&("string"===this.options.to?this.onData(Z.buf2binstring(G.shrinkBuf(oe.output,oe.next_out))):this.onData(G.shrinkBuf(oe.output,oe.next_out)))}while((0<oe.avail_in||0===oe.avail_out)&&se!==te);return de===J?(se=E.deflateEnd(this.strm),this.onEnd(se),this.ended=!0,se===ee):de!==ae||(this.onEnd(ee),oe.avail_out=0,!0)},T.prototype.onData=function(ie){this.chunks.push(ie)},T.prototype.onEnd=function(ie){ie===ee&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=G.flattenChunks(this.chunks)),this.chunks=[],this.err=ie,this.msg=this.strm.msg},R.Deflate=T,R.deflate=L,R.deflateRaw=function(ne,oe){return oe=oe||{},oe.raw=!0,L(ne,oe)},R.gzip=function(ne,oe){return oe=oe||{},oe.gzip=!0,L(ne,oe)}},{"./utils/common":122,"./utils/strings":123,"./zlib/deflate":127,"./zlib/messages":132,"./zlib/zstream":134}],121:[function(D,I,R){"use strict";function T(te){if(!(this instanceof T))return new T(te);this.options=G.assign({chunkSize:16384,windowBits:0,to:""},te||{});var ae=this.options;ae.raw&&0<=ae.windowBits&&16>ae.windowBits&&(ae.windowBits=-ae.windowBits,0===ae.windowBits&&(ae.windowBits=-15)),0<=ae.windowBits&&16>ae.windowBits&&!(te&&te.windowBits)&&(ae.windowBits+=32),15<ae.windowBits&&48>ae.windowBits&&0==(15&ae.windowBits)&&(ae.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new $,this.strm.avail_out=0;var ie=E.inflateInit2(this.strm,ae.windowBits);if(ie!==W.Z_OK)throw new Error(Q[ie]);this.header=new J,E.inflateGetHeader(this.strm,this.header)}function L(te,ae){var ie=new T(ae);if(ie.push(te,!0),ie.err)throw ie.msg;return ie.result}var E=D("./zlib/inflate"),G=D("./utils/common"),Z=D("./utils/strings"),W=D("./zlib/constants"),Q=D("./zlib/messages"),$=D("./zlib/zstream"),J=D("./zlib/gzheader"),ee=Object.prototype.toString;T.prototype.push=function(te,ae){var ie=this.strm,ne=this.options.chunkSize,oe=this.options.dictionary,ce=!1,le,se,de,ue,he,me;if(this.ended)return!1;se=ae===~~ae?ae:!0===ae?W.Z_FINISH:W.Z_NO_FLUSH,ie.input="string"==typeof te?Z.binstring2buf(te):"[object ArrayBuffer]"===ee.call(te)?new Uint8Array(te):te,ie.next_in=0,ie.avail_in=ie.input.length;do{if(0===ie.avail_out&&(ie.output=new G.Buf8(ne),ie.next_out=0,ie.avail_out=ne),le=E.inflate(ie,W.Z_NO_FLUSH),le===W.Z_NEED_DICT&&oe&&(me="string"==typeof oe?Z.string2buf(oe):"[object ArrayBuffer]"===ee.call(oe)?new Uint8Array(oe):oe,le=E.inflateSetDictionary(this.strm,me)),le===W.Z_BUF_ERROR&&!0==ce&&(le=W.Z_OK,ce=!1),le!==W.Z_STREAM_END&&le!==W.Z_OK)return this.onEnd(le),this.ended=!0,!1;ie.next_out&&(0===ie.avail_out||le===W.Z_STREAM_END||0===ie.avail_in&&(se===W.Z_FINISH||se===W.Z_SYNC_FLUSH))&&("string"===this.options.to?(de=Z.utf8border(ie.output,ie.next_out),ue=ie.next_out-de,he=Z.buf2string(ie.output,de),ie.next_out=ue,ie.avail_out=ne-ue,ue&&G.arraySet(ie.output,ie.output,de,ue,0),this.onData(he)):this.onData(G.shrinkBuf(ie.output,ie.next_out))),0===ie.avail_in&&0===ie.avail_out&&(ce=!0)}while((0<ie.avail_in||0===ie.avail_out)&&le!==W.Z_STREAM_END);return le===W.Z_STREAM_END&&(se=W.Z_FINISH),se===W.Z_FINISH?(le=E.inflateEnd(this.strm),this.onEnd(le),this.ended=!0,le===W.Z_OK):se!==W.Z_SYNC_FLUSH||(this.onEnd(W.Z_OK),ie.avail_out=0,!0)},T.prototype.onData=function(te){this.chunks.push(te)},T.prototype.onEnd=function(te){te===W.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=G.flattenChunks(this.chunks)),this.chunks=[],this.err=te,this.msg=this.strm.msg},R.Inflate=T,R.inflate=L,R.inflateRaw=function(ae,ie){return ie=ie||{},ie.raw=!0,L(ae,ie)},R.ungzip=L},{"./utils/common":122,"./utils/strings":123,"./zlib/constants":125,"./zlib/gzheader":128,"./zlib/inflate":130,"./zlib/messages":132,"./zlib/zstream":134}],122:[function(D,I,R){"use strict";var T="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;R.assign=function(G){for(var Z=Array.prototype.slice.call(arguments,1);Z.length;){var W=Z.shift();if(W){if("object"!=typeof W)throw new TypeError(W+"must be non-object");for(var Q in W)W.hasOwnProperty(Q)&&(G[Q]=W[Q])}}return G},R.shrinkBuf=function(G,Z){return G.length===Z?G:G.subarray?G.subarray(0,Z):(G.length=Z,G)};var L={arraySet:function(Z,W,Q,$,J){if(W.subarray&&Z.subarray)return void Z.set(W.subarray(Q,Q+$),J);for(var ee=0;ee<$;ee++)Z[J+ee]=W[Q+ee]},flattenChunks:function(Z){var W,Q,$,J,ee,te;for($=0,W=0,Q=Z.length;W<Q;W++)$+=Z[W].length;for(te=new Uint8Array($),J=0,(W=0,Q=Z.length);W<Q;W++)ee=Z[W],te.set(ee,J),J+=ee.length;return te}},E={arraySet:function(Z,W,Q,$,J){for(var ee=0;ee<$;ee++)Z[J+ee]=W[Q+ee]},flattenChunks:function(Z){return[].concat.apply([],Z)}};R.setTyped=function(G){G?(R.Buf8=Uint8Array,R.Buf16=Uint16Array,R.Buf32=Int32Array,R.assign(R,L)):(R.Buf8=Array,R.Buf16=Array,R.Buf32=Array,R.assign(R,E))},R.setTyped(T)},{}],123:[function(D,I,R){"use strict";function T(Q,$){if(65537>$&&(Q.subarray&&G||!Q.subarray&&E))return String.fromCharCode.apply(null,L.shrinkBuf(Q,$));var J="";for(var ee=0;ee<$;ee++)J+=String.fromCharCode(Q[ee]);return J}var L=D("./common"),E=!0,G=!0;try{String.fromCharCode.apply(null,[0])}catch(Q){E=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Q){G=!1}var Z=new L.Buf8(256);for(var W=0;256>W;W++)Z[W]=252<=W?6:248<=W?5:240<=W?4:224<=W?3:192<=W?2:1;Z[254]=Z[254]=1,R.string2buf=function(Q){var ie=Q.length,ne=0,$,J,ee,te,ae;for(te=0;te<ie;te++)J=Q.charCodeAt(te),55296==(64512&J)&&te+1<ie&&(ee=Q.charCodeAt(te+1),56320==(64512&ee)&&(J=65536+(J-55296<<10)+(ee-56320),te++)),ne+=128>J?1:2048>J?2:65536>J?3:4;for($=new L.Buf8(ne),ae=0,te=0;ae<ne;te++)J=Q.charCodeAt(te),55296==(64512&J)&&te+1<ie&&(ee=Q.charCodeAt(te+1),56320==(64512&ee)&&(J=65536+(J-55296<<10)+(ee-56320),te++)),128>J?$[ae++]=J:2048>J?($[ae++]=192|J>>>6,$[ae++]=128|63&J):65536>J?($[ae++]=224|J>>>12,$[ae++]=128|63&J>>>6,$[ae++]=128|63&J):($[ae++]=240|J>>>18,$[ae++]=128|63&J>>>12,$[ae++]=128|63&J>>>6,$[ae++]=128|63&J);return $},R.buf2binstring=function(Q){return T(Q,Q.length)},R.binstring2buf=function(Q){var $=new L.Buf8(Q.length);for(var J=0,ee=$.length;J<ee;J++)$[J]=Q.charCodeAt(J);return $},R.buf2string=function(Q,$){var J,ee,te,ae,ie=$||Q.length,ne=Array(2*ie);for(ee=0,J=0;J<ie;){if(te=Q[J++],128>te){ne[ee++]=te;continue}if(ae=Z[te],4<ae){ne[ee++]=65533,J+=ae-1;continue}for(te&=2===ae?31:3===ae?15:7;1<ae&&J<ie;)te=te<<6|63&Q[J++],ae--;if(1<ae){ne[ee++]=65533;continue}65536>te?ne[ee++]=te:(te-=65536,ne[ee++]=55296|1023&te>>10,ne[ee++]=56320|1023&te)}return T(ne,ee)},R.utf8border=function(Q,$){var J;for($=$||Q.length,$>Q.length&&($=Q.length),J=$-1;0<=J&&128==(192&Q[J]);)J--;return 0>J?$:0===J?$:J+Z[Q[J]]>$?J:$}},{"./common":122}],124:[function(D,I){"use strict";I.exports=function(T,L,E,G){for(var Z=0|65535&T,W=0|65535&T>>>16,Q=0;0!==E;){Q=2e3<E?2e3:E,E-=Q;do Z=0|Z+L[G++],W=0|W+Z;while(--Q);Z%=65521,W%=65521}return 0|(Z|W<<16)}},{}],125:[function(D,I){"use strict";I.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],126:[function(D,I){"use strict";var R=function(){var E=[],L;for(var G=0;256>G;G++){L=G;for(var Z=0;8>Z;Z++)L=1&L?3988292384^L>>>1:L>>>1;E[G]=L}return E}();I.exports=function(L,E,G,Z){L^=-1;for(var W=Z;W<Z+G;W++)L=L>>>8^R[255&(L^E[W])];return-1^L}},{}],127:[function(D,I,R){"use strict";function T(Oe,Ye){return Oe.msg=fe[Ye],Ye}function L(Oe){return(Oe<<1)-(4<Oe?9:0)}function E(Oe){for(var Ye=Oe.length;0<=--Ye;)Oe[Ye]=0}function G(Oe){var Ye=Oe.state,Ue=Ye.pending;Ue>Oe.avail_out&&(Ue=Oe.avail_out);0===Ue||(me.arraySet(Oe.output,Ye.pending_buf,Ye.pending_out,Ue,Oe.next_out),Oe.next_out+=Ue,Ye.pending_out+=Ue,Oe.total_out+=Ue,Oe.avail_out-=Ue,Ye.pending-=Ue,0===Ye.pending&&(Ye.pending_out=0))}function Z(Oe,Ye){ce._tr_flush_block(Oe,0<=Oe.block_start?Oe.block_start:-1,Oe.strstart-Oe.block_start,Ye),Oe.block_start=Oe.strstart,G(Oe.strm)}function W(Oe,Ye){Oe.pending_buf[Oe.pending++]=Ye}function Q(Oe,Ye){Oe.pending_buf[Oe.pending++]=255&Ye>>>8,Oe.pending_buf[Oe.pending++]=255&Ye}function $(Oe,Ye,Ue,Xe){var Ge=Oe.avail_in;return(Ge>Xe&&(Ge=Xe),0===Ge)?0:(Oe.avail_in-=Ge,me.arraySet(Ye,Oe.input,Oe.next_in,Ge,Ue),1===Oe.state.wrap?Oe.adler=ge(Oe.adler,Ye,Ge,Ue):2===Oe.state.wrap&&(Oe.adler=pe(Oe.adler,Ye,Ge,Ue)),Oe.next_in+=Ge,Oe.total_in+=Ge,Ge)}function J(Oe,Ye){var Ue=Oe.max_chain_length,Xe=Oe.strstart,Ge,He,Ze=Oe.prev_length,We=Oe.nice_match,Ke=Oe.strstart>Oe.w_size-Ie?Oe.strstart-(Oe.w_size-Ie):0,Qe=Oe.window,$e=Oe.w_mask,Je=Oe.prev,et=Oe.strstart+Se,at=Qe[Xe+Ze-1],nt=Qe[Xe+Ze];Oe.prev_length>=Oe.good_match&&(Ue>>=2),We>Oe.lookahead&&(We=Oe.lookahead);do{if(Ge=Ye,Qe[Ge+Ze]!==nt||Qe[Ge+Ze-1]!==at||Qe[Ge]!==Qe[Xe]||Qe[++Ge]!==Qe[Xe+1])continue;Xe+=2,Ge++;do;while(Qe[++Xe]===Qe[++Ge]&&Qe[++Xe]===Qe[++Ge]&&Qe[++Xe]===Qe[++Ge]&&Qe[++Xe]===Qe[++Ge]&&Qe[++Xe]===Qe[++Ge]&&Qe[++Xe]===Qe[++Ge]&&Qe[++Xe]===Qe[++Ge]&&Qe[++Xe]===Qe[++Ge]&&Xe<et);if(He=Se-(et-Xe),Xe=et-Se,He>Ze){if(Oe.match_start=Ye,Ze=He,He>=We)break;at=Qe[Xe+Ze-1],nt=Qe[Xe+Ze]}}while((Ye=Je[Ye&$e])>Ke&&0!=--Ue);return Ze<=Oe.lookahead?Ze:Oe.lookahead}function ee(Oe){var Ye=Oe.w_size,Ue,Xe,Ge,He,Ze;do{if(He=Oe.window_size-Oe.lookahead-Oe.strstart,Oe.strstart>=Ye+(Ye-Ie)){me.arraySet(Oe.window,Oe.window,Ye,Ye,0),Oe.match_start-=Ye,Oe.strstart-=Ye,Oe.block_start-=Ye,Xe=Oe.hash_size,Ue=Xe;do Ge=Oe.head[--Ue],Oe.head[Ue]=Ge>=Ye?Ge-Ye:0;while(--Xe);Xe=Ye,Ue=Xe;do Ge=Oe.prev[--Ue],Oe.prev[Ue]=Ge>=Ye?Ge-Ye:0;while(--Xe);He+=Ye}if(0===Oe.strm.avail_in)break;if(Xe=$(Oe.strm,Oe.window,Oe.strstart+Oe.lookahead,He),Oe.lookahead+=Xe,Oe.lookahead+Oe.insert>=De)for(Ze=Oe.strstart-Oe.insert,Oe.ins_h=Oe.window[Ze],Oe.ins_h=(Oe.ins_h<<Oe.hash_shift^Oe.window[Ze+1])&Oe.hash_mask;Oe.insert&&(Oe.ins_h=(Oe.ins_h<<Oe.hash_shift^Oe.window[Ze+De-1])&Oe.hash_mask,Oe.prev[Ze&Oe.w_mask]=Oe.head[Oe.ins_h],Oe.head[Oe.ins_h]=Ze,Ze++,Oe.insert--,!(Oe.lookahead+Oe.insert<De)););}while(Oe.lookahead<Ie&&0!==Oe.strm.avail_in)}function te(Oe,Ye){for(var Ue,Xe;;){if(Oe.lookahead<Ie){if(ee(Oe),Oe.lookahead<Ie&&Ye===_e)return Ee;if(0===Oe.lookahead)break}if(Ue=0,Oe.lookahead>=De&&(Oe.ins_h=(Oe.ins_h<<Oe.hash_shift^Oe.window[Oe.strstart+De-1])&Oe.hash_mask,Ue=Oe.prev[Oe.strstart&Oe.w_mask]=Oe.head[Oe.ins_h],Oe.head[Oe.ins_h]=Oe.strstart),0!==Ue&&Oe.strstart-Ue<=Oe.w_size-Ie&&(Oe.match_length=J(Oe,Ue)),!(Oe.match_length>=De))Xe=ce._tr_tally(Oe,0,Oe.window[Oe.strstart]),Oe.lookahead--,Oe.strstart++;else if(Xe=ce._tr_tally(Oe,Oe.strstart-Oe.match_start,Oe.match_length-De),Oe.lookahead-=Oe.match_length,Oe.match_length<=Oe.max_lazy_match&&Oe.lookahead>=De){Oe.match_length--;do Oe.strstart++,Oe.ins_h=(Oe.ins_h<<Oe.hash_shift^Oe.window[Oe.strstart+De-1])&Oe.hash_mask,Ue=Oe.prev[Oe.strstart&Oe.w_mask]=Oe.head[Oe.ins_h],Oe.head[Oe.ins_h]=Oe.strstart;while(0!=--Oe.match_length);Oe.strstart++}else Oe.strstart+=Oe.match_length,Oe.match_length=0,Oe.ins_h=Oe.window[Oe.strstart],Oe.ins_h=(Oe.ins_h<<Oe.hash_shift^Oe.window[Oe.strstart+1])&Oe.hash_mask;if(Xe&&(Z(Oe,!1),0===Oe.strm.avail_out))return Ee}return Oe.insert=Oe.strstart<De-1?Oe.strstart:De-1,Ye===be?(Z(Oe,!0),0===Oe.strm.avail_out?Ve:Ne):Oe.last_lit&&(Z(Oe,!1),0===Oe.strm.avail_out)?Ee:Fe}function ae(Oe,Ye){for(var Ue,Xe,Ge;;){if(Oe.lookahead<Ie){if(ee(Oe),Oe.lookahead<Ie&&Ye===_e)return Ee;if(0===Oe.lookahead)break}if(Ue=0,Oe.lookahead>=De&&(Oe.ins_h=(Oe.ins_h<<Oe.hash_shift^Oe.window[Oe.strstart+De-1])&Oe.hash_mask,Ue=Oe.prev[Oe.strstart&Oe.w_mask]=Oe.head[Oe.ins_h],Oe.head[Oe.ins_h]=Oe.strstart),Oe.prev_length=Oe.match_length,Oe.prev_match=Oe.match_start,Oe.match_length=De-1,0!==Ue&&Oe.prev_length<Oe.max_lazy_match&&Oe.strstart-Ue<=Oe.w_size-Ie&&(Oe.match_length=J(Oe,Ue),5>=Oe.match_length&&(1===Oe.strategy||Oe.match_length===De&&4096<Oe.strstart-Oe.match_start)&&(Oe.match_length=De-1)),Oe.prev_length>=De&&Oe.match_length<=Oe.prev_length){Ge=Oe.strstart+Oe.lookahead-De,Xe=ce._tr_tally(Oe,Oe.strstart-1-Oe.prev_match,Oe.prev_length-De),Oe.lookahead-=Oe.prev_length-1,Oe.prev_length-=2;do++Oe.strstart<=Ge&&(Oe.ins_h=(Oe.ins_h<<Oe.hash_shift^Oe.window[Oe.strstart+De-1])&Oe.hash_mask,Ue=Oe.prev[Oe.strstart&Oe.w_mask]=Oe.head[Oe.ins_h],Oe.head[Oe.ins_h]=Oe.strstart);while(0!=--Oe.prev_length);if(Oe.match_available=0,Oe.match_length=De-1,Oe.strstart++,Xe&&(Z(Oe,!1),0===Oe.strm.avail_out))return Ee}else if(!Oe.match_available)Oe.match_available=1,Oe.strstart++,Oe.lookahead--;else if(Xe=ce._tr_tally(Oe,0,Oe.window[Oe.strstart-1]),Xe&&Z(Oe,!1),Oe.strstart++,Oe.lookahead--,0===Oe.strm.avail_out)return Ee}return Oe.match_available&&(Xe=ce._tr_tally(Oe,0,Oe.window[Oe.strstart-1]),Oe.match_available=0),Oe.insert=Oe.strstart<De-1?Oe.strstart:De-1,Ye===be?(Z(Oe,!0),0===Oe.strm.avail_out?Ve:Ne):Oe.last_lit&&(Z(Oe,!1),0===Oe.strm.avail_out)?Ee:Fe}function ie(Oe,Ye){for(var Ze=Oe.window,Ue,Xe,Ge,He;;){if(Oe.lookahead<=Se){if(ee(Oe),Oe.lookahead<=Se&&Ye===_e)return Ee;if(0===Oe.lookahead)break}if(Oe.match_length=0,Oe.lookahead>=De&&0<Oe.strstart&&(Ge=Oe.strstart-1,Xe=Ze[Ge],Xe===Ze[++Ge]&&Xe===Ze[++Ge]&&Xe===Ze[++Ge])){He=Oe.strstart+Se;do;while(Xe===Ze[++Ge]&&Xe===Ze[++Ge]&&Xe===Ze[++Ge]&&Xe===Ze[++Ge]&&Xe===Ze[++Ge]&&Xe===Ze[++Ge]&&Xe===Ze[++Ge]&&Xe===Ze[++Ge]&&Ge<He);Oe.match_length=Se-(He-Ge),Oe.match_length>Oe.lookahead&&(Oe.match_length=Oe.lookahead)}if(Oe.match_length>=De?(Ue=ce._tr_tally(Oe,1,Oe.match_length-De),Oe.lookahead-=Oe.match_length,Oe.strstart+=Oe.match_length,Oe.match_length=0):(Ue=ce._tr_tally(Oe,0,Oe.window[Oe.strstart]),Oe.lookahead--,Oe.strstart++),Ue&&(Z(Oe,!1),0===Oe.strm.avail_out))return Ee}return Oe.insert=0,Ye===be?(Z(Oe,!0),0===Oe.strm.avail_out?Ve:Ne):Oe.last_lit&&(Z(Oe,!1),0===Oe.strm.avail_out)?Ee:Fe}function ne(Oe,Ye){for(var Ue;;){if(0===Oe.lookahead&&(ee(Oe),0===Oe.lookahead)){if(Ye===_e)return Ee;break}if(Oe.match_length=0,Ue=ce._tr_tally(Oe,0,Oe.window[Oe.strstart]),Oe.lookahead--,Oe.strstart++,Ue&&(Z(Oe,!1),0===Oe.strm.avail_out))return Ee}return Oe.insert=0,Ye===be?(Z(Oe,!0),0===Oe.strm.avail_out?Ve:Ne):Oe.last_lit&&(Z(Oe,!1),0===Oe.strm.avail_out)?Ee:Fe}function oe(Oe,Ye,Ue,Xe,Ge){this.good_length=Oe,this.max_lazy=Ye,this.nice_length=Ue,this.max_chain=Xe,this.func=Ge}function le(Oe){Oe.window_size=2*Oe.w_size,E(Oe.head),Oe.max_lazy_match=qe[Oe.level].max_lazy,Oe.good_match=qe[Oe.level].good_length,Oe.nice_match=qe[Oe.level].nice_length,Oe.max_chain_length=qe[Oe.level].max_chain,Oe.strstart=0,Oe.block_start=0,Oe.lookahead=0,Oe.insert=0,Oe.match_length=Oe.prev_length=De-1,Oe.match_available=0,Oe.ins_h=0}function se(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=je,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new me.Buf16(2*(2*Pe+1)),this.dyn_dtree=new me.Buf16(122),this.bl_tree=new me.Buf16(78),E(this.dyn_ltree),E(this.dyn_dtree),E(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new me.Buf16(16),this.heap=new me.Buf16(2*Pe+1),E(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new me.Buf16(2*Pe+1),E(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function de(Oe){var Ye;return Oe&&Oe.state?(Oe.total_in=Oe.total_out=0,Oe.data_type=2,Ye=Oe.state,Ye.pending=0,Ye.pending_out=0,0>Ye.wrap&&(Ye.wrap=-Ye.wrap),Ye.status=Ye.wrap?Ce:Te,Oe.adler=2===Ye.wrap?0:1,Ye.last_flush=_e,ce._tr_init(Ye),xe):T(Oe,we)}function ue(Oe){var Ye=de(Oe);return Ye===xe&&le(Oe.state),Ye}function he(Oe,Ye,Ue,Xe,Ge,He){if(!Oe)return we;var Ze=1;if(-1===Ye&&(Ye=6),0>Xe?(Ze=0,Xe=-Xe):15<Xe&&(Ze=2,Xe-=16),1>Ge||9<Ge||Ue!==je||8>Xe||15<Xe||0>Ye||9<Ye||0>He||4<He)return T(Oe,we);8===Xe&&(Xe=9);var We=new se;return Oe.state=We,We.strm=Oe,We.wrap=Ze,We.gzhead=null,We.w_bits=Xe,We.w_size=1<<We.w_bits,We.w_mask=We.w_size-1,We.hash_bits=Ge+7,We.hash_size=1<<We.hash_bits,We.hash_mask=We.hash_size-1,We.hash_shift=~~((We.hash_bits+De-1)/De),We.window=new me.Buf8(2*We.w_size),We.head=new me.Buf16(We.hash_size),We.prev=new me.Buf16(We.w_size),We.lit_bufsize=1<<Ge+6,We.pending_buf_size=4*We.lit_bufsize,We.pending_buf=new me.Buf8(We.pending_buf_size),We.d_buf=1*We.lit_bufsize,We.l_buf=3*We.lit_bufsize,We.level=Ye,We.strategy=He,We.method=Ue,ue(Oe)}var me=D("../utils/common"),ce=D("./trees"),ge=D("./adler32"),pe=D("./crc32"),fe=D("./messages"),_e=0,be=4,ye=5,xe=0,ke=1,we=-2,ve=-5,Me=2,je=8,Pe=286,De=3,Se=258,Ie=Se+De+1,Ce=42,Ae=69,Re=73,Be=91,ze=103,Te=113,Le=666,Ee=1,Fe=2,Ve=3,Ne=4,qe=[new oe(0,0,0,0,function(Ye,Ue){var Xe=65535;for(Xe>Ye.pending_buf_size-5&&(Xe=Ye.pending_buf_size-5);;){if(1>=Ye.lookahead){if(ee(Ye),0===Ye.lookahead&&Ue===_e)return Ee;if(0===Ye.lookahead)break}Ye.strstart+=Ye.lookahead,Ye.lookahead=0;var Ge=Ye.block_start+Xe;if((0===Ye.strstart||Ye.strstart>=Ge)&&(Ye.lookahead=Ye.strstart-Ge,Ye.strstart=Ge,Z(Ye,!1),0===Ye.strm.avail_out))return Ee;if(Ye.strstart-Ye.block_start>=Ye.w_size-Ie&&(Z(Ye,!1),0===Ye.strm.avail_out))return Ee}return Ye.insert=0,Ue===be?(Z(Ye,!0),0===Ye.strm.avail_out?Ve:Ne):Ye.strstart>Ye.block_start&&(Z(Ye,!1),0===Ye.strm.avail_out)?Ee:Ee}),new oe(4,4,8,4,te),new oe(4,5,16,8,te),new oe(4,6,32,32,te),new oe(4,4,16,16,ae),new oe(8,16,32,32,ae),new oe(8,16,128,128,ae),new oe(8,32,128,256,ae),new oe(32,128,258,1024,ae),new oe(32,258,258,4096,ae)];R.deflateInit=function(Ye,Ue){return he(Ye,Ue,je,15,8,0)},R.deflateInit2=he,R.deflateReset=ue,R.deflateResetKeep=de,R.deflateSetHeader=function(Ye,Ue){return Ye&&Ye.state?2===Ye.state.wrap?(Ye.state.gzhead=Ue,xe):we:we},R.deflate=function(Ye,Ue){var Xe,Ge,He,Ze;if(!Ye||!Ye.state||Ue>ye||0>Ue)return Ye?T(Ye,we):we;if(Ge=Ye.state,!Ye.output||!Ye.input&&0!==Ye.avail_in||Ge.status===Le&&Ue!==be)return T(Ye,0===Ye.avail_out?ve:we);if(Ge.strm=Ye,Xe=Ge.last_flush,Ge.last_flush=Ue,Ge.status===Ce)if(2===Ge.wrap)Ye.adler=0,W(Ge,31),W(Ge,139),W(Ge,8),Ge.gzhead?(W(Ge,(Ge.gzhead.text?1:0)+(Ge.gzhead.hcrc?2:0)+(Ge.gzhead.extra?4:0)+(Ge.gzhead.name?8:0)+(Ge.gzhead.comment?16:0)),W(Ge,255&Ge.gzhead.time),W(Ge,255&Ge.gzhead.time>>8),W(Ge,255&Ge.gzhead.time>>16),W(Ge,255&Ge.gzhead.time>>24),W(Ge,9===Ge.level?2:Ge.strategy>=Me||2>Ge.level?4:0),W(Ge,255&Ge.gzhead.os),Ge.gzhead.extra&&Ge.gzhead.extra.length&&(W(Ge,255&Ge.gzhead.extra.length),W(Ge,255&Ge.gzhead.extra.length>>8)),Ge.gzhead.hcrc&&(Ye.adler=pe(Ye.adler,Ge.pending_buf,Ge.pending,0)),Ge.gzindex=0,Ge.status=Ae):(W(Ge,0),W(Ge,0),W(Ge,0),W(Ge,0),W(Ge,0),W(Ge,9===Ge.level?2:Ge.strategy>=Me||2>Ge.level?4:0),W(Ge,3),Ge.status=Te);else{var We=je+(Ge.w_bits-8<<4)<<8,Ke=-1;Ke=Ge.strategy>=Me||2>Ge.level?0:6>Ge.level?1:6===Ge.level?2:3,We|=Ke<<6,0!==Ge.strstart&&(We|=32),We+=31-We%31,Ge.status=Te,Q(Ge,We),0!==Ge.strstart&&(Q(Ge,Ye.adler>>>16),Q(Ge,65535&Ye.adler)),Ye.adler=1}if(Ge.status===Ae)if(Ge.gzhead.extra){for(He=Ge.pending;Ge.gzindex<(65535&Ge.gzhead.extra.length)&&!(Ge.pending===Ge.pending_buf_size&&(Ge.gzhead.hcrc&&Ge.pending>He&&(Ye.adler=pe(Ye.adler,Ge.pending_buf,Ge.pending-He,He)),G(Ye),He=Ge.pending,Ge.pending===Ge.pending_buf_size));)W(Ge,255&Ge.gzhead.extra[Ge.gzindex]),Ge.gzindex++;Ge.gzhead.hcrc&&Ge.pending>He&&(Ye.adler=pe(Ye.adler,Ge.pending_buf,Ge.pending-He,He)),Ge.gzindex===Ge.gzhead.extra.length&&(Ge.gzindex=0,Ge.status=Re)}else Ge.status=Re;if(Ge.status===Re)if(Ge.gzhead.name){He=Ge.pending;do{if(Ge.pending===Ge.pending_buf_size&&(Ge.gzhead.hcrc&&Ge.pending>He&&(Ye.adler=pe(Ye.adler,Ge.pending_buf,Ge.pending-He,He)),G(Ye),He=Ge.pending,Ge.pending===Ge.pending_buf_size)){Ze=1;break}Ze=Ge.gzindex<Ge.gzhead.name.length?255&Ge.gzhead.name.charCodeAt(Ge.gzindex++):0,W(Ge,Ze)}while(0!==Ze);Ge.gzhead.hcrc&&Ge.pending>He&&(Ye.adler=pe(Ye.adler,Ge.pending_buf,Ge.pending-He,He)),0===Ze&&(Ge.gzindex=0,Ge.status=Be)}else Ge.status=Be;if(Ge.status===Be)if(Ge.gzhead.comment){He=Ge.pending;do{if(Ge.pending===Ge.pending_buf_size&&(Ge.gzhead.hcrc&&Ge.pending>He&&(Ye.adler=pe(Ye.adler,Ge.pending_buf,Ge.pending-He,He)),G(Ye),He=Ge.pending,Ge.pending===Ge.pending_buf_size)){Ze=1;break}Ze=Ge.gzindex<Ge.gzhead.comment.length?255&Ge.gzhead.comment.charCodeAt(Ge.gzindex++):0,W(Ge,Ze)}while(0!==Ze);Ge.gzhead.hcrc&&Ge.pending>He&&(Ye.adler=pe(Ye.adler,Ge.pending_buf,Ge.pending-He,He)),0===Ze&&(Ge.status=ze)}else Ge.status=ze;if(Ge.status===ze&&(Ge.gzhead.hcrc?(Ge.pending+2>Ge.pending_buf_size&&G(Ye),Ge.pending+2<=Ge.pending_buf_size&&(W(Ge,255&Ye.adler),W(Ge,255&Ye.adler>>8),Ye.adler=0,Ge.status=Te)):Ge.status=Te),0!==Ge.pending){if(G(Ye),0===Ye.avail_out)return Ge.last_flush=-1,xe;}else if(0===Ye.avail_in&&L(Ue)<=L(Xe)&&Ue!==be)return T(Ye,ve);if(Ge.status===Le&&0!==Ye.avail_in)return T(Ye,ve);if(0!==Ye.avail_in||0!==Ge.lookahead||Ue!==_e&&Ge.status!==Le){var Qe=Ge.strategy===Me?ne(Ge,Ue):3===Ge.strategy?ie(Ge,Ue):qe[Ge.level].func(Ge,Ue);if((Qe===Ve||Qe===Ne)&&(Ge.status=Le),Qe===Ee||Qe===Ve)return 0===Ye.avail_out&&(Ge.last_flush=-1),xe;if(Qe===Fe&&(1===Ue?ce._tr_align(Ge):Ue!=ye&&(ce._tr_stored_block(Ge,0,0,!1),3==Ue&&(E(Ge.head),0===Ge.lookahead&&(Ge.strstart=0,Ge.block_start=0,Ge.insert=0))),G(Ye),0===Ye.avail_out))return Ge.last_flush=-1,xe}return Ue===be?0>=Ge.wrap?ke:(2===Ge.wrap?(W(Ge,255&Ye.adler),W(Ge,255&Ye.adler>>8),W(Ge,255&Ye.adler>>16),W(Ge,255&Ye.adler>>24),W(Ge,255&Ye.total_in),W(Ge,255&Ye.total_in>>8),W(Ge,255&Ye.total_in>>16),W(Ge,255&Ye.total_in>>24)):(Q(Ge,Ye.adler>>>16),Q(Ge,65535&Ye.adler)),G(Ye),0<Ge.wrap&&(Ge.wrap=-Ge.wrap),0===Ge.pending?ke:xe):xe},R.deflateEnd=function(Ye){var Ue;return Ye&&Ye.state?(Ue=Ye.state.status,Ue!==Ce&&Ue!==Ae&&Ue!==Re&&Ue!==Be&&Ue!==ze&&Ue!==Te&&Ue!==Le)?T(Ye,we):(Ye.state=null,Ue===Te?T(Ye,-3):xe):we},R.deflateSetDictionary=function(Ye,Ue){var Xe=Ue.length,Ge,He,Ze,We,Ke,Qe,$e,Je;if(!Ye||!Ye.state)return we;if(Ge=Ye.state,We=Ge.wrap,2===We||1===We&&Ge.status!==Ce||Ge.lookahead)return we;for(1===We&&(Ye.adler=ge(Ye.adler,Ue,Xe,0)),Ge.wrap=0,Xe>=Ge.w_size&&(0===We&&(E(Ge.head),Ge.strstart=0,Ge.block_start=0,Ge.insert=0),Je=new me.Buf8(Ge.w_size),me.arraySet(Je,Ue,Xe-Ge.w_size,Ge.w_size,0),Ue=Je,Xe=Ge.w_size),Ke=Ye.avail_in,Qe=Ye.next_in,$e=Ye.input,Ye.avail_in=Xe,Ye.next_in=0,Ye.input=Ue,ee(Ge);Ge.lookahead>=De;){He=Ge.strstart,Ze=Ge.lookahead-(De-1);do Ge.ins_h=(Ge.ins_h<<Ge.hash_shift^Ge.window[He+De-1])&Ge.hash_mask,Ge.prev[He&Ge.w_mask]=Ge.head[Ge.ins_h],Ge.head[Ge.ins_h]=He,He++;while(--Ze);Ge.strstart=He,Ge.lookahead=De-1,ee(Ge)}return Ge.strstart+=Ge.lookahead,Ge.block_start=Ge.strstart,Ge.insert=Ge.lookahead,Ge.lookahead=0,Ge.match_length=Ge.prev_length=De-1,Ge.match_available=0,Ye.next_in=Qe,Ye.input=$e,Ye.avail_in=Ke,Ge.wrap=We,xe},R.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":122,"./adler32":124,"./crc32":126,"./messages":132,"./trees":133}],128:[function(D,I){"use strict";I.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],129:[function(D,I){"use strict";var R=30;I.exports=function(L,E){var G,Z,W,Q,$,J,ee,te,ae,ie,ne,oe,le,se,de,ue,he,me,ce,ge,pe,fe,_e,be,ye;G=L.state,Z=L.next_in,be=L.input,W=Z+(L.avail_in-5),Q=L.next_out,ye=L.output,$=Q-(E-L.avail_out),J=Q+(L.avail_out-257),ee=G.dmax,te=G.wsize,ae=G.whave,ie=G.wnext,ne=G.window,oe=G.hold,le=G.bits,se=G.lencode,de=G.distcode,ue=(1<<G.lenbits)-1,he=(1<<G.distbits)-1;top:do{15>le&&(oe+=be[Z++]<<le,le+=8,oe+=be[Z++]<<le,le+=8),me=se[oe&ue];dolen:for(;;){if(ce=me>>>24,oe>>>=ce,le-=ce,ce=255&me>>>16,0===ce)ye[Q++]=65535&me;else if(16&ce){ge=65535&me,ce&=15,ce&&(le<ce&&(oe+=be[Z++]<<le,le+=8),ge+=oe&(1<<ce)-1,oe>>>=ce,le-=ce),15>le&&(oe+=be[Z++]<<le,le+=8,oe+=be[Z++]<<le,le+=8),me=de[oe&he];dodist:for(;;){if(ce=me>>>24,oe>>>=ce,le-=ce,ce=255&me>>>16,16&ce){if(pe=65535&me,ce&=15,le<ce&&(oe+=be[Z++]<<le,le+=8,le<ce&&(oe+=be[Z++]<<le,le+=8)),pe+=oe&(1<<ce)-1,pe>ee){L.msg="invalid distance too far back",G.mode=R;break top}if(oe>>>=ce,le-=ce,ce=Q-$,pe>ce){if(ce=pe-ce,ce>ae&&G.sane){L.msg="invalid distance too far back",G.mode=R;break top}if(fe=0,_e=ne,0===ie){if(fe+=te-ce,ce<ge){ge-=ce;do ye[Q++]=ne[fe++];while(--ce);fe=Q-pe,_e=ye}}else if(ie<ce){if(fe+=te+ie-ce,ce-=ie,ce<ge){ge-=ce;do ye[Q++]=ne[fe++];while(--ce);if(fe=0,ie<ge){ce=ie,ge-=ce;do ye[Q++]=ne[fe++];while(--ce);fe=Q-pe,_e=ye}}}else if(fe+=ie-ce,ce<ge){ge-=ce;do ye[Q++]=ne[fe++];while(--ce);fe=Q-pe,_e=ye}for(;2<ge;)ye[Q++]=_e[fe++],ye[Q++]=_e[fe++],ye[Q++]=_e[fe++],ge-=3;ge&&(ye[Q++]=_e[fe++],1<ge&&(ye[Q++]=_e[fe++]))}else{fe=Q-pe;do ye[Q++]=ye[fe++],ye[Q++]=ye[fe++],ye[Q++]=ye[fe++],ge-=3;while(2<ge);ge&&(ye[Q++]=ye[fe++],1<ge&&(ye[Q++]=ye[fe++]))}}else if(0==(64&ce)){me=de[(65535&me)+(oe&(1<<ce)-1)];continue dodist}else{L.msg="invalid distance code",G.mode=R;break top}break}}else if(0==(64&ce)){me=se[(65535&me)+(oe&(1<<ce)-1)];continue dolen}else if(32&ce){G.mode=12;break top}else{L.msg="invalid literal/length code",G.mode=R;break top}break}}while(Z<W&&Q<J);ge=le>>3,Z-=ge,le-=ge<<3,oe&=(1<<le)-1,L.next_in=Z,L.next_out=Q,L.avail_in=Z<W?5+(W-Z):5-(Z-W),L.avail_out=Q<J?257+(J-Q):257-(Q-J),G.hold=oe,G.bits=le}},{}],130:[function(D,I,R){"use strict";function T(Ze){return(255&Ze>>>24)+(65280&Ze>>>8)+((65280&Ze)<<8)+((255&Ze)<<24)}function L(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new J.Buf16(320),this.work=new J.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(Ze){var We;return Ze&&Ze.state?(We=Ze.state,Ze.total_in=Ze.total_out=We.total=0,Ze.msg="",We.wrap&&(Ze.adler=1&We.wrap),We.mode=ge,We.last=0,We.havedict=0,We.dmax=32768,We.head=null,We.hold=0,We.bits=0,We.lencode=We.lendyn=new J.Buf32(852),We.distcode=We.distdyn=new J.Buf32(592),We.sane=1,We.back=-1,de):ue}function G(Ze){var We;return Ze&&Ze.state?(We=Ze.state,We.wsize=0,We.whave=0,We.wnext=0,E(Ze)):ue}function Z(Ze,We){var Ke,Qe;return Ze&&Ze.state?(Qe=Ze.state,0>We?(Ke=0,We=-We):(Ke=(We>>4)+1,48>We&&(We&=15)),We&&(8>We||15<We))?ue:(null!==Qe.window&&Qe.wbits!==We&&(Qe.window=null),Qe.wrap=Ke,Qe.wbits=We,G(Ze)):ue}function W(Ze,We){var Ke,Qe;return Ze?(Qe=new L,Ze.state=Qe,Qe.window=null,Ke=Z(Ze,We),Ke!==de&&(Ze.state=null),Ke):ue}function Q(Ze){if(Xe){var We;for(Ge=new J.Buf32(512),He=new J.Buf32(32),We=0;144>We;)Ze.lens[We++]=8;for(;256>We;)Ze.lens[We++]=9;for(;280>We;)Ze.lens[We++]=7;for(;288>We;)Ze.lens[We++]=8;for(ie(ne,Ze.lens,0,288,Ge,0,Ze.work,{bits:9}),We=0;32>We;)Ze.lens[We++]=5;ie(oe,Ze.lens,0,32,He,0,Ze.work,{bits:5}),Xe=!1}Ze.lencode=Ge,Ze.lenbits=9,Ze.distcode=He,Ze.distbits=5}function $(Ze,We,Ke,Qe){var Je=Ze.state,$e;return null===Je.window&&(Je.wsize=1<<Je.wbits,Je.wnext=0,Je.whave=0,Je.window=new J.Buf8(Je.wsize)),Qe>=Je.wsize?(J.arraySet(Je.window,We,Ke-Je.wsize,Je.wsize,0),Je.wnext=0,Je.whave=Je.wsize):($e=Je.wsize-Je.wnext,$e>Qe&&($e=Qe),J.arraySet(Je.window,We,Ke-Qe,$e,Je.wnext),Qe-=$e,Qe?(J.arraySet(Je.window,We,Ke-Qe,Qe,0),Je.wnext=Qe,Je.whave=Je.wsize):(Je.wnext+=$e,Je.wnext===Je.wsize&&(Je.wnext=0),Je.whave<Je.wsize&&(Je.whave+=$e))),0}var J=D("../utils/common"),ee=D("./adler32"),te=D("./crc32"),ae=D("./inffast"),ie=D("./inftrees"),ne=1,oe=2,le=4,se=6,de=0,ue=-2,he=-3,me=-4,ce=8,ge=1,pe=2,fe=3,_e=4,be=5,ye=6,xe=7,ke=8,we=9,ve=10,Me=11,je=12,Pe=13,De=14,Se=15,Ie=16,Ce=17,Ae=18,Re=19,Be=20,ze=21,Te=22,Le=23,Ee=24,Fe=25,Ve=26,Ne=27,qe=28,Oe=29,Ye=30,Ue=31,Xe=!0,Ge,He;R.inflateReset=G,R.inflateReset2=Z,R.inflateResetKeep=E,R.inflateInit=function(We){return W(We,15)},R.inflateInit2=W,R.inflate=function(We,Ke){var ct=0,vt=new J.Buf8(4),Pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Qe,$e,Je,et,at,nt,ot,lt,rt,st,dt,ut,ht,mt,gt,pt,_t,bt,yt,xt,kt,wt,Mt,jt;if(!We||!We.state||!We.output||!We.input&&0!==We.avail_in)return ue;Qe=We.state,Qe.mode===je&&(Qe.mode=Pe),at=We.next_out,Je=We.output,ot=We.avail_out,et=We.next_in,$e=We.input,nt=We.avail_in,lt=Qe.hold,rt=Qe.bits,st=nt,dt=ot,wt=de;inf_leave:for(;;)switch(Qe.mode){case ge:if(0===Qe.wrap){Qe.mode=Pe;break}for(;16>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(2&Qe.wrap&&35615===lt){Qe.check=0,vt[0]=255&lt,vt[1]=255&lt>>>8,Qe.check=te(Qe.check,vt,2,0),lt=0,rt=0,Qe.mode=pe;break}if(Qe.flags=0,Qe.head&&(Qe.head.done=!1),!(1&Qe.wrap)||(((255&lt)<<8)+(lt>>8))%31){We.msg="incorrect header check",Qe.mode=Ye;break}if((15&lt)!=ce){We.msg="unknown compression method",Qe.mode=Ye;break}if(lt>>>=4,rt-=4,kt=(15&lt)+8,0===Qe.wbits)Qe.wbits=kt;else if(kt>Qe.wbits){We.msg="invalid window size",Qe.mode=Ye;break}Qe.dmax=1<<kt,We.adler=Qe.check=1,Qe.mode=512&lt?ve:je,lt=0,rt=0;break;case pe:for(;16>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(Qe.flags=lt,(255&Qe.flags)!=ce){We.msg="unknown compression method",Qe.mode=Ye;break}if(57344&Qe.flags){We.msg="unknown header flags set",Qe.mode=Ye;break}Qe.head&&(Qe.head.text=1&lt>>8),512&Qe.flags&&(vt[0]=255&lt,vt[1]=255&lt>>>8,Qe.check=te(Qe.check,vt,2,0)),lt=0,rt=0,Qe.mode=fe;case fe:for(;32>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}Qe.head&&(Qe.head.time=lt),512&Qe.flags&&(vt[0]=255&lt,vt[1]=255&lt>>>8,vt[2]=255&lt>>>16,vt[3]=255&lt>>>24,Qe.check=te(Qe.check,vt,4,0)),lt=0,rt=0,Qe.mode=_e;case _e:for(;16>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}Qe.head&&(Qe.head.xflags=255&lt,Qe.head.os=lt>>8),512&Qe.flags&&(vt[0]=255&lt,vt[1]=255&lt>>>8,Qe.check=te(Qe.check,vt,2,0)),lt=0,rt=0,Qe.mode=be;case be:if(1024&Qe.flags){for(;16>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}Qe.length=lt,Qe.head&&(Qe.head.extra_len=lt),512&Qe.flags&&(vt[0]=255&lt,vt[1]=255&lt>>>8,Qe.check=te(Qe.check,vt,2,0)),lt=0,rt=0}else Qe.head&&(Qe.head.extra=null);Qe.mode=ye;case ye:if(1024&Qe.flags&&(ut=Qe.length,ut>nt&&(ut=nt),ut&&(Qe.head&&(kt=Qe.head.extra_len-Qe.length,!Qe.head.extra&&(Qe.head.extra=Array(Qe.head.extra_len)),J.arraySet(Qe.head.extra,$e,et,ut,kt)),512&Qe.flags&&(Qe.check=te(Qe.check,$e,ut,et)),nt-=ut,et+=ut,Qe.length-=ut),Qe.length))break inf_leave;Qe.length=0,Qe.mode=xe;case xe:if(2048&Qe.flags){if(0===nt)break inf_leave;ut=0;do kt=$e[et+ut++],Qe.head&&kt&&65536>Qe.length&&(Qe.head.name+=String.fromCharCode(kt));while(kt&&ut<nt);if(512&Qe.flags&&(Qe.check=te(Qe.check,$e,ut,et)),nt-=ut,et+=ut,kt)break inf_leave}else Qe.head&&(Qe.head.name=null);Qe.length=0,Qe.mode=ke;case ke:if(4096&Qe.flags){if(0===nt)break inf_leave;ut=0;do kt=$e[et+ut++],Qe.head&&kt&&65536>Qe.length&&(Qe.head.comment+=String.fromCharCode(kt));while(kt&&ut<nt);if(512&Qe.flags&&(Qe.check=te(Qe.check,$e,ut,et)),nt-=ut,et+=ut,kt)break inf_leave}else Qe.head&&(Qe.head.comment=null);Qe.mode=we;case we:if(512&Qe.flags){for(;16>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(lt!==(65535&Qe.check)){We.msg="header crc mismatch",Qe.mode=Ye;break}lt=0,rt=0}Qe.head&&(Qe.head.hcrc=1&Qe.flags>>9,Qe.head.done=!0),We.adler=Qe.check=0,Qe.mode=je;break;case ve:for(;32>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}We.adler=Qe.check=T(lt),lt=0,rt=0,Qe.mode=Me;case Me:if(0===Qe.havedict)return We.next_out=at,We.avail_out=ot,We.next_in=et,We.avail_in=nt,Qe.hold=lt,Qe.bits=rt,2;We.adler=Qe.check=1,Qe.mode=je;case je:if(5===Ke||Ke===se)break inf_leave;case Pe:if(Qe.last){lt>>>=7&rt,rt-=7&rt,Qe.mode=Ne;break}for(;3>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}switch(Qe.last=1&lt,lt>>>=1,rt-=1,3&lt){case 0:Qe.mode=De;break;case 1:if(Q(Qe),Qe.mode=Be,Ke===se){lt>>>=2,rt-=2;break inf_leave}break;case 2:Qe.mode=Ce;break;case 3:We.msg="invalid block type",Qe.mode=Ye;}lt>>>=2,rt-=2;break;case De:for(lt>>>=7&rt,rt-=7&rt;32>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if((65535&lt)!=(65535^lt>>>16)){We.msg="invalid stored block lengths",Qe.mode=Ye;break}if(Qe.length=65535&lt,lt=0,rt=0,Qe.mode=Se,Ke===se)break inf_leave;case Se:Qe.mode=Ie;case Ie:if(ut=Qe.length,ut){if(ut>nt&&(ut=nt),ut>ot&&(ut=ot),0===ut)break inf_leave;J.arraySet(Je,$e,et,ut,at),nt-=ut,et+=ut,ot-=ut,at+=ut,Qe.length-=ut;break}Qe.mode=je;break;case Ce:for(;14>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(Qe.nlen=(31&lt)+257,lt>>>=5,rt-=5,Qe.ndist=(31&lt)+1,lt>>>=5,rt-=5,Qe.ncode=(15&lt)+4,lt>>>=4,rt-=4,286<Qe.nlen||30<Qe.ndist){We.msg="too many length or distance symbols",Qe.mode=Ye;break}Qe.have=0,Qe.mode=Ae;case Ae:for(;Qe.have<Qe.ncode;){for(;3>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}Qe.lens[Pt[Qe.have++]]=7&lt,lt>>>=3,rt-=3}for(;19>Qe.have;)Qe.lens[Pt[Qe.have++]]=0;if(Qe.lencode=Qe.lendyn,Qe.lenbits=7,Mt={bits:Qe.lenbits},wt=ie(0,Qe.lens,0,19,Qe.lencode,0,Qe.work,Mt),Qe.lenbits=Mt.bits,wt){We.msg="invalid code lengths set",Qe.mode=Ye;break}Qe.have=0,Qe.mode=Re;case Re:for(;Qe.have<Qe.nlen+Qe.ndist;){for(;;){if(ct=Qe.lencode[lt&(1<<Qe.lenbits)-1],gt=ct>>>24,pt=255&ct>>>16,_t=65535&ct,gt<=rt)break;if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(16>_t)lt>>>=gt,rt-=gt,Qe.lens[Qe.have++]=_t;else{if(16===_t){for(jt=gt+2;rt<jt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(lt>>>=gt,rt-=gt,0===Qe.have){We.msg="invalid bit length repeat",Qe.mode=Ye;break}kt=Qe.lens[Qe.have-1],ut=3+(3&lt),lt>>>=2,rt-=2}else if(17===_t){for(jt=gt+3;rt<jt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}lt>>>=gt,rt-=gt,kt=0,ut=3+(7&lt),lt>>>=3,rt-=3}else{for(jt=gt+7;rt<jt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}lt>>>=gt,rt-=gt,kt=0,ut=11+(127&lt),lt>>>=7,rt-=7}if(Qe.have+ut>Qe.nlen+Qe.ndist){We.msg="invalid bit length repeat",Qe.mode=Ye;break}for(;ut--;)Qe.lens[Qe.have++]=kt}}if(Qe.mode===Ye)break;if(0===Qe.lens[256]){We.msg="invalid code -- missing end-of-block",Qe.mode=Ye;break}if(Qe.lenbits=9,Mt={bits:Qe.lenbits},wt=ie(ne,Qe.lens,0,Qe.nlen,Qe.lencode,0,Qe.work,Mt),Qe.lenbits=Mt.bits,wt){We.msg="invalid literal/lengths set",Qe.mode=Ye;break}if(Qe.distbits=6,Qe.distcode=Qe.distdyn,Mt={bits:Qe.distbits},wt=ie(oe,Qe.lens,Qe.nlen,Qe.ndist,Qe.distcode,0,Qe.work,Mt),Qe.distbits=Mt.bits,wt){We.msg="invalid distances set",Qe.mode=Ye;break}if(Qe.mode=Be,Ke===se)break inf_leave;case Be:Qe.mode=ze;case ze:if(6<=nt&&258<=ot){We.next_out=at,We.avail_out=ot,We.next_in=et,We.avail_in=nt,Qe.hold=lt,Qe.bits=rt,ae(We,dt),at=We.next_out,Je=We.output,ot=We.avail_out,et=We.next_in,$e=We.input,nt=We.avail_in,lt=Qe.hold,rt=Qe.bits,Qe.mode===je&&(Qe.back=-1);break}for(Qe.back=0;;){if(ct=Qe.lencode[lt&(1<<Qe.lenbits)-1],gt=ct>>>24,pt=255&ct>>>16,_t=65535&ct,gt<=rt)break;if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(pt&&0==(240&pt)){for(bt=gt,yt=pt,xt=_t;;){if(ct=Qe.lencode[xt+((lt&(1<<bt+yt)-1)>>bt)],gt=ct>>>24,pt=255&ct>>>16,_t=65535&ct,bt+gt<=rt)break;if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}lt>>>=bt,rt-=bt,Qe.back+=bt}if(lt>>>=gt,rt-=gt,Qe.back+=gt,Qe.length=_t,0===pt){Qe.mode=Ve;break}if(32&pt){Qe.back=-1,Qe.mode=je;break}if(64&pt){We.msg="invalid literal/length code",Qe.mode=Ye;break}Qe.extra=15&pt,Qe.mode=Te;case Te:if(Qe.extra){for(jt=Qe.extra;rt<jt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}Qe.length+=lt&(1<<Qe.extra)-1,lt>>>=Qe.extra,rt-=Qe.extra,Qe.back+=Qe.extra}Qe.was=Qe.length,Qe.mode=Le;case Le:for(;;){if(ct=Qe.distcode[lt&(1<<Qe.distbits)-1],gt=ct>>>24,pt=255&ct>>>16,_t=65535&ct,gt<=rt)break;if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(0==(240&pt)){for(bt=gt,yt=pt,xt=_t;;){if(ct=Qe.distcode[xt+((lt&(1<<bt+yt)-1)>>bt)],gt=ct>>>24,pt=255&ct>>>16,_t=65535&ct,bt+gt<=rt)break;if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}lt>>>=bt,rt-=bt,Qe.back+=bt}if(lt>>>=gt,rt-=gt,Qe.back+=gt,64&pt){We.msg="invalid distance code",Qe.mode=Ye;break}Qe.offset=_t,Qe.extra=15&pt,Qe.mode=Ee;case Ee:if(Qe.extra){for(jt=Qe.extra;rt<jt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}Qe.offset+=lt&(1<<Qe.extra)-1,lt>>>=Qe.extra,rt-=Qe.extra,Qe.back+=Qe.extra}if(Qe.offset>Qe.dmax){We.msg="invalid distance too far back",Qe.mode=Ye;break}Qe.mode=Fe;case Fe:if(0===ot)break inf_leave;if(ut=dt-ot,Qe.offset>ut){if(ut=Qe.offset-ut,ut>Qe.whave&&Qe.sane){We.msg="invalid distance too far back",Qe.mode=Ye;break}ut>Qe.wnext?(ut-=Qe.wnext,ht=Qe.wsize-ut):ht=Qe.wnext-ut,ut>Qe.length&&(ut=Qe.length),mt=Qe.window}else mt=Je,ht=at-Qe.offset,ut=Qe.length;ut>ot&&(ut=ot),ot-=ut,Qe.length-=ut;do Je[at++]=mt[ht++];while(--ut);0===Qe.length&&(Qe.mode=ze);break;case Ve:if(0===ot)break inf_leave;Je[at++]=Qe.length,ot--,Qe.mode=ze;break;case Ne:if(Qe.wrap){for(;32>rt;){if(0===nt)break inf_leave;nt--,lt|=$e[et++]<<rt,rt+=8}if(dt-=ot,We.total_out+=dt,Qe.total+=dt,dt&&(We.adler=Qe.check=Qe.flags?te(Qe.check,Je,dt,at-dt):ee(Qe.check,Je,dt,at-dt)),dt=ot,(Qe.flags?lt:T(lt))!==Qe.check){We.msg="incorrect data check",Qe.mode=Ye;break}lt=0,rt=0}Qe.mode=qe;case qe:if(Qe.wrap&&Qe.flags){for(;32>rt;){if(0===nt)break inf_leave;nt--,lt+=$e[et++]<<rt,rt+=8}if(lt!==(4294967295&Qe.total)){We.msg="incorrect length check",Qe.mode=Ye;break}lt=0,rt=0}Qe.mode=Oe;case Oe:wt=1;break inf_leave;case Ye:wt=he;break inf_leave;case Ue:return me;case 32:default:return ue;}return(We.next_out=at,We.avail_out=ot,We.next_in=et,We.avail_in=nt,Qe.hold=lt,Qe.bits=rt,(Qe.wsize||dt!==We.avail_out&&Qe.mode<Ye&&(Qe.mode<Ne||Ke!==le))&&$(We,We.output,We.next_out,dt-We.avail_out))?(Qe.mode=Ue,me):(st-=We.avail_in,dt-=We.avail_out,We.total_in+=st,We.total_out+=dt,Qe.total+=dt,Qe.wrap&&dt&&(We.adler=Qe.check=Qe.flags?te(Qe.check,Je,dt,We.next_out-dt):ee(Qe.check,Je,dt,We.next_out-dt)),We.data_type=Qe.bits+(Qe.last?64:0)+(Qe.mode===je?128:0)+(Qe.mode===Be||Qe.mode===Se?256:0),(0===st&&0===dt||Ke===le)&&wt===de&&(wt=-5),wt)},R.inflateEnd=function(We){if(!We||!We.state)return ue;var Ke=We.state;return Ke.window&&(Ke.window=null),We.state=null,de},R.inflateGetHeader=function(We,Ke){var Qe;return We&&We.state?(Qe=We.state,0==(2&Qe.wrap))?ue:(Qe.head=Ke,Ke.done=!1,de):ue},R.inflateSetDictionary=function(We,Ke){var Qe=Ke.length,$e,Je,et;return We&&We.state?($e=We.state,0!==$e.wrap&&$e.mode!==Me)?ue:$e.mode===Me&&(Je=1,Je=ee(Je,Ke,Qe,0),Je!==$e.check)?he:(et=$(We,Ke,Qe,Qe),et)?($e.mode=Ue,me):($e.havedict=1,de):ue},R.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":122,"./adler32":124,"./crc32":126,"./inffast":129,"./inftrees":131}],131:[function(D,I){"use strict";var R=D("../utils/common"),T=15,L=852,E=592,G=0,Z=1,W=2,Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],$=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],ee=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];I.exports=function(ae,ie,ne,oe,le,se,de,ue){var he=ue.bits,me=0,ce=0,ge=0,pe=0,fe=0,_e=0,be=0,ye=0,xe=0,ke=0,De=null,Se=0,Ce=new R.Buf16(T+1),Ae=new R.Buf16(T+1),Re=null,Be=0,we,ve,Me,je,Pe,Ie,ze,Te,Le;for(me=0;me<=T;me++)Ce[me]=0;for(ce=0;ce<oe;ce++)Ce[ie[ne+ce]]++;for(fe=he,pe=T;1<=pe&&0===Ce[pe];pe--);if(fe>pe&&(fe=pe),0==pe)return le[se++]=20971520,le[se++]=20971520,ue.bits=1,0;for(ge=1;ge<pe&&0===Ce[ge];ge++);for(fe<ge&&(fe=ge),ye=1,me=1;me<=T;me++)if(ye<<=1,ye-=Ce[me],0>ye)return-1;if(0<ye&&(ae===G||1!=pe))return-1;for(Ae[1]=0,me=1;me<T;me++)Ae[me+1]=Ae[me]+Ce[me];for(ce=0;ce<oe;ce++)0!==ie[ne+ce]&&(de[Ae[ie[ne+ce]]++]=ce);if(ae===G?(De=Re=de,Ie=19):ae===Z?(De=Q,Se-=257,Re=$,Be-=257,Ie=256):(De=J,Re=ee,Ie=-1),ke=0,ce=0,me=ge,Pe=se,_e=fe,be=0,Me=-1,xe=1<<fe,je=xe-1,ae===Z&&xe>L||ae===W&&xe>E)return 1;for(var Ee=0;;){Ee++,ze=me-be,de[ce]<Ie?(Te=0,Le=de[ce]):de[ce]>Ie?(Te=Re[Be+de[ce]],Le=De[Se+de[ce]]):(Te=96,Le=0),we=1<<me-be,ve=1<<_e,ge=ve;do ve-=we,le[Pe+(ke>>be)+ve]=0|(ze<<24|Te<<16|Le);while(0!==ve);for(we=1<<me-1;ke&we;)we>>=1;if(0===we?ke=0:(ke&=we-1,ke+=we),ce++,0==--Ce[me]){if(me==pe)break;me=ie[ne+de[ce]]}if(me>fe&&(ke&je)!==Me){for(0==be&&(be=fe),Pe+=ge,_e=me-be,ye=1<<_e;_e+be<pe&&(ye-=Ce[_e+be],!(0>=ye));)_e++,ye<<=1;if(xe+=1<<_e,ae===Z&&xe>L||ae===W&&xe>E)return 1;Me=ke&je,le[Me]=0|(fe<<24|_e<<16|Pe-se)}}return 0!=ke&&(le[Pe+ke]=0|(4194304|me-be<<24)),ue.bits=fe,0}},{"../utils/common":122}],132:[function(D,I){"use strict";I.exports={"0":"","1":"stream end","2":"need dictionary","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],133:[function(D,I,R){"use strict";function T(He){for(var Ze=He.length;0<=--Ze;)He[Ze]=0}function L(He,Ze,We,Ke,Qe){this.static_tree=He,this.extra_bits=Ze,this.extra_base=We,this.elems=Ke,this.max_length=Qe,this.has_stree=He&&He.length}function E(He,Ze){this.dyn_tree=He,this.max_code=0,this.stat_desc=Ze}function G(He){return 256>He?Ve[He]:Ve[256+(He>>>7)]}function Z(He,Ze){He.pending_buf[He.pending++]=255&Ze,He.pending_buf[He.pending++]=255&Ze>>>8}function W(He,Ze,We){He.bi_valid>Se-We?(He.bi_buf|=65535&Ze<<He.bi_valid,Z(He,He.bi_buf),He.bi_buf=Ze>>Se-He.bi_valid,He.bi_valid+=We-Se):(He.bi_buf|=65535&Ze<<He.bi_valid,He.bi_valid+=We)}function Q(He,Ze,We){W(He,We[2*Ze],We[2*Ze+1])}function $(He,Ze){var We=0;do We|=1&He,He>>>=1,We<<=1;while(0<--Ze);return We>>>1}function J(He){16===He.bi_valid?(Z(He,He.bi_buf),He.bi_buf=0,He.bi_valid=0):8<=He.bi_valid&&(He.pending_buf[He.pending++]=255&He.bi_buf,He.bi_buf>>=8,He.bi_valid-=8)}function ee(He,Ze){var We=Ze.dyn_tree,Ke=Ze.max_code,Qe=Ze.stat_desc.static_tree,$e=Ze.stat_desc.has_stree,Je=Ze.stat_desc.extra_bits,et=Ze.stat_desc.extra_base,at=Ze.stat_desc.max_length,nt,ot,lt,rt,st,dt,ut=0;for(rt=0;rt<=De;rt++)He.bl_count[rt]=0;for(We[2*He.heap[He.heap_max]+1]=0,nt=He.heap_max+1;nt<Pe;nt++)(ot=He.heap[nt],rt=We[2*We[2*ot+1]+1]+1,rt>at&&(rt=at,ut++),We[2*ot+1]=rt,!(ot>Ke))&&(He.bl_count[rt]++,st=0,ot>=et&&(st=Je[ot-et]),dt=We[2*ot],He.opt_len+=dt*(rt+st),$e&&(He.static_len+=dt*(Qe[2*ot+1]+st)));if(0!=ut){do{for(rt=at-1;0===He.bl_count[rt];)rt--;He.bl_count[rt]--,He.bl_count[rt+1]+=2,He.bl_count[at]--,ut-=2}while(0<ut);for(rt=at;0!==rt;rt--)for(ot=He.bl_count[rt];0!==ot;)(lt=He.heap[--nt],!(lt>Ke))&&(We[2*lt+1]!==rt&&(He.opt_len+=(rt-We[2*lt+1])*We[2*lt],We[2*lt+1]=rt),ot--)}}function te(He,Ze,We){var Ke=Array(De+1),Qe=0,$e,Je;for($e=1;$e<=De;$e++)Ke[$e]=Qe=Qe+We[$e-1]<<1;for(Je=0;Je<=Ze;Je++){var et=He[2*Je+1];0!==et&&(He[2*Je]=$(Ke[et]++,et))}}function ae(){var He,Ze,We,Ke,Qe,$e=Array(De+1);for(We=0,Ke=0;Ke<ke-1;Ke++)for(qe[Ke]=We,He=0;He<1<<Be[Ke];He++)Ne[We++]=Ke;for(Ne[We-1]=Ke,Qe=0,Ke=0;16>Ke;Ke++)for(Oe[Ke]=Qe,He=0;He<1<<ze[Ke];He++)Ve[Qe++]=Ke;for(Qe>>=7;Ke<Me;Ke++)for(Oe[Ke]=Qe<<7,He=0;He<1<<ze[Ke]-7;He++)Ve[256+Qe++]=Ke;for(Ze=0;Ze<=De;Ze++)$e[Ze]=0;for(He=0;143>=He;)Ee[2*He+1]=8,He++,$e[8]++;for(;255>=He;)Ee[2*He+1]=9,He++,$e[9]++;for(;279>=He;)Ee[2*He+1]=7,He++,$e[7]++;for(;287>=He;)Ee[2*He+1]=8,He++,$e[8]++;for(te(Ee,ve+1,$e),He=0;He<Me;He++)Fe[2*He+1]=5,Fe[2*He]=$(He,5);Ye=new L(Ee,Be,we+1,ve,De),Ue=new L(Fe,ze,0,Me,De),Xe=new L([],Te,0,je,7)}function ie(He){var Ze;for(Ze=0;Ze<ve;Ze++)He.dyn_ltree[2*Ze]=0;for(Ze=0;Ze<Me;Ze++)He.dyn_dtree[2*Ze]=0;for(Ze=0;Ze<je;Ze++)He.bl_tree[2*Ze]=0;He.dyn_ltree[2*Ie]=1,He.opt_len=He.static_len=0,He.last_lit=He.matches=0}function ne(He){8<He.bi_valid?Z(He,He.bi_buf):0<He.bi_valid&&(He.pending_buf[He.pending++]=He.bi_buf),He.bi_buf=0,He.bi_valid=0}function oe(He,Ze,We,Ke){ne(He),Ke&&(Z(He,We),Z(He,~We)),_e.arraySet(He.pending_buf,He.window,Ze,We,He.pending),He.pending+=We}function le(He,Ze,We,Ke){var Qe=2*Ze,$e=2*We;return He[Qe]<He[$e]||He[Qe]===He[$e]&&Ke[Ze]<=Ke[We]}function se(He,Ze,We){for(var Ke=He.heap[We],Qe=We<<1;Qe<=He.heap_len&&(Qe<He.heap_len&&le(Ze,He.heap[Qe+1],He.heap[Qe],He.depth)&&Qe++,!le(Ze,Ke,He.heap[Qe],He.depth));)He.heap[We]=He.heap[Qe],We=Qe,Qe<<=1;He.heap[We]=Ke}function de(He,Ze,We){var Ke,Qe,$e=0,Je,et;if(0!==He.last_lit)do Ke=He.pending_buf[He.d_buf+2*$e]<<8|He.pending_buf[He.d_buf+2*$e+1],Qe=He.pending_buf[He.l_buf+$e],$e++,0===Ke?Q(He,Qe,Ze):(Je=Ne[Qe],Q(He,Je+we+1,Ze),et=Be[Je],0!==et&&(Qe-=qe[Je],W(He,Qe,et)),Ke--,Je=G(Ke),Q(He,Je,We),et=ze[Je],0!==et&&(Ke-=Oe[Je],W(He,Ke,et)));while($e<He.last_lit);Q(He,Ie,Ze)}function ue(He,Ze){var We=Ze.dyn_tree,Ke=Ze.stat_desc.static_tree,Qe=Ze.stat_desc.has_stree,$e=Ze.stat_desc.elems,Je,et,at=-1,nt;for(He.heap_len=0,He.heap_max=Pe,Je=0;Je<$e;Je++)0===We[2*Je]?We[2*Je+1]=0:(He.heap[++He.heap_len]=at=Je,He.depth[Je]=0);for(;2>He.heap_len;)nt=He.heap[++He.heap_len]=2>at?++at:0,We[2*nt]=1,He.depth[nt]=0,He.opt_len--,Qe&&(He.static_len-=Ke[2*nt+1]);for(Ze.max_code=at,Je=He.heap_len>>1;1<=Je;Je--)se(He,We,Je);nt=$e;do Je=He.heap[1],He.heap[1]=He.heap[He.heap_len--],se(He,We,1),et=He.heap[1],He.heap[--He.heap_max]=Je,He.heap[--He.heap_max]=et,We[2*nt]=We[2*Je]+We[2*et],He.depth[nt]=(He.depth[Je]>=He.depth[et]?He.depth[Je]:He.depth[et])+1,We[2*Je+1]=We[2*et+1]=nt,He.heap[1]=nt++,se(He,We,1);while(2<=He.heap_len);He.heap[--He.heap_max]=He.heap[1],ee(He,Ze),te(We,at,He.bl_count)}function he(He,Ze,We){var Ke,Qe=-1,$e,Je=Ze[1],et=0,at=7,nt=4;for(0===Je&&(at=138,nt=3),Ze[2*(We+1)+1]=65535,Ke=0;Ke<=We;Ke++){if($e=Je,Je=Ze[2*(Ke+1)+1],++et<at&&$e===Je)continue;else et<nt?He.bl_tree[2*$e]+=et:0===$e?10>=et?He.bl_tree[2*Ae]++:He.bl_tree[2*Re]++:($e!==Qe&&He.bl_tree[2*$e]++,He.bl_tree[2*Ce]++);et=0,Qe=$e,0===Je?(at=138,nt=3):$e===Je?(at=6,nt=3):(at=7,nt=4)}}function me(He,Ze,We){var Ke,Qe=-1,$e,Je=Ze[1],et=0,at=7,nt=4;for(0===Je&&(at=138,nt=3),Ke=0;Ke<=We;Ke++){if($e=Je,Je=Ze[2*(Ke+1)+1],++et<at&&$e===Je)continue;else if(et<nt)do Q(He,$e,He.bl_tree);while(0!=--et);else 0===$e?10>=et?(Q(He,Ae,He.bl_tree),W(He,et-3,3)):(Q(He,Re,He.bl_tree),W(He,et-11,7)):($e!==Qe&&(Q(He,$e,He.bl_tree),et--),Q(He,Ce,He.bl_tree),W(He,et-3,2));et=0,Qe=$e,0===Je?(at=138,nt=3):$e===Je?(at=6,nt=3):(at=7,nt=4)}}function ce(He){var Ze;for(he(He,He.dyn_ltree,He.l_desc.max_code),he(He,He.dyn_dtree,He.d_desc.max_code),ue(He,He.bl_desc),Ze=je-1;3<=Ze&&0===He.bl_tree[2*Le[Ze]+1];Ze--);return He.opt_len+=3*(Ze+1)+5+5+4,Ze}function ge(He,Ze,We,Ke){var Qe;for(W(He,Ze-257,5),W(He,We-1,5),W(He,Ke-4,4),Qe=0;Qe<Ke;Qe++)W(He,He.bl_tree[2*Le[Qe]+1],3);me(He,He.dyn_ltree,Ze-1),me(He,He.dyn_dtree,We-1)}function pe(He){var Ze=4093624447,We;for(We=0;31>=We;We++,Ze>>>=1)if(1&Ze&&0!==He.dyn_ltree[2*We])return be;if(0!==He.dyn_ltree[18]||0!==He.dyn_ltree[20]||0!==He.dyn_ltree[26])return ye;for(We=32;We<we;We++)if(0!==He.dyn_ltree[2*We])return ye;return be}function fe(He,Ze,We,Ke){W(He,0+(Ke?1:0),3),oe(He,Ze,We,!0)}var _e=D("../utils/common"),be=0,ye=1,xe=1,ke=29,we=256,ve=we+1+ke,Me=30,je=19,Pe=2*ve+1,De=15,Se=16,Ie=256,Ce=16,Ae=17,Re=18,Be=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ze=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Ee=Array(2*(ve+2));T(Ee);var Fe=Array(2*Me);T(Fe);var Ve=Array(512);T(Ve);var Ne=Array(256);T(Ne);var qe=Array(ke);T(qe);var Oe=Array(Me);T(Oe);var Ye,Ue,Xe,Ge=!1;R._tr_init=function(Ze){Ge||(ae(),Ge=!0),Ze.l_desc=new E(Ze.dyn_ltree,Ye),Ze.d_desc=new E(Ze.dyn_dtree,Ue),Ze.bl_desc=new E(Ze.bl_tree,Xe),Ze.bi_buf=0,Ze.bi_valid=0,ie(Ze)},R._tr_stored_block=fe,R._tr_flush_block=function(Ze,We,Ke,Qe){var $e,Je,et=0;0<Ze.level?(2===Ze.strm.data_type&&(Ze.strm.data_type=pe(Ze)),ue(Ze,Ze.l_desc),ue(Ze,Ze.d_desc),et=ce(Ze),$e=Ze.opt_len+3+7>>>3,Je=Ze.static_len+3+7>>>3,Je<=$e&&($e=Je)):$e=Je=Ke+5,Ke+4<=$e&&-1!==We?fe(Ze,We,Ke,Qe):4===Ze.strategy||Je===$e?(W(Ze,(xe<<1)+(Qe?1:0),3),de(Ze,Ee,Fe)):(W(Ze,4+(Qe?1:0),3),ge(Ze,Ze.l_desc.max_code+1,Ze.d_desc.max_code+1,et+1),de(Ze,Ze.dyn_ltree,Ze.dyn_dtree)),ie(Ze),Qe&&ne(Ze)},R._tr_tally=function(Ze,We,Ke){return Ze.pending_buf[Ze.d_buf+2*Ze.last_lit]=255&We>>>8,Ze.pending_buf[Ze.d_buf+2*Ze.last_lit+1]=255&We,Ze.pending_buf[Ze.l_buf+Ze.last_lit]=255&Ke,Ze.last_lit++,0===We?Ze.dyn_ltree[2*Ke]++:(Ze.matches++,We--,Ze.dyn_ltree[2*(Ne[Ke]+we+1)]++,Ze.dyn_dtree[2*G(We)]++),Ze.last_lit===Ze.lit_bufsize-1},R._tr_align=function(Ze){W(Ze,xe<<1,3),Q(Ze,Ie,Ee),J(Ze)}},{"../utils/common":122}],134:[function(D,I){"use strict";I.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],135:[function(D,I){"use strict";var R=D("./tiffDecoder");I.exports=function(L,E){var G=new R(L,E);return G.decode(E)}},{"./tiffDecoder":142}],136:[function(D,I){"use strict";var R={standard:D("./tags/standard"),exif:D("./tags/exif"),gps:D("./tags/gps")};class T{constructor(L){if(!L)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=L,this._map=null}get(L){if("number"==typeof L)return this.fields.get(L);if("string"==typeof L)return this.fields.get(R[this.kind].tagsByName[L]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};var L=R[this.kind].tagsById;for(var E of this.fields.keys())L[E]&&(this._map[L[E]]=this.fields.get(E))}return this._map}}I.exports=T},{"./tags/exif":139,"./tags/gps":140,"./tags/standard":141}],137:[function(D,I,R){"use strict";function T(E,G){if(1===G)return E.readUint8();var Z=new Uint8Array(G);for(var W=0;W<G;W++)Z[W]=E.readUint8();return Z}var L=new Map([[1,[1,T]],[2,[1,function(G,Z){var W=[],Q="";for(var $=0;$<Z;$++){var J=String.fromCharCode(G.readUint8());"\0"===J?(W.push(Q),Q=""):Q+=J}return 1===W.length?W[0]:W}]],[3,[2,function(G,Z){if(1===Z)return G.readUint16();var W=new Uint16Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readUint16();return W}]],[4,[4,function(G,Z){if(1===Z)return G.readUint32();var W=new Uint32Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readUint32();return W}]],[5,[8,function(G,Z){if(1===Z)return G.readUint32()/G.readUint32();var W=Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readUint32()/G.readUint32();return W}]],[6,[1,function(G,Z){if(1===Z)return G.readInt8();var W=new Int8Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readInt8();return W}]],[7,[1,T]],[8,[2,function(G,Z){if(1===Z)return G.readInt16();var W=new Int16Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readInt16();return W}]],[9,[4,function(G,Z){if(1===Z)return G.readInt32();var W=new Int32Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readInt32();return W}]],[10,[8,function(G,Z){if(1===Z)return G.readInt32()/G.readInt32();var W=Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readInt32()/G.readInt32();return W}]],[11,[4,function(G,Z){if(1===Z)return G.readFloat32();var W=new Float32Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readFloat32();return W}]],[12,[8,function(G,Z){if(1===Z)return G.readFloat64();var W=new Float64Array(Z);for(var Q=0;Q<Z;Q++)W[Q]=G.readFloat64();return W}]]]);R.getByteLength=function(E,G){return L.get(E)[0]*G},R.readData=function(E,G,Z){return L.get(G)[1](E,Z)}},{}],138:[function(D,I,R){arguments[4][37][0].apply(R,arguments)},{"./decode":135,dup:37}],139:[function(D,I){"use strict";var R={"33434":"ExposureTime","33437":"FNumber","34850":"ExposureProgram","34852":"SpectralSensitivity","34855":"ISOSpeedRatings","34856":"OECF","34864":"SensitivityType","34865":"StandardOutputSensitivity","34866":"RecommendedExposureIndex","34867":"ISOSpeed","34868":"ISOSpeedLatitudeyyy","34869":"ISOSpeedLatitudezzz","36864":"ExifVersion","36867":"DateTimeOriginal","36868":"DateTimeDigitized","37121":"ComponentsConfiguration","37122":"CompressedBitsPerPixel","37377":"ShutterSpeedValue","37378":"ApertureValue","37379":"BrightnessValue","37380":"ExposureBiasValue","37381":"MaxApertureValue","37382":"SubjectDistance","37383":"MeteringMode","37384":"LightSource","37385":"Flash","37386":"FocalLength","37396":"SubjectArea","37500":"MakerNote","37510":"UserComment","37520":"SubsecTime","37521":"SubsecTimeOriginal","37522":"SubsecTimeDigitized","40960":"FlashpixVersion","40961":"ColorSpace","40962":"PixelXDimension","40963":"PixelYDimension","40964":"RelatedSoundFile","41483":"FlashEnergy","41484":"SpatialFrequencyResponse","41486":"FocalPlaneXResolution","41487":"FocalPlaneYResolution","41488":"FocalPlaneResolutionUnit","41492":"SubjectLocation","41493":"ExposureIndex","41495":"SensingMethod","41728":"FileSource","41729":"SceneType","41730":"CFAPattern","41985":"CustomRendered","41986":"ExposureMode","41987":"WhiteBalance","41988":"DigitalZoomRatio","41989":"FocalLengthIn35mmFilm","41990":"SceneCaptureType","41991":"GainControl","41992":"Contrast","41993":"Saturation","41994":"Sharpness","41995":"DeviceSettingDescription","41996":"SubjectDistanceRange","42016":"ImageUniqueID","42032":"CameraOwnerName","42033":"BodySerialNumber","42034":"LensSpecification","42035":"LensMake","42036":"LensModel","42037":"LensSerialNumber","42240":"Gamma"},T={};for(var L in R)T[R[L]]=L;I.exports={tagsById:R,tagsByName:T}},{}],140:[function(D,I){"use strict";var R={"0":"GPSVersionID","1":"GPSLatitudeRef","2":"GPSLatitude","3":"GPSLongitudeRef","4":"GPSLongitude","5":"GPSAltitudeRef","6":"GPSAltitude","7":"GPSTimeStamp","8":"GPSSatellites","9":"GPSStatus","10":"GPSMeasureMode","11":"GPSDOP","12":"GPSSpeedRef","13":"GPSSpeed","14":"GPSTrackRef","15":"GPSTrack","16":"GPSImgDirectionRef","17":"GPSImgDirection","18":"GPSMapDatum","19":"GPSDestLatitudeRef","20":"GPSDestLatitude","21":"GPSDestLongitudeRef","22":"GPSDestLongitude","23":"GPSDestBearingRef","24":"GPSDestBearing","25":"GPSDestDistanceRef","26":"GPSDestDistance","27":"GPSProcessingMethod","28":"GPSAreaInformation","29":"GPSDateStamp","30":"GPSDifferential","31":"GPSHPositioningError"},T={};for(var L in R)T[R[L]]=L;I.exports={tagsById:R,tagsByName:T}},{}],141:[function(D,I){"use strict";var R={"254":"NewSubfileType","255":"SubfileType","256":"ImageWidth","257":"ImageLength","258":"BitsPerSample","259":"Compression","262":"PhotometricInterpretation","263":"Threshholding","264":"CellWidth","265":"CellLength","266":"FillOrder","269":"DocumentName","270":"ImageDescription","271":"Make","272":"Model","273":"StripOffsets","274":"Orientation","277":"SamplesPerPixel","278":"RowsPerStrip","279":"StripByteCounts","280":"MinSampleValue","281":"MaxSampleValue","282":"XResolution","283":"YResolution","284":"PlanarConfiguration","285":"PageName","286":"XPosition","287":"YPosition","288":"FreeOffsets","289":"FreeByteCounts","290":"GrayResponseUnit","291":"GrayResponseCurve","292":"T4Options","293":"T6Options","296":"ResolutionUnit","297":"PageNumber","301":"TransferFunction","305":"Software","306":"DateTime","315":"Artist","316":"HostComputer","317":"Predictor","318":"WhitePoint","319":"PrimaryChromaticities","320":"ColorMap","321":"HalftoneHints","322":"TileWidth","323":"TileLength","324":"TileOffsets","325":"TileByteCounts","326":"BadFaxLines","327":"CleanFaxData","328":"ConsecutiveBadFaxLines","330":"SubIFDs","332":"InkSet","333":"InkNames","334":"NumberOfInks","336":"DotRange","337":"TargetPrinter","338":"ExtraSamples","339":"SampleFormat","340":"SMinSampleValue","341":"SMaxSampleValue","342":"TransferRange","343":"ClipPath","344":"XClipPathUnits","345":"YClipPathUnits","346":"Indexed","347":"JPEGTables","351":"OPIProxy","400":"GlobalParametersIFD","401":"ProfileType","402":"FaxProfile","403":"CodingMethods","404":"VersionYear","405":"ModeNumber","433":"Decode","434":"DefaultImageColor","512":"JPEGProc","513":"JPEGInterchangeFormat","514":"JPEGInterchangeFormatLength","515":"JPEGRestartInterval","517":"JPEGLosslessPredictors","518":"JPEGPointTransforms","519":"JPEGQTables","520":"JPEGDCTables","521":"JPEGACTables","529":"YCbCrCoefficients","530":"YCbCrSubSampling","531":"YCbCrPositioning","532":"ReferenceBlackWhite","559":"StripRowCounts","700":"XMP","32781":"ImageID","32932":"WangAnnotatio","33432":"Copyright","33445":"MDFileTag","33446":"MDScalePixel","33447":"MDColorTable","33448":"MDLabName","33449":"MDSampleInfo","33450":"MDPrepDate","33451":"MDPrepTime","33452":"MDFileUnits","33550":"ModelPixelScaleTag","33723":"IPTC","33918":"INGRPacketDataTag","33919":"INGRFlagRegisters","33920":"IrasBTransformationMatrix","33922":"ModelTiepointTag","34264":"ModelTransformationTag","34377":"Photoshop","34665":"ExifIFD","34675":"ICCProfile","34732":"ImageLayer","34735":"GeoKeyDirectoryTag","34736":"GeoDoubleParamsTag","34737":"GeoAsciiParamsTag","34853":"GPSIFD","34908":"HylaFAXFaxRecvParams","34909":"HylaFAXFaxSubAddress","34910":"HylaFAXFaxRecvTime","37724":"ImageSourceData","40965":"InteroperabilityIFD","42112":"GDAL_METADATA","42113":"GDAL_NODATA","50215":"OceScanjobDescription","50216":"OceApplicationSelector","50217":"OceIdentificationNumber","50218":"OceImageLogicCharacteristics","50706":"DNGVersion","50707":"DNGBackwardVersion","50708":"UniqueCameraModel","50709":"LocalizedCameraModel","50710":"CFAPlaneColor","50711":"CFALayout","50712":"LinearizationTable","50713":"BlackLevelRepeatDim","50714":"BlackLevel","50715":"BlackLevelDeltaH","50716":"BlackLevelDeltaV","50717":"WhiteLevel","50718":"DefaultScale","50719":"DefaultCropOrigin","50720":"DefaultCropSize","50721":"ColorMatrix1","50722":"ColorMatrix2","50723":"CameraCalibration1","50724":"CameraCalibration2","50725":"ReductionMatrix1","50726":"ReductionMatrix2","50727":"AnalogBalance","50728":"AsShotNeutral","50729":"AsShotWhiteXY","50730":"BaselineExposure","50731":"BaselineNoise","50732":"BaselineSharpness","50733":"BayerGreenSplit","50734":"LinearResponseLimit","50735":"CameraSerialNumber","50736":"LensInfo","50737":"ChromaBlurRadius","50738":"AntiAliasStrength","50740":"DNGPrivateData","50741":"MakerNoteSafety","50778":"CalibrationIlluminant1","50779":"CalibrationIlluminant2","50780":"BestQualityScale","50784":"AliasLayerMetadata"},T={};for(var L in R)T[R[L]]=L;I.exports={tagsById:R,tagsByName:T}},{}],142:[function(D,I){"use strict";function R(te,ae,ie,ne){if(8===ie)return new Uint8Array(te*ae);return 16===ie?new Uint16Array(te*ae):32===ie&&3===ne?new Float32Array(te*ae):G("bit depth / sample format",ie+" / "+ne)}function T(te,ae,ie,ne){for(var oe=0;oe<ne;oe++)te[ie++]=ae.getUint8(oe);return ie}function L(te,ae,ie,ne,oe){for(var le=0;le<2*ne;le+=2)te[ie++]=ae.getUint16(le,oe);return ie}function E(te,ae,ie,ne,oe){for(var le=0;le<4*ne;le+=4)te[ie++]=ae.getFloat32(le,oe);return ie}function G(te,ae){throw new Error("Unsupported "+te+": "+ae)}function Z(te){if(te.length){var ae=te;te=ae[0];for(var ie=0;ie<ae.length;ie++)ae[ie]!==te&&G("bit depth",ae)}return te}var W=D("iobuffer"),Q=D("./ifd"),$=D("./tiffIfd"),J=D("./ifdValue"),ee={ignoreImageData:!1,onlyFirst:!1};I.exports=class extends W{constructor(ae,ie){super(ae,ie),this._nextIFD=0}decode(ae){ae=Object.assign({},ee,ae);var ie=[];for(this.decodeHeader();this._nextIFD;)if(ie.push(this.decodeIFD(ae)),ae.onlyFirst)return ie[0];return ie}decodeHeader(){var ae=this.readUint16();if(18761===ae)this.setLittleEndian();else if(19789===ae)this.setBigEndian();else throw new Error("invalid byte order: 0x"+ae.toString(16));if(ae=this.readUint16(),42!==ae)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(ae){this.seek(this._nextIFD);var ie;ie=ae.kind?new Q(ae.kind):new $;var ne=this.readUint16();for(var oe=0;oe<ne;oe++)this.decodeIFDEntry(ie);return ae.ignoreImageData||this.decodeImageData(ie),this._nextIFD=this.readUint32(),ie}decodeIFDEntry(ae){var ie=this.offset,ne=this.readUint16(),oe=this.readUint16(),le=this.readUint32();if(1>oe||12<oe)return void this.skip(4);var se=J.getByteLength(oe,le);4<se&&this.seek(this.readUint32());var de=J.readData(this,oe,le);if(ae.fields.set(ne,de),34665===ne||34853===ne){var ue=this.offset,he=void 0;34665===ne?he="exif":34853===ne&&(he="gps"),this._nextIFD=de,ae[he]=this.decodeIFD({kind:he,ignoreImageData:!0}),this.offset=ue}this.seek(ie),this.skip(12)}decodeImageData(ae){var ie=ae.orientation;switch(ie&&1!==ie&&G("orientation",ie),ae.type){case 1:case 2:this.readStripData(ae);break;default:G("image type",ae.type);}}readStripData(ae){var ie=ae.width,ne=ae.height,oe=Z(ae.bitsPerSample),le=ae.sampleFormat,se=ie*ne,de=R(se,1,oe,le),ue=ae.compression,he=ae.rowsPerStrip,me=he*ie,ce=ae.stripOffsets,ge=ae.stripByteCounts,pe=0;for(var fe=0;fe<ce.length;fe++){var _e=this.getStripData(ue,ce[fe],ge[fe]),be=se>me?me:se;se-=be,8===oe?pe=T(de,_e,pe,be):16===oe?pe=L(de,_e,pe,be,this.isLittleEndian()):32===oe&&3===le?pe=E(de,_e,pe,be,this.isLittleEndian()):G("bitDepth",oe)}ae.data=de}getStripData(ae,ie,ne){switch(ae){case 1:return new DataView(this.buffer,ie,ne);case 2:case 32773:return G("Compression",ae);default:throw new Error("invalid compression: "+ae);}}}},{"./ifd":136,"./ifdValue":137,"./tiffIfd":143,iobuffer:48}],143:[function(D,I){"use strict";function R(G){return"number"==typeof G?[G]:G}var T=D("./ifd"),L=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class E extends T{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var G=new Date,Z=L.exec(this.dateTime);return G.setFullYear(Z[1],Z[2]-1,Z[3]),G.setHours(Z[4],Z[5],Z[6]),G}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return R(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return R(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}I.exports=E},{"./ifd":136}],144:[function(D,I){"use strict";function R(E,G){if("string"!=typeof E&&"function"!=typeof E)throw new TypeError("func argument must be a function");if(void 0===G&&(G={}),"object"!=typeof G||null===G)throw new TypeError("options argument must be an object");this._workerCode=E.toString(),this._numWorkers=void 0===G.maxWorkers||"auto"===G.maxWorkers?Math.min(L-1,1):0<G.maxWorkers?Math.min(G.maxWorkers,L):L,this._workers=new Map,this._timeout=G.timeout||0,this._terminateOnError=!!G.terminateOnError;var Z=G.deps;"string"==typeof Z&&(Z=[Z]),Array.isArray(Z)||(Z=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(Z)}var T=D("./workerTemplate"),L=navigator.hardwareConcurrency||1;Function.prototype,R.prototype._init=function(E){var G=T.newWorkerURL(this._workerCode,E);for(var Z=0;Z<this._numWorkers;Z++){var W=new Worker(G);W.onmessage=this._onmessage.bind(this,W),W.onerror=this._onerror.bind(this,W),W.running=!1,W.id=Z,this._workers.set(W,null)}URL.revokeObjectURL(G)},R.prototype._onerror=function(E,G){if(!this._terminated){this._working--,E.running=!1;var Z=this._workers.get(E);Z&&Z[1](G.message),this._workers.set(E,null),this._terminateOnError?this.terminate():this._exec()}},R.prototype._onmessage=function(E,G){if(!this._terminated){this._working--,E.running=!1;var Z=this._workers.get(E);Z&&Z[0](G.data.data),this._workers.set(E,null),this._exec()}},R.prototype._exec=function(){for(var E of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!E.running)for(var G=0;G<this._waiting.length;G++){var Z=this._waiting[G];if("number"!=typeof Z[4]||Z[4]===E.id){this._waiting.splice(G,1),E.postMessage({action:"exec",event:Z[0],args:Z[1]},Z[2]),E.running=!0,E.time=Date.now(),this._workers.set(E,Z[3]),this._working++;break}}}},R.prototype.terminate=function(){if(!this._terminated){for(var E of this._workers)E[0].terminate(),E[1]&&E[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},R.prototype.postAll=function(E,G){if(this._terminated)throw new Error("Cannot post (terminated)");var Z=[];for(var W of this._workers.keys())Z.push(this.post(E,G,[],W.id));return Promise.all(Z)},R.prototype.post=function(E,G,Z,W){G===void 0&&(G=[]),Z===void 0&&(Z=[]),Array.isArray(G)||(G=[G]),Array.isArray(Z)||(Z=[Z]);var Q=this;return new Promise(function($,J){if(Q._terminated)throw new Error("Cannot post (terminated)");Q._waiting.push([E,G,Z,[$,J],W]),Q._exec()})},I.exports=R},{"./workerTemplate":145}],145:[function(D,I,R){"use strict";var T=function(){function E(){this._listeners={}}self.window=self,E.prototype.on=function(G,Z){if(this._listeners[G])throw new RangeError("there is already a listener for "+G);if("function"!=typeof Z)throw new TypeError("callback argument must be a function");this._listeners[G]=Z},E.prototype._send=function(G,Z,W){W===void 0?W=[]:!Array.isArray(W)&&(W=[W]),self.postMessage({id:G,data:Z},W)},E.prototype._trigger=function(G,Z){if(!this._listeners[G])throw new Error("event "+G+" is not defined");this._listeners[G].apply(null,Z)};var L=new E;self.onmessage=function(G){switch(G.data.action){case"exec":G.data.args.unshift(function(Z,W){L._send(G.data.id,Z,W)}),L._trigger(G.data.event,G.data.args);break;case"ping":L._send(G.data.id,"pong");break;default:throw new Error("unexpected action: "+G.data.action);}}}.toString().split("\"CODE\";");R.newWorkerURL=function(E,G){var Z=new Blob(["(",T[0],"importScripts.apply(self, "+JSON.stringify(G)+");\n","(",E,")();",T[1],")();"],{type:"application/javascript"});return URL.createObjectURL(Z)}},{}],146:[function(D,I,R){"use strict";function T(fe){return fe&&fe.__esModule?fe:{default:fe}}function L(fe){if(Array.isArray(fe)){for(var _e=0,be=Array(fe.length);_e<fe.length;_e++)be[_e]=fe[_e];return be}return Array.from(fe)}Object.defineProperty(R,"__esModule",{value:!0});var E=D("./kind"),G=D("./kindNames"),Z=D("./environment"),W=D("./extend"),Q=T(W),$=D("./bitMethods"),J=T($),ee=D("fs"),te=D("./model/model"),ae=D("./roi/manager"),ie=T(ae),ne=D("./mediaTypes"),oe=D("extend"),le=T(oe),se=D("./load"),de=D("../stack/Stack"),ue=T(de),he=D("blob-util"),me=D("has-own"),ce=T(me),ge={configurable:!0,enumerable:!1,get:void 0};class pe{constructor(fe,_e,be,ye){if(void 0===fe&&(fe=1),void 0===_e&&(_e=1),"object"==typeof fe){var xe=fe,ke=!0===_e;fe=xe.width,_e=xe.height,be=ke?xe.data.slice():xe.data,ye={position:xe.position,components:xe.components,alpha:xe.alpha,bitDepth:xe.bitDepth,colorModel:xe.colorModel,parent:xe,meta:xe.meta}}if(be&&!be.length&&(ye=be,be=null),void 0===ye&&(ye={}),this.width=fe,this.height=_e,0>=this.width)throw new RangeError("width must be greater than 0");if(0>=this.height)throw new RangeError("height must be greater than 0");Object.defineProperty(this,"parent",{enumerable:!1,writable:!0}),this.parent=ye.parent,this.position=ye.position||[0,0];var we=void 0;if("string"!=typeof ye.kind)we=(0,E.getKind)(G.RGBA);else if(we=(0,E.getKind)(ye.kind),!we)throw new RangeError("invalid image kind: "+ye.kind);var ve=(0,le.default)({},we,ye);this.components=ve.components,this.alpha=ve.alpha+0,this.bitDepth=ve.bitDepth,this.colorModel=ve.colorModel,this.meta=ye.meta||{},this.computed=null,this.initialize(),be||(be=(0,E.createPixelArray)(this)),this.setData(be)}initialize(){this.size=this.width*this.height,this.sizes=[this.width,this.height],this.channels=this.components+this.alpha,this.maxValue=32===this.bitDepth?Number.MAX_VALUE:Math.pow(2,this.bitDepth)-1,this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=32>this.bitDepth,this.borderSizes=[0,0]}setData(fe){var _e=(0,E.getTheoreticalPixelArraySize)(this);if(_e!==fe.length)throw new RangeError(`incorrect data size. Should be ${_e} and found ${fe.length}`);this.data=fe}static load(fe,_e){return(0,se.loadImage)(fe,_e)}static fromCanvas(fe){var _e=fe.getContext("2d"),be=_e.getImageData(0,0,fe.width,fe.height);return new pe(be.width,be.height,be.data)}static extendMethod(fe,_e){var be=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},ye=be.inPlace,xe=ye!==void 0&&ye,ke=be.returnThis,we=!(ke!==void 0)||ke,ve=be.partialArgs,Me=ve===void 0?[]:ve,je=be.stack,Pe=je!==void 0&&je;if(xe){if(pe.prototype[fe]=function(){this.computed=null;for(var Ie=arguments.length,Ce=Array(Ie),Ae=0;Ae<Ie;Ae++)Ce[Ae]=arguments[Ae];var Re=_e.apply(this,[].concat(L(Me),Ce));return we?this:Re},Pe){var De="string"==typeof Pe?Pe:fe;ue.default.prototype[De]=we?function(){for(var Ie of this)Ie[fe].apply(Ie,arguments);return this}:function(){var Ie=new ue.default(this.length);for(var Ce=0;Ce<this.length;Ce++){var Ae;Ie[Ce]=(Ae=this[Ce])[fe].apply(Ae,arguments)}return Ie}}}else if(pe.prototype[fe]=function(){for(var Ie=arguments.length,Ce=Array(Ie),Ae=0;Ae<Ie;Ae++)Ce[Ae]=arguments[Ae];return _e.apply(this,[].concat(L(Me),Ce))},Pe){var Se="string"==typeof Pe?Pe:fe;ue.default.prototype[Se]=function(){var Ie=new ue.default(this.length);for(var Ce=0;Ce<this.length;Ce++){var Ae;Ie[Ce]=(Ae=this[Ce])[fe].apply(Ae,arguments)}return Ie}}return pe}static extendProperty(fe,_e){var be=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},ye=be.partialArgs,xe=void 0===ye?[]:ye;return ge.get=function(){if(null===this.computed)this.computed={};else if((0,ce.default)(fe,this.computed))return this.computed[fe];var ke=_e.apply(this,xe);return this.computed[fe]=ke,ke},Object.defineProperty(pe.prototype,fe,ge),pe}static createFrom(fe,_e){var be={width:fe.width,height:fe.height,position:fe.position,components:fe.components,alpha:fe.alpha,colorModel:fe.colorModel,bitDepth:fe.bitDepth,parent:fe};return(0,le.default)(be,_e),new pe(be.width,be.height,be)}static isTypeSupported(fe){var _e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"write";if("string"!=typeof fe)throw new TypeError("type argument must be a string");if(fe=(0,ne.getType)(fe),"write"===_e)return(0,ne.canWrite)(fe);throw new TypeError("unknown operation: "+_e)}getPixelIndex(fe){var _e=0;for(var be=0;be<fe.length;be++)_e+=this.multipliers[be]*fe[be];return _e}setValueXY(fe,_e,be,ye){return this.data[(_e*this.width+fe)*this.channels+be]=ye,this.computed=null,this}getValueXY(fe,_e,be){return this.data[(_e*this.width+fe)*this.channels+be]}setValue(fe,_e,be){return this.data[fe*this.channels+_e]=be,this.computed=null,this}getValue(fe,_e){return this.data[fe*this.channels+_e]}setPixelXY(fe,_e,be){return this.setPixel(_e*this.width+fe,be)}getPixelXY(fe,_e){return this.getPixel(_e*this.width+fe)}setPixel(fe,_e){var be=fe*this.channels;for(var ye=0;ye<_e.length;ye++)this.data[be+ye]=_e[ye];return this.computed=null,this}getPixel(fe){var _e=Array(this.channels),be=fe*this.channels;for(var ye=0;ye<this.channels;ye++)_e[ye]=this.data[be+ye];return _e}toDataURL(){var fe=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"image/png",_e=1<arguments.length&&arguments[1]!==void 0&&arguments[1];return _e?new Promise((be,ye)=>{this.getCanvas().toDataURL((0,ne.getType)(fe),function(xe,ke){xe?ye(xe):be(ke)})}):this.getCanvas().toDataURL((0,ne.getType)(fe))}toBase64(){var fe=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"image/png",_e=this.toDataURL(fe);return _e.replace(`data:${fe};base64,`,"")}toBlob(){var fe=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"image/png",_e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0.8;return(0,he.canvasToBlob)(this.getCanvas({originalData:!0}),fe,_e)}getCanvas(){var fe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},_e=fe.originalData,be=void 0!==_e&&_e,ye=void 0;be?(this.checkProcessable("getInPlaceCanvas",{channels:[4],bitDepth:[8]}),ye=new Z.ImageData(this.data,this.width,this.height)):ye=new Z.ImageData(this.getRGBAData(),this.width,this.height);var xe=new Z.Canvas(this.width,this.height),ke=xe.getContext("2d");return ke.putImageData(ye,0,0),xe}getRGBAData(){this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16]});var fe=this.size,_e=new Uint8ClampedArray(4*(this.width*this.height));if(1===this.bitDepth)for(var be=0;be<fe;be++){var ye=this.getBit(be);_e[4*be]=255*ye,_e[4*be+1]=255*ye,_e[4*be+2]=255*ye}else if(1===this.components)for(var xe=0;xe<fe;xe++)_e[4*xe]=this.data[xe*this.channels]>>>this.bitDepth-8,_e[4*xe+1]=this.data[xe*this.channels]>>>this.bitDepth-8,_e[4*xe+2]=this.data[xe*this.channels]>>>this.bitDepth-8;else if(3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[te.RGB]}),this.colorModel===te.RGB))for(var ke=0;ke<fe;ke++)_e[4*ke]=this.data[ke*this.channels]>>>this.bitDepth-8,_e[4*ke+1]=this.data[ke*this.channels+1]>>>this.bitDepth-8,_e[4*ke+2]=this.data[ke*this.channels+2]>>>this.bitDepth-8;if(this.alpha){this.checkProcessable("getRGBAData",{bitDepth:[8,16]});for(var we=0;we<fe;we++)_e[4*we+3]=this.data[we*this.channels+this.components]>>this.bitDepth-8}else for(var ve=0;ve<fe;ve++)_e[4*ve+3]=255;return _e}getRoiManager(fe){return new ie.default(this,fe)}clone(){var fe=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},_e=fe.copyData,be=!(_e!==void 0)||_e;return new pe(this,be)}save(fe){var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},be=_e.format,ye=be===void 0?"png":be;return new Promise((xe,ke)=>{var we=this.getCanvas(),ve=(0,ee.createWriteStream)(fe),Me=void 0;switch(ye.toLowerCase()){case"png":Me=we.pngStream();break;case"jpg":case"jpeg":Me=we.jpegStream();break;default:throw new RangeError("invalid output format: "+ye);}ve.on("finish",xe),ve.on("error",ke),Me.pipe(ve)})}checkProcessable(fe){var _e=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},be=_e.bitDepth,ye=_e.alpha,xe=_e.colorModel,ke=_e.components,we=_e.channels;if("string"!=typeof fe)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(be&&(Array.isArray(be)||(be=[be]),!be.includes(this.bitDepth)))throw new TypeError("The process: "+fe+" can only be applied if bit depth is in: "+be);if(ye&&(Array.isArray(ye)||(ye=[ye]),!ye.includes(this.alpha)))throw new TypeError("The process: "+fe+" can only be applied if alpha is in: "+ye);if(xe&&(Array.isArray(xe)||(xe=[xe]),!xe.includes(this.colorModel)))throw new TypeError("The process: "+fe+" can only be applied if color model is in: "+xe);if(ke&&(Array.isArray(ke)||(ke=[ke]),!ke.includes(this.components)))throw new TypeError("The process: "+fe+" can only be applied if the number of components is in: "+ke);if(we&&(Array.isArray(we)||(we=[we]),!we.includes(this.channels)))throw new TypeError("The process: "+fe+" can only be applied if the number of channels is in: "+we)}checkColumn(fe){if(0>fe||fe>=this.width)throw new RangeError(`checkColumn: column should be included between 0 and ${this.width-1}. Current value: ${fe}`)}checkRow(fe){if(0>fe||fe>=this.height)throw new RangeError(`checkRow: row should be included between 0 and ${this.height-1}. Current value: ${fe}`)}checkChannel(fe){if(0>fe||fe>=this.channels)throw new RangeError(`checkChannel: channel should be included between 0 and ${this.channels-1}. Current value: ${fe}`)}apply(fe){for(var _e=0;_e<this.height;_e++)for(var be=0;be<this.width;be++){var ye=(_e*this.width+be)*this.channels;fe.call(this,ye)}}}R.default=pe,(0,Q.default)(pe),(0,J.default)(pe)},{"../stack/Stack":249,"./bitMethods":147,"./environment":160,"./extend":161,"./kind":182,"./kindNames":183,"./load":184,"./mediaTypes":185,"./model/model":186,"./roi/manager":201,"blob-util":6,extend:35,fs:8,"has-own":44}],147:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){for(var E in T)L.prototype[E]=T[E]};var T={setBitXY:function(E,G){var Z=G*this.width+E;this.data[Z>>3]|=1<<7-(7&Z)},clearBitXY:function(E,G){var Z=G*this.width+E;this.data[Z>>3]&=~(1<<7-(7&Z))},toggleBitXY:function(E,G){var Z=G*this.width+E;this.data[Z>>3]^=1<<7-(7&Z)},getBitXY:function(E,G){var Z=G*this.width+E;return this.data[Z>>3]&1<<7-(7&Z)?1:0},setBit:function(E){this.data[E>>3]|=1<<7-(7&E)},clearBit:function(E){this.data[E>>3]&=~(1<<7-(7&E))},toggleBit:function(E){this.data[E>>3]^=1<<7-(7&E)},getBit:function(E){return this.data[E>>3]&1<<7-(7&E)?1:0}}},{}],148:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var G=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},Z=G.useAlpha,W=!(Z!==void 0)||Z,Q=G.nbSlots,$=Q===void 0?512:Q;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});var J=Math.log($)/Math.log(8);if(J!==Math.floor(J))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");var ee=this.bitDepth-J,te=this.data,ae=(0,L.default)(Math.pow(8,J),0),ie=Math.pow(2,2*J),ne=Math.pow(2,J);for(var oe=0;oe<te.length;oe+=this.channels){var le=(te[oe]>>ee)*ie+(te[oe+1]>>ee)*ne+(te[oe+2]>>ee);W&&this.alpha?ae[le]+=te[oe+this.channels-1]/this.maxValue:ae[le]++}return ae};var T=D("new-array"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"new-array":114}],149:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var L=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},E=L.alpha,G=E===void 0?1:E;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});var Z=0;if(G!==void 0){for(var W=this.components;W<this.data.length;W+=this.channels)this.data[W]===G&&Z++;return Z}return this.size}},{}],150:[function(D,I,R){"use strict";function T(Q){return Q&&Q.__esModule?Q:{default:Q}}function L(Q,$){var J=$.useAlpha,ee=$.maxSlots,te=Math.log2(ee);if(!(0,W.default)(te))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");var ae=0;this.bitDepth>te&&(ae=this.bitDepth-te);var ie=this.data,ne=(0,G.default)(Math.pow(2,Math.min(this.bitDepth,te)),0);if(J&&this.alpha){var oe=this.channels-Q-1;for(var le=Q;le<ie.length;le+=this.channels)ne[ie[le]>>ae]+=ie[le+oe]/this.maxValue}else for(var se=Q;se<ie.length;se+=this.channels)ne[ie[se]>>ae]++;return ne}Object.defineProperty(R,"__esModule",{value:!0}),R.getHistogram=function(){var $=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},J=$.maxSlots,ee=void 0===J?256:J,te=$.channel,ae=$.useAlpha,ie=void 0===ae||ae;if(this.checkProcessable("getHistogram",{bitDepth:[8,16]}),void 0===te){if(1<this.components)throw new RangeError("You need to define the channel for an image that contains more than one channel");te=0}return L.call(this,te,{useAlpha:ie,maxSlots:ee})},R.getHistograms=function(){var $=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},J=$.maxSlots,ee=J===void 0?256:J,te=$.useAlpha,ae=!(te!==void 0)||te;this.checkProcessable("getHistograms",{bitDepth:[8,16]});var ie=Array(ae?this.components:this.channels);for(var ne=0;ne<ie.length;ne++)ie[ne]=L.call(this,ne,{useAlpha:ae,maxSlots:ee});return ie};var E=D("new-array"),G=T(E),Z=D("is-integer"),W=T(Z)},{"is-integer":53,"new-array":114}],151:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var L=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},E=L.mask,G=L.region,Z=G===void 0?3:G,W=L.removeClosePoints,Q=W===void 0?0:W,$=L.invert,J=$!==void 0&&$,ee=L.maxEquals,te=ee===void 0?2:ee,ae=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),Z*=4;var ie=J?0:1,ne=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],oe=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],le=8>=Z?1:2,se=[];for(var de=le;de<ae.height-le;de++)for(var ue=le;ue<ae.width-le;ue++)if(!(E&&E.getBitXY(ue,de)!==ie)){var he=0,me=0,ce=ae.data[ue+de*ae.width];for(var ge=0;ge<Z;ge++)J?ae.data[ue+ne[ge]+(de+oe[ge])*ae.width]>ce&&he++:ae.data[ue+ne[ge]+(de+oe[ge])*ae.width]<ce&&he++,ae.data[ue+ne[ge]+(de+oe[ge])*ae.width]===ce&&me++;he+me===Z&&me<=te&&se.push([ue,de])}if(0<Q)for(var pe=0;pe<se.length;pe++)for(var fe=pe+1;fe<se.length;fe++)Math.sqrt(Math.pow(se[pe][0]-se[fe][0],2)+Math.pow(se[pe][1]-se[fe][1],2))<Q&&(se[pe][0]=se[pe][0]+se[fe][0]>>1,se[pe][1]=se[pe][1]+se[fe][1]>>1,se.splice(fe,1),fe--);return se}},{}],152:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("max",{bitDepth:[8,16]});var G=(0,L.default)(this.channels,-(1/0));for(var Z=0;Z<this.data.length;Z+=this.channels)for(var W=0;W<this.channels;W++)this.data[Z+W]>G[W]&&(G[W]=this.data[Z+W]);return G};var T=D("new-array"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"new-array":114}],153:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var E=this.getHistograms({maxSlots:this.maxValue+1}),G=Array(E.length);for(var Z=0;Z<E.length;Z++){var W=E[Z];G[Z]=(0,T.mean)(W)}return G};var T=D("../../util/histogram")},{"../../util/histogram":262}],154:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var E=this.getHistograms({maxSlots:this.maxValue+1}),G=Array(E.length);for(var Z=0;Z<E.length;Z++){var W=E[Z];G[Z]=(0,T.median)(W)}return G};var T=D("../../util/histogram")},{"../../util/histogram":262}],155:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("min",{bitDepth:[8,16]});var G=(0,L.default)(this.channels,+(1/0));for(var Z=0;Z<this.data.length;Z+=this.channels)for(var W=0;W<this.channels;W++)this.data[Z+W]<G[W]&&(G[W]=this.data[Z+W]);return G};var T=D("new-array"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"new-array":114}],156:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("points",{bitDepth:[1]});var L=Array(this.size),E=0;for(var G=0;G<this.width;G++)for(var Z=0;Z<this.height;Z++)1===this.getBitXY(G,Z)&&(L[E++]=[G,Z]);return L.length=E,L}},{}],157:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){if(this===L)return[0,0];for(var E=[0,0],G=this;G;){if(G===L)return E;G.position&&(E[0]+=G.position[0],E[1]+=G.position[1]),G=G.parent}return!1}},{}],158:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("sum",{bitDepth:[8,16]});var G=(0,L.default)(this.channels,0);for(var Z=0;Z<this.data.length;Z+=this.channels)for(var W=0;W<this.channels;W++)G[W]+=this.data[Z+W];return G};var T=D("new-array"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"new-array":114}],159:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){return this.checkProcessable("getSvd",{bitDepth:[1]}),T.DC.SVD(this.points)};var T=D("ml-matrix")},{"ml-matrix":87}],160:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var T=void 0,L=void 0,E=void 0,G=void 0,Z=void 0,W=void 0;"undefined"==typeof self?"undefined"!=typeof I&&I.exports&&function(){R.env=W="node",R.isDifferentOrigin=Z=()=>!1;var Q=D("canvas");R.DOMImage=L=Q.Image,R.Canvas=E=Q,R.ImageData=G=Q.ImageData;var $=D("fs");R.fetchBinary=T=function(ee){return new Promise(function(te,ae){$.readFile(ee,function(ie,ne){ie?ae(ie):te(ne.buffer)})})}}():function(){R.env=W="browser";var Q=self.location.origin;R.isDifferentOrigin=Z=function(J){try{var ee=new self.URL(J);return ee.origin!==Q}catch(te){return!1}},R.ImageData=G=self.ImageData,R.DOMImage=L=self.Image,R.Canvas=E=function(J,ee){var te=self.document.createElement("canvas");return te.width=J,te.height=ee,te},R.fetchBinary=T=function(J){var ee=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},te=ee.withCredentials,ae=te!==void 0&&te;return new Promise(function(ie,ne){var oe=new self.XMLHttpRequest;oe.open("GET",J,!0),oe.responseType="arraybuffer",oe.withCredentials=ae,oe.onload=function(le){200===this.status?ie(this.response):ne(le)},oe.onerror=ne,oe.send()})}}(),R.fetchBinary=T,R.DOMImage=L,R.Canvas=E,R.ImageData=G,R.isDifferentOrigin=Z,R.env=W},{canvas:void 0,fs:8}],161:[function(D,I,R){"use strict";function T(ga){return ga&&ga.__esModule?ga:{default:ga}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(fa){var _a={inPlace:!0},ba={stack:!0};fa.extendMethod("invertGetSet",E.default,_a),fa.extendMethod("invertIterator",Z.default,_a),fa.extendMethod("invertPixel",J.default,_a),fa.extendMethod("invertOneLoop",Q.default,_a),fa.extendMethod("invertApply",te.default,_a),fa.extendMethod("invert",oe.default,{inPlace:!0,stack:!0}),fa.extendMethod("invertBinaryLoop",ie.default,_a),fa.extendMethod("level",xe.default,_a),fa.extendMethod("add",we.default,_a),fa.extendMethod("subtract",Me.default,_a),fa.extendMethod("multiply",Se.default,_a),fa.extendMethod("divide",Ce.default,_a),fa.extendMethod("hypotenuse",Pe.default),fa.extendMethod("background",Re.default),fa.extendMethod("flipX",se.default),fa.extendMethod("flipY",ue.default),fa.extendMethod("blurFilter",me.default),fa.extendMethod("medianFilter",ge.default),fa.extendMethod("gaussianFilter",fe.default),fa.extendMethod("sobelFilter",be.default),fa.extendMethod("crop",ze.default,ba),fa.extendMethod("scale",Le.default,ba),fa.extendMethod("hsv",Fe.default),fa.extendMethod("hsl",Ne.default),fa.extendMethod("cmyk",Oe.default),fa.extendMethod("rgba8",Ue.default),fa.extendMethod("grey",Ge.default).extendMethod("gray",Ge.default),fa.extendMethod("mask",Ze.default),fa.extendMethod("pad",Ke.default),fa.extendMethod("resizeBinary",$e.default),fa.extendMethod("colorDepth",et.default),fa.extendMethod("setBorder",ot.default,_a),fa.extendMethod("rotate",at.rotate),fa.extendMethod("rotateLeft",at.rotateLeft),fa.extendMethod("rotateRight",at.rotateRight),fa.extendMethod("getRow",wt.default),fa.extendMethod("getColumn",Mt.default),fa.extendMethod("getMatrix",Pt.default),fa.extendMethod("setMatrix",St.default),fa.extendMethod("getPixelsArray",Ct.default),fa.extendMethod("split",rt.default),fa.extendMethod("getChannel",dt.default),fa.extendMethod("combineChannels",ht.default),fa.extendMethod("setChannel",ct.default),fa.extendMethod("getSimilarity",pt.default),fa.extendMethod("getPixelsGrid",bt.default),fa.extendMethod("getBestMatch",xt.default),fa.extendMethod("paintMasks",Rt.default,_a),fa.extendMethod("paintLabels",zt.default,_a),fa.extendMethod("paintPoints",Lt.default,_a),fa.extendMethod("extract",Ft.default),fa.extendMethod("convolution",Nt.default),fa.extendMethod("convolutionFft",Ot.default),fa.extendMethod("countAlphaPixels",ca.default),fa.extendMethod("getHistogram",Yt.getHistogram).extendProperty("histogram",Yt.getHistogram),fa.extendMethod("getHistograms",Yt.getHistograms).extendProperty("histograms",Yt.getHistograms),fa.extendMethod("getColorHistogram",Xt.default).extendProperty("colorHistogram",Xt.default),fa.extendMethod("getMin",Ht.default).extendProperty("min",Ht.default),fa.extendMethod("getMax",Wt.default).extendProperty("max",Wt.default),fa.extendMethod("getSum",Qt.default).extendProperty("sum",Qt.default),fa.extendMethod("getLocalMaxima",Jt.default),fa.extendMethod("getMedian",ia.default).extendProperty("median",ia.default),fa.extendMethod("getMean",ta.default).extendProperty("mean",ta.default),fa.extendMethod("getPoints",oa.default).extendProperty("points",oa.default),fa.extendMethod("getRelativePosition",da.default),fa.extendMethod("getSvd",ha.default).extendProperty("svd",ha.default)};var L=D("./filter/invertGetSet"),E=T(L),G=D("./filter/invertIterator"),Z=T(G),W=D("./filter/invertOneLoop"),Q=T(W),$=D("./filter/invertPixel"),J=T($),ee=D("./filter/invertApply"),te=T(ee),ae=D("./filter/invertBinaryLoop"),ie=T(ae),ne=D("./filter/invert"),oe=T(ne),le=D("./filter/flipX"),se=T(le),de=D("./filter/flipY"),ue=T(de),he=D("./filter/blurFilter"),me=T(he),ce=D("./filter/medianFilter"),ge=T(ce),pe=D("./filter/gaussianFilter"),fe=T(pe),_e=D("./filter/sobelFilter"),be=T(_e),ye=D("./filter/level"),xe=T(ye),ke=D("./filter/add"),we=T(ke),ve=D("./filter/subtract"),Me=T(ve),je=D("./filter/hypotenuse"),Pe=T(je),De=D("./filter/multiply"),Se=T(De),Ie=D("./filter/divide"),Ce=T(Ie),Ae=D("./filter/background"),Re=T(Ae),Be=D("./transform/crop"),ze=T(Be),Te=D("./transform/scale/scale"),Le=T(Te),Ee=D("./transform/hsv"),Fe=T(Ee),Ve=D("./transform/hsl"),Ne=T(Ve),qe=D("./transform/cmyk"),Oe=T(qe),Ye=D("./transform/rgba8"),Ue=T(Ye),Xe=D("./transform/grey"),Ge=T(Xe),He=D("./transform/mask/mask"),Ze=T(He),We=D("./transform/pad"),Ke=T(We),Qe=D("./transform/resizeBinary"),$e=T(Qe),Je=D("./transform/colorDepth"),et=T(Je),at=D("./transform/rotate"),nt=D("./utility/setBorder"),ot=T(nt),lt=D("./utility/split"),rt=T(lt),st=D("./utility/getChannel"),dt=T(st),ut=D("./utility/combineChannels"),ht=T(ut),mt=D("./utility/setChannel"),ct=T(mt),gt=D("./utility/getSimilarity"),pt=T(gt),_t=D("./utility/getPixelsGrid"),bt=T(_t),yt=D("./utility/getBestMatch"),xt=T(yt),kt=D("./utility/getRow"),wt=T(kt),vt=D("./utility/getColumn"),Mt=T(vt),jt=D("./utility/getMatrix"),Pt=T(jt),Dt=D("./utility/setMatrix"),St=T(Dt),It=D("./utility/getPixelsArray"),Ct=T(It),At=D("./operator/paintMasks"),Rt=T(At),Bt=D("./operator/paintLabels"),zt=T(Bt),Tt=D("./operator/paintPoints"),Lt=T(Tt),Et=D("./operator/extract"),Ft=T(Et),Vt=D("./operator/convolution"),Nt=T(Vt),qt=D("./operator/convolutionFft"),Ot=T(qt),Yt=D("./compute/histogram"),Ut=D("./compute/colorHistogram"),Xt=T(Ut),Gt=D("./compute/min"),Ht=T(Gt),Zt=D("./compute/max"),Wt=T(Zt),Kt=D("./compute/sum"),Qt=T(Kt),$t=D("./compute/localMaxima"),Jt=T($t),ea=D("./compute/mean"),ta=T(ea),aa=D("./compute/median"),ia=T(aa),na=D("./compute/points"),oa=T(na),la=D("./compute/relativePosition"),da=T(la),ua=D("./compute/svd"),ha=T(ua),ma=D("./compute/countAlphaPixels"),ca=T(ma)},{"./compute/colorHistogram":148,"./compute/countAlphaPixels":149,"./compute/histogram":150,"./compute/localMaxima":151,"./compute/max":152,"./compute/mean":153,"./compute/median":154,"./compute/min":155,"./compute/points":156,"./compute/relativePosition":157,"./compute/sum":158,"./compute/svd":159,"./filter/add":162,"./filter/background":163,"./filter/blurFilter":164,"./filter/divide":165,"./filter/flipX":166,"./filter/flipY":167,"./filter/gaussianFilter":168,"./filter/hypotenuse":169,"./filter/invert":170,"./filter/invertApply":171,"./filter/invertBinaryLoop":172,"./filter/invertGetSet":173,"./filter/invertIterator":174,"./filter/invertOneLoop":175,"./filter/invertPixel":176,"./filter/level":177,"./filter/medianFilter":178,"./filter/multiply":179,"./filter/sobelFilter":180,"./filter/subtract":181,"./operator/convolution":187,"./operator/convolutionFft":188,"./operator/extract":189,"./operator/paintLabels":190,"./operator/paintMasks":191,"./operator/paintPoints":192,"./transform/cmyk":202,"./transform/colorDepth":203,"./transform/crop":204,"./transform/grey":205,"./transform/hsl":207,"./transform/hsv":208,"./transform/mask/mask":213,"./transform/pad":226,"./transform/resizeBinary":227,"./transform/rgba8":228,"./transform/rotate":229,"./transform/scale/scale":231,"./utility/combineChannels":232,"./utility/getBestMatch":234,"./utility/getChannel":235,"./utility/getColumn":236,"./utility/getMatrix":237,"./utility/getPixelsArray":238,"./utility/getPixelsGrid":239,"./utility/getRow":240,"./utility/getSimilarity":241,"./utility/setBorder":242,"./utility/setChannel":243,"./utility/setMatrix":244,"./utility/split":245}],162:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},W=Z.channels;if(this.checkProcessable("add",{bitDepth:[8,16]}),W=(0,T.validateArrayOfChannels)(this,{channels:W}),G=(0,L.checkNumberArray)(G),!isNaN(G))for(var Q=0;Q<W.length;Q++){var $=W[Q];for(var J=0;J<this.data.length;J+=this.channels)this.data[J+$]=Math.min(this.maxValue,this.data[J+$]+G>>0)}else{if(this.data.length!==G.length)throw new Error("add: the data size is different");for(var ee=0;ee<W.length;ee++){var te=W[ee];for(var ae=0;ae<this.data.length;ae+=this.channels)this.data[ae+te]=Math.max(0,Math.min(this.maxValue,this.data[ae+te]+G[ae+te]>>0))}}return this};var T=D("../../util/channel"),L=D("../../util/value")},{"../../util/channel":258,"../../util/value":267}],163:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Z,W,Q){var $=new T.KernelRidgeRegression(Z,W,Q),J=Array(this.size);for(var ee=0;ee<this.width;ee++)for(var te=0;te<this.height;te++)J[te*this.width+ee]=[ee,te];var ae=$.predict(J),G=E.default.createFrom(this);for(var ie=0;ie<this.size;ie++)G.data[ie]=Math.min(this.maxValue,Math.max(0,ae[ie][0]));return G};var T=D("ml-regression"),L=D("../Image"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L)},{"../Image":146,"ml-regression":99}],164:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var G=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Z=G.radius,W=void 0===Z?1:Z;if(this.checkProcessable("meanFilter",{components:[1],bitDepth:[8,16]}),1>W)throw new Error("Number of neighbors should be grater than 0");var Q=2*W+1,$=Array(Q*Q);for(var J=0;J<$.length;J++)$[J]=1;return L.default.call(this,$)};var T=D("../operator/convolutionFft"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../operator/convolutionFft":188}],165:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},W=Z.channels;if(this.checkProcessable("divide",{bitDepth:[8,16]}),W=(0,T.validateArrayOfChannels)(this,{channels:W}),G=(0,L.checkNumberArray)(G),!isNaN(G))for(var Q=0;Q<W.length;Q++){var $=W[Q];for(var J=0;J<this.data.length;J+=this.channels)this.data[J+$]=Math.min(this.maxValue,this.data[J+$]/G>>0)}else{if(this.data.length!==G.length)throw new Error("divide: the: the data size is different");for(var ee=0;ee<W.length;ee++){var te=W[ee];for(var ae=0;ae<this.data.length;ae+=this.channels)this.data[ae+te]=Math.max(0,Math.min(this.maxValue,this.data[ae+te]/G[ae+te]>>0))}}return this};var T=D("../../util/channel"),L=D("../../util/value")},{"../../util/channel":258,"../../util/value":267}],166:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(var L=0;L<this.height;L++){var E=L*this.width*this.channels;for(var G=0;G<Math.floor(this.width/2);G++){var Z=G*this.channels+E,W=(this.width-G-1)*this.channels+E;for(var Q=0;Q<this.channels;Q++){var $=this.data[Z+Q];this.data[Z+Q]=this.data[W+Q],this.data[W+Q]=$}}}return this}},{}],167:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(var L=0;L<Math.floor(this.height/2);L++)for(var E=0;E<this.width;E++){var G=E*this.channels+L*this.width*this.channels,Z=E*this.channels+(this.height-1-L)*this.channels*this.width;for(var W=0;W<this.channels;W++){var Q=this.data[G+W];this.data[G+W]=this.data[Z+W],this.data[Z+W]=Q}}return this}},{}],168:[function(D,I,R){"use strict";function T(Z,W){if(1>Z)throw new RangeError("Radius should be grater than 0");var Q=2*Z+1,$=Array(Q*Q),J=2*(W*W),ee=Math.PI*J;for(var te=0;te<=Z;te++)for(var ae=te;ae<=Z;ae++){var ie=Math.exp(-(te*te+ae*ae)/J)/ee;$[(te+Z)*Q+(ae+Z)]=ie,$[(te+Z)*Q+(-ae+Z)]=ie,$[(-te+Z)*Q+(ae+Z)]=ie,$[(-te+Z)*Q+(-ae+Z)]=ie,$[(ae+Z)*Q+(te+Z)]=ie,$[(ae+Z)*Q+(-te+Z)]=ie,$[(-ae+Z)*Q+(te+Z)]=ie,$[(-ae+Z)*Q+(-te+Z)]=ie}return $}function L(Z){if(0>=Z)throw new RangeError("Sigma should be grater than 0");for(var W=2*(Z*Z),Q=Math.PI*W,$=1/Q,J=$,ee=0;0.99>J;){ee++,$=Math.exp(-(ee*ee)/W)/Q,J+=4*$;for(var te=1;te<ee;te++)$=Math.exp(-(te*te+ee*ee)/W)/Q,J+=8*$;$=4*Math.exp(-(2*ee*ee)/W)/Q,J+=$}if(1<J)throw new Error("unexpected sum over 1");return T(ee,Z)}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var W=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Q=W.radius,$=void 0===Q?1:Q,J=W.sigma,ee=W.channels,te=W.border,ae=void 0===te?"copy":te,ie=W.algorithm,ne=void 0===ie?"auto":ie;this.checkProcessable("gaussian",{bitDepth:[8,16]});var oe=void 0;return J?oe=L(J):(J=0.3*($-1)+0.8,oe=T($,J)),G.default.call(this,oe,{border:ae,channels:ee,algorithm:ne})};var E=D("../operator/convolution"),G=function(W){return W&&W.__esModule?W:{default:W}}(E)},{"../operator/convolution":187}],169:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Z){var W=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},Q=W.bitDepth,$=void 0===Q?this.bitDepth:Q,J=W.channels;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==Z.width||this.height!==Z.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==Z.alpha||this.bitDepth!==Z.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==Z.channels)throw new Error("hypotenuse: both images must have the same number of channels");var ee=E.default.createFrom(this,{bitDepth:$});J=(0,T.validateArrayOfChannels)(this,{channels:J});var te=ee.isClamped;for(var ae=0;ae<J.length;ae++){var ie=J[ae];for(var ne=ie;ne<this.data.length;ne+=this.channels){var oe=Math.sqrt(this.data[ne]*this.data[ne]+Z.data[ne]*Z.data[ne]);ee.data[ne]=te?Math.min(Math.max(Math.round(oe),0),ee.maxValue):oe}}return ee};var T=D("../../util/channel"),L=D("../Image"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L)},{"../../util/channel":258,"../Image":146}],170:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var E=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},G=E.channels;if(this.checkProcessable("invertOneLoop",{bitDepth:[1,8,16]}),1===this.bitDepth){var Z=this.data;for(var W=0;W<Z.length;W++)Z[W]=~Z[W]}else{G=(0,T.validateArrayOfChannels)(this,{channels:G});for(var Q=0;Q<G.length;Q++){var $=G[Q];for(var J=$;J<this.data.length;J+=this.channels)this.data[J]=this.maxValue-this.data[J]}}return this};var T=D("../../util/channel")},{"../../util/channel":258}],171:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){if(1===this.bitDepth){var L=this.data;for(var E=0;E<L.length;E++)L[E]=~L[E]}else this.checkProcessable("invertApply",{bitDepth:[8,16]}),this.apply(function(G){for(var Z=0;Z<this.components;Z++)this.data[G+Z]=this.maxValue-this.data[G+Z]})}},{}],172:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("invertBinaryLoop",{bitDepth:[1]});for(var L=0;L<this.size;L++)this.toggleBit(L)}},{}],173:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){if(this.checkProcessable("invert",{bitDepth:[1,8,16]}),1===this.bitDepth){var L=this.data;for(var E=0;E<L.length;E++)L[E]=~L[E]}else for(var G=0;G<this.width;G++)for(var Z=0;Z<this.height;Z++)for(var W=0;W<this.components;W++){var Q=this.getValueXY(G,Z,W);this.setValueXY(G,Z,W,this.maxValue-Q)}}},{}],174:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){if(this.checkProcessable("invert",{bitDepth:[1,8,16]}),1===this.bitDepth){var L=this.data;for(var E=0;E<L.length;E++)L[E]=~L[E]}else for(var G of this.pixels()){var Z=G.index,W=G.pixel;for(var Q=0;Q<this.components;Q++)this.setValue(Z,Q,this.maxValue-W[Q])}}},{}],175:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("invertOneLoop",{bitDepth:[8,16]});var L=this.data;for(var E=0;E<L.length;E+=this.channels)for(var G=0;G<this.components;G++)L[E+G]=this.maxValue-L[E+G]}},{}],176:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("invertPixel",{bitDepth:[8,16]});for(var L=0;L<this.width;L++)for(var E=0;E<this.height;E++){var G=this.getPixelXY(L,E);for(var Z=0;Z<this.components;Z++)G[Z]=this.maxValue-G[Z];this.setPixelXY(L,E,G)}}},{}],177:[function(D,I,R){"use strict";function T(Z,W,Q,$){var J=1e-5,ee=Array(Z.channels);for(var te of $)ee[te]=0===W[te]&&Q[te]===Z.maxValue?0:Q[te]===W[te]?0:(Z.maxValue+1-J)/(Q[te]-W[te]),W[te]+=(0.5-J/2)/ee[te];for(var ae=0;ae<$.length;ae++){var ie=$[ae];if(0!==ee[ie])for(var ne=0;ne<Z.data.length;ne+=Z.channels)Z.data[ne+ie]=Math.min(Math.max(0,0|(Z.data[ne+ie]-W[ie])*ee[ie]+0.5),Z.maxValue)}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var W=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Q=W.algorithm,$=void 0===Q?"range":Q,J=W.channels,ee=W.min,te=void 0===ee?this.min:ee,ae=W.max,ie=void 0===ae?this.max:ae;switch(this.checkProcessable("level",{bitDepth:[8,16]}),J=(0,G.validateArrayOfChannels)(this,{channels:J}),$){case"range":0>te&&(te=0),ie>this.maxValue&&(ie=this.maxValue),Array.isArray(te)||(te=(0,E.default)(J.length,te)),Array.isArray(ie)||(ie=(0,E.default)(J.length,ie)),T(this,te,ie,J);break;default:throw new Error("level: algorithm not implement: "+$);}return this};var L=D("new-array"),E=function(W){return W&&W.__esModule?W:{default:W}}(L),G=D("../../util/channel")},{"../../util/channel":258,"new-array":114}],178:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var W=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Q=W.radius,$=void 0===Q?1:Q,J=W.channels,ee=W.border,te=void 0===ee?"copy":ee;if(this.checkProcessable("median",{bitDepth:[8,16]}),1>$)throw new Error("Kernel radius should be greater than 0");J=(0,T.validateArrayOfChannels)(this,J,!0);var ae=$,ie=$,ne=G.default.createFrom(this),oe=(2*ae+1)*(2*ie+1),le=Math.floor(oe/2),se=Array(oe);for(var de=0;de<J.length;de++){var ue=J[de];for(var he=ie;he<this.height-ie;he++)for(var me=ae;me<this.width-ae;me++){var ce=0;for(var ge=-ie;ge<=ie;ge++)for(var pe=-ae;pe<=ae;pe++){var fe=((he+ge)*this.width+me+pe)*this.channels+ue;se[ce++]=this.data[fe]}var _e=(he*this.width+me)*this.channels+ue,be=se.sort(L.asc)[le];ne.data[_e]=be}}if(this.alpha&&!J.includes(this.channels))for(var ye=this.components;ye<this.data.length;ye=ye+this.channels)ne.data[ye]=this.data[ye];return ne.setBorder({size:[ae,ie],algorithm:te}),ne};var T=D("../../util/channel"),L=D("num-sort"),E=D("../Image"),G=function(W){return W&&W.__esModule?W:{default:W}}(E)},{"../../util/channel":258,"../Image":146,"num-sort":115}],179:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},W=Z.channels;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),0>=G)throw new Error("multiply: the value must be greater than 0");if(W=(0,T.validateArrayOfChannels)(this,{channels:W}),G=(0,L.checkNumberArray)(G),!isNaN(G))for(var Q=0;Q<W.length;Q++){var $=W[Q];for(var J=0;J<this.data.length;J+=this.channels)this.data[J+$]=Math.min(this.maxValue,this.data[J+$]*G>>0)}else{if(this.data.length!==G.length)throw new Error("multiply: the data size is different");for(var ee=0;ee<W.length;ee++){var te=W[ee];for(var ae=0;ae<this.data.length;ae+=this.channels)this.data[ae+te]=Math.max(0,Math.min(this.maxValue,this.data[ae+te]*G[ae+te]>>0))}}return this};var T=D("../../util/channel"),L=D("../../util/value")},{"../../util/channel":258,"../../util/value":267}],180:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var Z=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},W=Z.kernelX,Q=W===void 0?E.GRADIENT_X:W,$=Z.kernelY,J=$===void 0?E.GRADIENT_Y:$,ee=Z.border,te=ee===void 0?"copy":ee,ae=Z.channels;this.checkProcessable("sobel",{bitDepth:[8,16]});var ie=L.default.call(this,Q,{channels:ae,border:te,bitDepth:32}),ne=L.default.call(this,J,{channels:ae,border:te,bitDepth:32});return ie.hypotenuse(ne,{bitDepth:this.bitDepth,channels:ae})};var T=D("../operator/convolution"),L=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(T),E=D("../../util/kernels")},{"../../util/kernels":264,"../operator/convolution":187}],181:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},W=Z.channels;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),W=(0,T.validateArrayOfChannels)(this,{channels:W}),G=(0,L.checkNumberArray)(G),!isNaN(G))for(var Q=0;Q<W.length;Q++){var $=W[Q];for(var J=0;J<this.data.length;J+=this.channels)this.data[J+$]=Math.max(0,this.data[J+$]-G>>0)}else{if(this.data.length!==G.length)throw new Error("substract: the data size is different");for(var ee=0;ee<W.length;ee++){var te=W[ee];for(var ae=0;ae<this.data.length;ae+=this.channels)this.data[ae+te]=Math.max(0,Math.min(this.maxValue,this.data[ae+te]-G[ae+te]>>0))}}return this};var T=D("../../util/channel"),L=D("../../util/value")},{"../../util/channel":258,"../../util/value":267}],182:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.getKind=function(W){return G[W]},R.getTheoreticalPixelArraySize=function(W){var Q=W.channels*W.size;return 1===W.bitDepth&&(Q=Math.ceil(Q/8)),Q},R.createPixelArray=function(W){var Q=W.channels*W.size,$=void 0;switch(W.bitDepth){case 1:$=new Uint8Array(Math.ceil(Q/8));break;case 8:$=new Uint8ClampedArray(Q);break;case 16:$=new Uint16Array(Q);break;case 32:$=new Float32Array(Q);break;default:throw new Error("Cannot create pixel array for bit depth "+W.bitDepth);}if(W.alpha)for(var J=W.components;J<$.length;J+=W.channels)$[J]=W.maxValue;return $};var T=D("./kindNames"),L=function(W){if(W&&W.__esModule)return W;var Q={};if(null!=W)for(var $ in W)Object.prototype.hasOwnProperty.call(W,$)&&(Q[$]=W[$]);return Q.default=W,Q}(T),E=D("./model/model"),G={};G[L.BINARY]={components:1,alpha:0,bitDepth:1,colorModel:E.GREY},G[L.GREYA]={components:1,alpha:1,bitDepth:8,colorModel:E.GREY},G[L.GREY]={components:1,alpha:0,bitDepth:8,colorModel:E.GREY},G[L.RGBA]={components:3,alpha:1,bitDepth:8,colorModel:E.RGB},G[L.RGB]={components:3,alpha:0,bitDepth:8,colorModel:E.RGB},G[L.CMYK]={components:4,alpha:0,bitDepth:8,colorModel:E.CMYK},G[L.CMYKA]={components:4,alpha:1,bitDepth:8,colorModel:E.CMYK}},{"./kindNames":183,"./model/model":186}],183:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.BINARY="BINARY",R.GREY="GREY",R.GREYA="GREYA",R.RGB="RGB",R.RGBA="RGBA",R.CMYK="CMYK",R.CMYKA="CMYKA"},{}],184:[function(D,I,R){"use strict";function T(pe){return pe&&pe.__esModule?pe:{default:pe}}function L(pe){var fe=new Uint8Array(pe.length);for(var _e=0;_e<pe.length;_e++)fe[_e]=pe.charCodeAt(_e);return fe}function E(pe){return(255&pe)<<8|255&pe>>8}function G(pe,fe,_e){function be(we,ve){if(!we)throw new Error(`This kind of image (${ye}) can only be loaded from URL.`);return ee(we,ve)}var ye=(0,ce.default)(pe);if(ye)switch(ye.ext){case"png":return W(pe);case"jpg":{var xe=(0,se.decode)(pe),ke=void 0;return xe.exif&&(ke=$(xe.exif)),be(_e,{meta:ke})}case"tif":return Q(pe);}return be(_e)}function Z(pe,fe){var _e=pe.slice(0,64).match(ge),be=void 0;return be=_e?Promise.resolve(L((0,he.default)(pe.slice(_e[0].length)))):(0,oe.fetchBinary)(pe,fe),be.then(ye=>{var xe=new Uint8Array(ye);return G(xe,fe,pe)})}function W(pe){var fe=new le.PNGDecoder(pe),_e=fe.decode(),be=_e.bitDepth,ye=_e.data.buffer,xe=void 0;if(8===be)xe=new Uint8ClampedArray(ye);else if(16===be){xe=new Uint16Array(ye);for(var ke=0;ke<xe.length;ke++)xe[ke]=E(xe[ke])}var we=_e.colourType,ve=void 0,Me=0;switch(we){case 0:ve=1;break;case 2:ve=3;break;case 4:ve=1,Me=1;break;case 6:ve=3,Me=1;break;default:throw new Error(`Unexpected colourType: ${we}`);}return new ae.default(_e.width,_e.height,xe,{components:ve,alpha:Me,bitDepth:be})}function Q(pe){var fe=(0,de.decode)(pe);return 1===fe.length?J(fe[0]):new ne.default(fe.map(J))}function $(pe){var fe={tiff:pe};return pe.exif&&(fe.exif=pe.exif),pe.gps&&(fe.gps=pe.gps),fe}function J(pe){return new ae.default(pe.width,pe.height,pe.data,{components:1,alpha:0,colorModel:null,bitDepth:pe.bitsPerSample.length?pe.bitsPerSample[0]:pe.bitsPerSample,meta:$(pe)})}function ee(pe,fe){return fe=fe||{},new Promise(function(_e,be){var ye=new oe.DOMImage;(0,oe.isDifferentOrigin)(pe)&&(ye.crossOrigin="Anonymous"),ye.onload=function(){var xe=ye.width,ke=ye.height,we=new oe.Canvas(xe,ke),ve=we.getContext("2d");ve.drawImage(ye,0,0,xe,ke);var Me=ve.getImageData(0,0,xe,ke).data;_e(new ae.default(xe,ke,Me,fe))},ye.onerror=function(){be(new Error("Could not load "+pe))},ye.src=pe})}Object.defineProperty(R,"__esModule",{value:!0}),R.loadImage=function(fe,_e){if("string"==typeof fe)return Z(fe,_e);if(fe instanceof ArrayBuffer)return Promise.resolve(G(new Uint8Array(fe),_e));if(fe.buffer)return Promise.resolve(G(fe,_e));throw new Error("argument to \"load\" must be a string or buffer.")};var te=D("./Image"),ae=T(te),ie=D("../stack/Stack"),ne=T(ie),oe=D("./environment"),le=D("fast-png"),se=D("fast-jpeg"),de=D("tiff"),ue=D("atob-lite"),he=T(ue),me=D("image-type"),ce=T(me),ge=/^data:[a-z]+\/([a-z]+);base64,/},{"../stack/Stack":249,"./Image":146,"./environment":160,"atob-lite":5,"fast-jpeg":37,"fast-png":39,"image-type":46,tiff:138}],185:[function(D,I,R){"use strict";function T($){W||(W=new E.default(1,1));var J=Z.get($);return J||(J=new Q($),Z.set($,J)),J}Object.defineProperty(R,"__esModule",{value:!0}),R.canWrite=function(J){return"node"===G.env&&"image/png"!==J?!1:T(J).canWrite()},R.getType=function(J){return J.includes("/")||(J="image/"+J),J};var L=D("./Image"),E=function(J){return J&&J.__esModule?J:{default:J}}(L),G=D("./environment"),Z=new Map,W=void 0;class Q{constructor($){this.type=$,this._canWrite=null}canWrite(){return null===this._canWrite&&(this._canWrite=W.toDataURL(this.type).startsWith("data:"+this.type)),this._canWrite}}},{"./Image":146,"./environment":160}],186:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.RGB="RGB",R.HSL="HSL",R.HSV="HSV",R.CMYK="CMYK",R.GREY="GREY"},{}],187:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Q){var $=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},J=$.channels,ee=$.bitDepth,te=$.normalize,ae=void 0!==te&&te,ie=$.divisor,ne=void 0===ie?1:ie,oe=$.border,le=void 0===oe?"copy":oe,se=$.algorithm,de=void 0===se?"auto":se,ue=L.default.createFrom(this,{bitDepth:ee});J=(0,E.validateArrayOfChannels)(this,J,!0);var he=(0,G.validateKernel)(Q);Q=he.kernel,"auto"===de&&(9<Q.length||9<Q[0].length?de="fft":de="direct"),(4096<this.width||4096<this.height)&&(de="direct");var me=Math.floor(Q.length/2),ce=Math.floor(Q[0].length/2),ge=ue.isClamped,pe=Array(this.height*this.width),fe=void 0,_e=void 0,be=void 0,ye=void 0,xe=void 0,ke=void 0;for(ye=0;ye<J.length;ye++){for(xe=J[ye],be=0;be<this.height;be++)for(_e=0;_e<this.width;_e++)fe=be*this.width+_e,pe[fe]=this.data[fe*this.channels+xe];for(ke="direct"===de?Z.direct(pe,Q,{rows:this.height,cols:this.width,normalize:ae,divisor:ne}):Z.fft(pe,Q,{rows:this.height,cols:this.width,normalize:ae,divisor:ne}),be=0;be<this.height;be++)for(_e=0;_e<this.width;_e++)fe=be*this.width+_e,ue.data[fe*this.channels+xe]=ge?Math.min(Math.max(ke[fe],0),ue.maxValue):ke[fe]}if(this.alpha&&!J.includes(this.channels))for(_e=this.components;_e<this.data.length;_e=_e+this.channels)ue.data[_e]=this.data[_e];return"periodic"!==le&&ue.setBorder({size:[ce,me],algorithm:le}),ue};var T=D("../Image"),L=function(Q){return Q&&Q.__esModule?Q:{default:Q}}(T),E=D("../../util/channel"),G=D("../../util/kernel"),Z=D("ml-matrix-convolution")},{"../../util/channel":258,"../../util/kernel":263,"../Image":146,"ml-matrix-convolution":78}],188:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){var E=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return E=Object.assign({},E),E.algorithm="fft",this.convolution(L,E)}},{}],189:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},W=Z.position;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!W&&(W=G.getRelativePosition(this),!W))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(1<this.bitDepth){var Q=L.default.createFrom(this,{width:G.width,height:G.height,alpha:1,position:W,parent:this});for(var $=0;$<G.width;$++)for(var J=0;J<G.height;J++){for(var ee=0;ee<this.channels;ee++){var te=this.getValueXY($+W[0],J+W[1],ee);Q.setValueXY($,J,ee,te)}G.getBitXY($,J)||Q.setValueXY($,J,this.components,0)}return Q}var ae=L.default.createFrom(this,{width:G.width,height:G.height,position:W,parent:this});for(var ie=0;ie<G.height;ie++)for(var ne=0;ne<G.width;ne++)G.getBitXY(ne,ie)&&this.getBitXY(ne+W[0],ie+W[1])&&ae.setBitXY(ne,ie);return ae};var T=D("../Image"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../Image":146}],190:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G,Z){var W=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},Q=W.color,$=void 0===Q?"blue":Q,J=W.colors,ee=W.font,te=void 0===ee?"12px Helvetica":ee,ae=W.rotate,ie=void 0===ae?0:ae;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:T.RGB}),!Array.isArray(G))throw Error("paintLabels: labels must be an array");if(!Array.isArray(Z))throw Error("paintLabels: positions must be an array");if($&&!Array.isArray($)&&($=(0,L.css2array)($)),J=J?J.map(function(ue){return Array.isArray(ue)?ue:(0,L.css2array)(ue)}):[$],G.length!==Z.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(te)||(te=[te]),Array.isArray(ie)||(ie=[ie]);var ne=this.getCanvas({originalData:!0}),oe=ne.getContext("2d");for(var le=0;le<G.length;le++){oe.save();var se=J[le%J.length];oe.fillStyle=`rgba(${se[0]},${se[1]},${se[2]},${se[3]/this.maxValue})`,oe.font=te[le%te.length];var de=Z[le];oe.translate(de[0],de[1]),oe.rotate(ie[le%ie.length]/180*Math.PI),oe.fillText(G[le],0,0),oe.restore()}return this.setData(oe.getImageData(0,0,this.width,this.height).data),this};var T=D("../model/model"),L=D("../../util/color")},{"../../util/color":259,"../model/model":186}],191:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){var Z=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},W=Z.color,Q=W===void 0?"red":W,$=Z.colors,J=Z.alpha,ee=J===void 0?255:J,te=Z.randomColors,ae=te!==void 0&&te,ie=Z.distinctColors,ne=ie!==void 0&&ie,oe=Z.labels,le=oe===void 0?[]:oe,se=Z.labelsPosition,de=se===void 0?[]:se,ue=Z.labelColor,he=ue===void 0?"blue":ue,me=Z.labelFont,ce=me===void 0?"12px Helvetica":me;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:T.RGB}),Q&&!Array.isArray(Q)&&(Q=(0,L.css2array)(Q)),$&&($=$.map(function(Me){return Array.isArray(Me)?Me:(0,L.css2array)(Me)})),Array.isArray(G)||(G=[G]),ne&&($=(0,L.getDistinctColors)(G.length));for(var ge=0;ge<G.length;ge++){var pe=G[ge];$?Q=$[ge%$.length]:ae&&(Q=(0,L.getRandomColor)());for(var fe=0;fe<pe.width;fe++)for(var _e=0;_e<pe.height;_e++)if(pe.getBitXY(fe,_e))for(var be=0;be<Math.min(this.components,Q.length);be++)if(255===ee)this.setValueXY(fe+pe.position[0],_e+pe.position[1],be,Q[be]);else{var ye=this.getValueXY(fe+pe.position[0],_e+pe.position[1],be);ye=Math.round((ye*(255-ee)+Q[be]*ee)/255),this.setValueXY(fe+pe.position[0],_e+pe.position[1],be,ye)}}if(Array.isArray(le)&&0<le.length){var xe=this.getCanvas({originalData:!0}),ke=xe.getContext("2d");ke.fillStyle=he,ke.font=ce;for(var we=0;we<Math.min(G.length,le.length);we++){var ve=de[we]?de[we]:G[we].position;ke.fillText(le[we],ve[0],ve[1])}this.setData(ke.getImageData(0,0,this.width,this.height).data)}return this};var T=D("../model/model"),L=D("../../util/color")},{"../../util/color":259,"../model/model":186}],192:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Z){var W=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},Q=W.color,$=Q===void 0?[this.maxValue,0,0]:Q,J=W.shape;this.checkProcessable("paintPoints",{components:3,bitDepth:[8,16],colorModel:T.RGB});var ee=new E.default(J).getPoints(),te=Math.min(this.channels,$.length);for(var ae=0;ae<Z.length;ae++){var ie=Z[ae][0],ne=Z[ae][1];for(var oe=0;oe<ee.length;oe++){var le=ee[oe][0],se=ee[oe][1];if(0<=ie+le&&0<=ne+se&&ie+le<this.width&&ne+se<this.height){var de=(ie+le+(ne+se)*this.width)*this.channels;for(var ue=0;ue<te;ue++)this.data[de+ue]=$[ue]}}}return this};var T=D("../model/model"),L=D("../../util/shape"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L)},{"../../util/shape":266,"../model/model":186}],193:[function(D,I,R){"use strict";function T(oe){return oe&&oe.__esModule?oe:{default:oe}}function L(oe){var le=oe.map,se=le.data,de=new Set,ue=new Map,he=new Set,me=[1,0,-1,0],ce=[0,1,0,-1];for(var ge=oe.minX;ge<=oe.maxX;ge++)for(var pe=oe.minY;pe<=oe.maxY;pe++){var fe=ge+pe*le.width;if(se[fe]===oe.id)for(var _e=0;4>_e;_e++){var be=ge+me[_e],ye=pe+ce[_e];if(0<=be&&0<=ye&&be<le.width&&ye<le.height){var xe=be+ye*le.width;if(se[xe]!==oe.id&&!he.has(xe)){he.add(xe),de.add(se[xe]);var ke=ue.get(se[xe]);ke?ue.set(se[xe],++ke):ue.set(se[xe],1)}}}}var we=Array.from(de),ve=we.map(function(Me){return ue.get(Me)});return{ids:we,lengths:ve}}function E(oe){var le=new Set,se=oe.map,de=se.data;for(var ue of[0,oe.height-1])for(var he=0;he<oe.width;he++){var me=(ue+oe.minY)*se.width+he+oe.minX;if(0<he-oe.minX&&de[me]===oe.id&&de[me-1]!==oe.id){var ce=de[me-1];le.add(ce)}if(1<se.width-he-oe.minX&&de[me]===oe.id&&de[me+1]!==oe.id){var ge=de[me+1];le.add(ge)}}for(var pe of[0,oe.width-1])for(var fe=0;fe<oe.height;fe++){var _e=(fe+oe.minY)*se.width+pe+oe.minX;if(0<fe-oe.minY&&de[_e]===oe.id&&de[_e-se.width]!==oe.id){var be=de[_e-se.width];le.add(be)}if(1<se.height-fe-oe.minY&&de[_e]===oe.id&&de[_e+se.width]!==oe.id){var ye=de[_e+se.width];le.add(ye)}}return Array.from(le)}function G(oe){var le=0,se=oe.map,de=se.data,ue=[0];1<oe.height&&(ue[1]=oe.height-1);for(var he of ue)for(var me=1;me<oe.width-1;me++){var ce=(he+oe.minY)*se.width+me+oe.minX;de[ce]===oe.id&&le++}var ge=[0];1<oe.width&&(ge[1]=oe.width-1);for(var pe of ge)for(var fe=0;fe<oe.height;fe++){var _e=(fe+oe.minY)*se.width+pe+oe.minX;de[_e]===oe.id&&le++}return le}function Z(oe){var le=0,se=oe.map,de=se.data;for(var ue=1;ue<oe.width-1;ue++)for(var he=1;he<oe.height-1;he++){var me=(he+oe.minY)*se.width+ue+oe.minX;de[me]===oe.id&&(de[me-1]!==oe.id||de[me+1]!==oe.id||de[me-se.width]!==oe.id||de[me+se.width]!==oe.id)&&le++}return le+oe.box}function W(oe){var le=0,se=oe.map,de=se.data;for(var ue=1;ue<oe.width-1;ue++)for(var he=1;he<oe.height-1;he++){var me=(he+oe.minY)*se.width+ue+oe.minX;de[me]===oe.id&&(oe.externalIDs.includes(de[me-1])||oe.externalIDs.includes(de[me+1])||oe.externalIDs.includes(de[me-se.width])||oe.externalIDs.includes(de[me+se.width]))&&le++}return le+oe.box}function Q(oe){var le=[oe.id],se=oe.map,de=se.data;if(2<oe.height)for(var ue=0;ue<oe.width;ue++){var he=oe.minY*se.width+ue+oe.minX;if(le.includes(de[he])){var me=de[he+se.width];le.includes(me)||oe.boxIDs.includes(me)||le.push(me)}}var ce=[,,,,];for(var ge=1;ge<oe.width-1;ge++)for(var pe=1;pe<oe.height-1;pe++){var fe=(pe+oe.minY)*se.width+ge+oe.minX;if(le.includes(de[fe])){ce[0]=de[fe-1],ce[1]=de[fe+1],ce[2]=de[fe-se.width],ce[3]=de[fe+se.width];for(var _e=0;4>_e;_e++){var be=ce[_e];le.includes(be)||oe.boxIDs.includes(be)||le.push(be)}}}return le}Object.defineProperty(R,"__esModule",{value:!0});var $=D("../Image"),J=T($),ee=D("../kindNames"),te=function(le){if(le&&le.__esModule)return le;var se={};if(null!=le)for(var de in le)Object.prototype.hasOwnProperty.call(le,de)&&(se[de]=le[de]);return se.default=le,se}(ee),ae=D("../../util/shape"),ie=T(ae);class ne{constructor(oe,le){this.map=oe,this.id=le,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(){var oe=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},le=oe.scale,se=void 0===le?1:le,de=oe.kind,ue=void 0===de?"":de,he=void 0;return he="contour"===ue?this.contourMask:"box"===ue?this.boxMask:"filled"===ue?this.filledMask:"center"===ue?this.centerMask:this.mask,1>se&&(he=he.resizeBinary(se),he.parent=this.mask.parent,he.position[0]+=this.minX,he.position[1]+=this.minY),he}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center?this.computed.center:this.computed.center=[this.width/2>>0,this.height/2>>0]}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){var oe=this.borderIDs,le=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];var se=this.internalIDs;for(var de=0;de<oe.length;de++)se.includes(oe[de])||(this.computed.externalIDs.push(oe[de]),this.computed.externalLengths.push(le[de]))}get externalIDs(){return this.computed.externalIDs?this.computed.externalIDs:(this._computExternalIDs(),this.computed.externalIDs)}get externalLengths(){return this.computed.externalLengths?this.computed.externalLengths:(this._computExternalIDs(),this.computed.externalLengths)}_computeBorderIDs(){var oe=L(this);this.computed.borderIDs=oe.ids,this.computed.borderLengths=oe.lengths}get borderIDs(){return this.computed.borderIDs?this.computed.borderIDs:(this._computeBorderIDs(),this.computed.borderIDs)}get borderLengths(){return this.computed.borderLengths?this.computed.borderLengths:(this._computeBorderIDs(),this.computed.borderLengths)}get boxIDs(){return this.computed.boxIDs?this.computed.boxIDs:this.computed.boxIDs=E(this)}get internalIDs(){return this.computed.internalIDs?this.computed.internalIDs:this.computed.internalIDs=Q(this)}get box(){return this.computed.box?this.computed.box:this.computed.box=G(this)}get external(){return this.computed.external?this.computed.external:this.computed.external=W(this)}get border(){return this.computed.border?this.computed.border:this.computed.border=Z(this)}get contourMask(){if(this.computed.contourMask)return this.computed.contourMask;var oe=new J.default(this.width,this.height,{kind:te.BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(var le=0;le<this.width;le++)for(var se=0;se<this.height;se++)this.map.data[le+this.minX+(se+this.minY)*this.map.width]===this.id&&(0<le&&le<this.width-1&&0<se&&se<this.height-1?(this.map.data[le-1+this.minX+(se+this.minY)*this.map.width]!==this.id||this.map.data[le+1+this.minX+(se+this.minY)*this.map.width]!==this.id||this.map.data[le+this.minX+(se-1+this.minY)*this.map.width]!==this.id||this.map.data[le+this.minX+(se+1+this.minY)*this.map.width]!==this.id)&&oe.setBitXY(le,se):oe.setBitXY(le,se));return this.computed.contour=oe}get boxMask(){if(this.computed.boxMask)return this.computed.boxMask;var oe=new J.default(this.width,this.height,{kind:te.BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(var le=0;le<this.width;le++)oe.setBitXY(le,0),oe.setBitXY(le,this.height-1);for(var se=0;se<this.height;se++)oe.setBitXY(0,se),oe.setBitXY(this.width-1,se);return this.computed.boxMask=oe}get mask(){if(this.computed.mask)return this.computed.mask;var oe=new J.default(this.width,this.height,{kind:te.BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(var le=0;le<this.width;le++)for(var se=0;se<this.height;se++)this.map.data[le+this.minX+(se+this.minY)*this.map.width]===this.id&&oe.setBitXY(le,se);return this.computed.mask=oe}get filledMask(){if(this.computed.filledMask)return this.computed.filledMask;var oe=new J.default(this.width,this.height,{kind:te.BINARY,position:[this.minX,this.minY],parent:this.map.parent});for(var le=0;le<this.width;le++)for(var se=0;se<this.height;se++){var de=le+this.minX+(se+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[de])&&oe.setBitXY(le,se)}return this.computed.filledMask=oe}get centerMask(){if(this.computed.centerMask)return this.computed.centerMask;var oe=new ie.default({kind:"smallCross"}).getMask();return oe.parent=this.map.parent,oe.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=oe}get points(){if(this.computed.points)return this.computed.points;var oe=[];for(var le=0;le<this.height;le++)for(var se=0;se<this.width;se++){var de=(le+this.minY)*this.map.width+se+this.minX;this.map.data[de]===this.id&&oe.push([se,le])}return this.computed.points=oe}get maxLengthPoints(){if(this.computed.maxLengthPoints)return this.computed.maxLengthPoints;var oe=0,le=void 0,se=this.points;for(var de=0;de<se.length;de++)for(var ue=de+1;ue<se.length;ue++){var he=Math.pow(se[de][0]-se[ue][0],2)+Math.pow(se[de][1]-se[ue][1],2);he>=oe&&(oe=he,le=[se[de],se[ue]])}return this.computed.maxLengthPoints=le}get maxLength(){if(this.computed.maxLength)return this.computed.maxLength;var oe=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));return this.computed.maxLength=oe}get angle(){if(this.computed.angle)return this.computed.angle;var oe=this.maxLengthPoints,le=180*-Math.atan2(oe[0][1]-oe[1][1],oe[0][0]-oe[1][0])/Math.PI;return this.computed.angle=le}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface}}}R.default=ne},{"../../util/shape":266,"../Image":146,"../kindNames":183}],194:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var T=D("./Roi"),L=function(G){return G&&G.__esModule?G:{default:G}}(T);R.default=class{constructor(G,Z){this.roiMap=G,this.options=Z,this.roi=this.createRoi()}createRoi(){var G=this.roiMap.data,Z={};this.roiMap.positive=0,this.roiMap.negative=0;for(var W=0;W<G.length;W++)G[W]&&!Z[G[W]]&&(Z[G[W]]=!0,0<G[W]?this.roiMap.positive++:this.roiMap.negative++);var Q={};for(var $ in Z)Q[$]=new L.default(this.roiMap,1*$);var J=this.roiMap.width,ee=this.roiMap.height;for(var te=0;te<J;te++)for(var ae=0;ae<ee;ae++){var ie=ae*J+te;if(0!==G[ie]){var ne=G[ie],oe=Q[ne];te<oe.minX&&(oe.minX=te),te>oe.maxX&&(oe.maxX=te),ae<oe.minY&&(oe.minY=ae),ae>oe.maxY&&(oe.maxY=ae),oe.meanX+=te,oe.meanY+=ae,oe.surface++}}var le=[];for(var se in Z)Q[se].meanX/=Q[se].surface,Q[se].meanY/=Q[se].surface,le.push(Q[se]);return le}}},{"./Roi":193}],195:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0});class T{constructor(L,E){this.parent=L,this.width=L.width,this.height=L.height,this.data=E,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}}R.default=T},{}],196:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){function Z(se,de){var ue=0,he=0,me=G.getBitXY(se,de),ce=me?++ee:--te;for(ie[0]=se,ne[0]=de;ue<=he;){var ge=ie[ue&ae],pe=ne[ue&ae];if(J[pe*G.width+ge]=ce,0<ge&&0===J[pe*G.width+ge-1]&&G.getBitXY(ge-1,pe)===me&&(he++,ie[he&ae]=ge-1,ne[he&ae]=pe,J[pe*G.width+ge-1]=-32768),0<pe&&0===J[(pe-1)*G.width+ge]&&G.getBitXY(ge,pe-1)===me&&(he++,ie[he&ae]=ge,ne[he&ae]=pe-1,J[(pe-1)*G.width+ge]=-32768),ge<G.width-1&&0===J[pe*G.width+ge+1]&&G.getBitXY(ge+1,pe)===me&&(he++,ie[he&ae]=ge+1,ne[he&ae]=pe,J[pe*G.width+ge+1]=-32768),pe<G.height-1&&0===J[(pe+1)*G.width+ge]&&G.getBitXY(ge,pe+1)===me&&(he++,ie[he&ae]=ge,ne[he&ae]=pe+1,J[(pe+1)*G.width+ge]=-32768),$&&(0<ge&&0<pe&&0===J[(pe-1)*G.width+ge-1]&&G.getBitXY(ge-1,pe-1)===me&&(he++,ie[he&ae]=ge-1,ne[he&ae]=pe-1,J[(pe-1)*G.width+ge-1]=-32768),ge<G.width-1&&0<pe&&0===J[(pe-1)*G.width+ge+1]&&G.getBitXY(ge+1,pe-1)===me&&(he++,ie[he&ae]=ge+1,ne[he&ae]=pe-1,J[(pe-1)*G.width+ge+1]=-32768),0<ge&&pe<G.height-1&&0===J[(pe+1)*G.width+ge-1]&&G.getBitXY(ge-1,pe+1)===me&&(he++,ie[he&ae]=ge-1,ne[he&ae]=pe+1,J[(pe+1)*G.width+ge-1]=-32768),ge<G.width-1&&pe<G.height-1&&0===J[(pe+1)*G.width+ge+1]&&G.getBitXY(ge+1,pe+1)===me&&(he++,ie[he&ae]=ge+1,ne[he&ae]=pe+1,J[(pe+1)*G.width+ge+1]=-32768)),ue++,he-ue>ae)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}var W=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},Q=W.allowCorners,$=Q!==void 0&&Q,J=new Int16Array(G.size),ee=0,te=0,ae=65535,ie=new Uint16Array(ae+1),ne=new Uint16Array(ae+1);for(var oe=0;oe<G.width;oe++)for(var le=0;le<G.height;le++)0===J[le*G.width+oe]&&Z(oe,le);return new L.default(G,J)};var T=D("../RoiMap"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../RoiMap":195}],197:[function(D,I,R){"use strict";function T(ae){return ae&&ae.__esModule?ae:{default:ae}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(ie){var ne=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},oe=ne.allowCorners,le=oe!==void 0&&oe,se=4;le&&(se=8);var de=void 0,ue=void 0,he=void 0;if(8==se)de=J,ue=ee,he=te;else if(4==se)de=W,ue=Q,he=$;else throw new RangeError("unsupported neighbours count: "+se);var me=ie.size,ce=ie.width,ge=ie.height,pe=Array(me),fe=new Int16Array(me),_e=new E.default,be=1;for(var ye=0;ye<ge;ye++)for(var xe=0;xe<ce;xe++){var ke=xe+ye*ce;if(ie.getBit(ke)){var we=null;for(var ve=0;ve<he.length;ve++){var Me=xe+de[ve],je=ye+ue[ve];if(0<=Me&&0<=je&&Me<ce&&je<ge){var Pe=pe[Me+je*ce];Pe?(he[ve]=Pe,(!we||he[ve].value<we.value)&&(we=he[ve])):he[ve]=null}}if(!we)pe[ke]=_e.add(be++);else{pe[ke]=we;for(var De=0;De<he.length;De++)he[De]&&he[De]!==we&&_e.union(we,he[De])}}}for(var Se=0;Se<ge;Se++)for(var Ie=0;Ie<ce;Ie++){var Ce=Ie+Se*ce;ie.getBit(Ce)&&(fe[Ce]=_e.find(pe[Ce]).value)}return new Z.default(ie,fe)};var L=D("ml-disjoint-set"),E=T(L),G=D("../RoiMap"),Z=T(G),W=[-1,0],Q=[0,-1],$=[null,null],J=[-1,-1,0,1],ee=[0,-1,-1,-1],te=[null,null,null,null]},{"../RoiMap":195,"ml-disjoint-set":62}],198:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){function G(ve,Me){var je=fe;ye=0,xe=1,_e[0]=ve,be[0]=Me;for(var Pe=!0;ye<xe;){var De=_e[ye&me],Se=be[ye&me];Pe&=Z(De,Se,ne),ye++}if(!Pe){for(var Ie=0;Ie<xe;Ie++){var Ce=_e[Ie&me],Ae=be[Ie&me],Re=Ae*ie.width+Ce;de[Re]=0}fe=je}return Pe}function Z(ve,Me,je){var Pe=de[Me*ie.width+ve],De=ie.data[Me*ie.width+ve];for(var Se=Me-1;Se<=Me+1;Se++)for(var Ie=ve-1;Ie<=ve+1;Ie++){var Ce=Se*ie.width+Ie;if(0===ue[Ce])switch(ue[Ce]=1,he[Ce]=ie.data[Ce]-De,je){case ne:if(0===he[Ce]){if(0===Ie||0===Se||Ie===ie.width-1||Se===ie.height-1)return!1;de[Ce]=Pe,_e[xe&me]=Ie,be[xe&me]=Se,xe++}else{if(0<he[Ce])return!1;ee||(de[Ce]=Pe,ce[fe&me]=Ie,ge[fe&me]=Se,fe++)}break;case oe:0>=he[Ce]&&(de[Ce]=Pe,ce[fe&me]=Ie,ge[fe&me]=Se,fe++);break;default:throw new Error("unreachable");}}return!0}var W=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},Q=W.allowCorner,$=!(Q!==void 0)||Q,J=W.onlyTop,ee=J!==void 0&&J,te=W.invert,ae=te!==void 0&&te,ie=this;ie.checkProcessable("fromMaxima",{components:[1]});var ne=1,oe=2,le=0,se=0,de=new Int16Array(ie.size),ue=new Int8Array(ie.size),he=new Float32Array(ie.size),me=1048575,ce=new Uint16Array(me+1),ge=new Uint16Array(me+1),pe=0,fe=0,_e=new Uint16Array(me+1),be=new Uint16Array(me+1),ye=0,xe=0;for(function(Me){var je=Me.maxima,Pe=void 0===je||je;for(var De=1;De<ie.height-1;De++)for(var Se=1;Se<ie.width-1;Se++){var Ie=Se+De*ie.width;if(0===ue[Ie]){var Ce=Pe?ie.data[Ie]:-ie.data[Se+De*ie.width];if(ie.data[De*ie.width+Se-1]>Ce)continue;if(ie.data[De*ie.width+Se+1]>Ce)continue;if(ie.data[(De-1)*ie.width+Se]>Ce)continue;if(ie.data[(De+1)*ie.width+Se]>Ce)continue;if($){if(ie.data[(De-1)*ie.width+Se-1]>Ce)continue;if(ie.data[(De-1)*ie.width+Se+1]>Ce)continue;if(ie.data[(De+1)*ie.width+Se-1]>Ce)continue;if(ie.data[(De+1)*ie.width+Se+1]>Ce)continue}de[Ie]=Pe?++le:--se;var Ae=G(Se,De,ne);Ae||(Pe?--le:++se)}}}(ie,{maxima:!ae});pe<fe;){var ke=ce[pe&me],we=ge[pe&me];Z(ke,we,oe),pe++}return new L.default(ie,de)};var T=D("../RoiMap"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../RoiMap":195}],199:[function(D,I,R){"use strict";function T(W){return W&&W.__esModule?W:{default:W}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Q){var $=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},J=new Z.default($),ee=new Int16Array(this.size),te=0,ae=J.getPoints();for(var ie=0;ie<Q.length;ie++){te++;var ne=Q[ie][0],oe=Q[ie][1];for(var le=0;le<ae.length;le++){var se=ae[le][0],de=ae[le][1];0<=ne+se&&0<=oe+de&&ne+se<this.width&&oe+de<this.height&&(ee[ne+se+(oe+de)*this.width]=te)}}return new E.default(this,ee)};var L=D("../RoiMap"),E=T(L),G=D("./../../../util/shape"),Z=T(G)},{"../RoiMap":195,"./../../../util/shape":266}],200:[function(D,I,R){"use strict";function T(Q){return Q&&Q.__esModule?Q:{default:Q}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var $=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},J=$.points,ee=$.mask,te=$.image,ae=$.fillMaxValue,ie=ae===void 0?this.maxValue:ae,ne=$.invert,oe=ne!==void 0&&ne,le=te||this;le.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),oe=!oe,J||(J=le.getLocalMaxima({invert:oe,mask:ee}));var se=oe?0:1,de=new Int16Array(le.size),ue=le.width,he=le.height,me=new Z.default({comparator:(ve,Me)=>ve[2]-Me[2],strategy:Z.default.BinaryHeapStrategy});for(var ce=0;ce<J.length;ce++){var ge=J[ce][0]+J[ce][1]*ue;de[ge]=ce+1;var pe=le.data[ge];(oe&&pe<=ie||!oe&&pe>=ie)&&me.queue([J[ce][0],J[ce][1],pe])}for(;0<me.length;){var fe=me.dequeue(),_e=fe[0]+fe[1]*ue;for(var be=0;4>be;be++){var ye=fe[0]+W.dxs[be],xe=fe[1]+W.dys[be];if(0<=ye&&0<=xe&&ye<ue&&xe<he){var ke=ye+xe*ue;if(!ee||ee.getBit(ke)===se){var we=le.data[ke];(oe&&we<=ie||!oe&&we>=ie)&&0===de[ke]&&(de[ke]=de[_e],me.queue([fe[0]+W.dxs[be],fe[1]+W.dys[be],we]))}}}}return new E.default(le,de)};var L=D("../RoiMap"),E=T(L),G=D("js-priority-queue"),Z=T(G),W=D("./../../../util/dxdy.js")},{"../RoiMap":195,"./../../../util/dxdy.js":261,"js-priority-queue":56}],201:[function(D,I,R){"use strict";function T(me){return me&&me.__esModule?me:{default:me}}function L(me,ce,ge,pe,fe){var _e={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(var be=0;be<ge.length;be++){var ye=ge[be],xe=ye[0],ke=ye[1],we=xe+me+(ke+ce)*pe.width,ve=pe.data[we];(0<ve||0>ve)&&(_e.id.includes(ve)?_e.surface[_e.id.indexOf(ve)]+=1:(_e.id.push(ve),_e.surface.push(1)))}for(var Me=0;Me<_e.id.length;Me++){var je=Math.sign(_e.id[Me]);je===fe?_e.same+=_e.surface[Me]:_e.opposite+=_e.surface[Me],_e.roiSurfaceCovered[Me]=_e.surface[Me]/ge.length}return _e.total=_e.opposite+_e.same,_e}Object.defineProperty(R,"__esModule",{value:!0});var E=D("./creator/fromMask"),G=T(E),Z=D("./creator/fromMaskConnectedComponentLabelingAlgorithm"),W=T(Z),Q=D("./creator/fromMaxima"),$=T(Q),J=D("./creator/fromWaterShed"),ee=T(J),te=D("./creator/fromPoints"),ae=T(te),ie=D("extend"),ne=T(ie),oe=D("../Image"),le=T(oe),se=D("./RoiMap"),de=T(se),ue=D("./RoiLayer"),he=T(ue);R.default=class{constructor(ce){var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};this._image=ce,this._options=ge,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(){var ce=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},ge=(0,ne.default)({},this._options,ce),pe=$.default.call(this._image,ce);this._layers[ge.label]=new he.default(pe,ge)}fromPoints(ce){var ge=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},pe=(0,ne.default)({},this._options,ge),fe=ae.default.call(this._image,ce,ge);return this._layers[pe.label]=new he.default(fe,pe),this}putMap(ce){var ge=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},pe=new de.default(this._image,ce),fe=(0,ne.default)({},this._options,ge);return this._layers[fe.label]=new he.default(pe,fe),this}fromWaterShed(){var ce=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},ge=(0,ne.default)({},this._options,ce),pe=ee.default.call(this._image,ce);this._layers[ge.label]=new he.default(pe,ge)}fromMask(ce){var ge=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},pe=(0,ne.default)({},this._options,ge),fe=G.default.call(this._image,ce,ge);return this._layers[pe.label]=new he.default(fe,pe),this}fromMaskConnectedComponentLabelingAlgorithm(ce){var ge=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},pe=(0,ne.default)({},this._options,ge),fe=W.default.call(this._image,ce,ge);return this._layers[pe.label]=new he.default(fe,pe),this}getMap(){var ce=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ge=(0,ne.default)({},this._options,ce);return this._assertLayerWithLabel(ge.label),this._layers[ge.label].roiMap}getRoiIds(){var ce=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},ge=this.getRois(ce);if(ge){var pe=Array(ge.length);for(var fe=0;fe<ge.length;fe++)pe[fe]=ge[fe].id;return pe}throw new Error("ROIs not found")}getRois(){var ce=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ge=ce.label,pe=void 0===ge?this._options.label:ge,fe=ce.positive,_e=void 0===fe||fe,be=ce.negative,ye=void 0===be||be,xe=ce.minSurface,ke=void 0===xe?0:xe,we=ce.maxSurface,ve=void 0===we?Number.POSITIVE_INFINITY:we,Me=ce.minWidth,je=void 0===Me?0:Me,Pe=ce.maxWidth,De=void 0===Pe?Number.POSITIVE_INFINITY:Pe,Se=ce.minHeight,Ie=void 0===Se?0:Se,Ce=ce.maxHeight,Ae=void 0===Ce?Number.POSITIVE_INFINITY:Ce;if(!this._layers[pe])throw new Error("getRoi: This Roi layer ("+pe+") does not exists.");var Re=this._layers[pe].roi,Be=Array(Re.length),ze=0;for(var Te=0;Te<Re.length;Te++){var Le=Re[Te];(0>Le.id&&ye||0<Le.id&&_e)&&Le.surface>=ke&&Le.surface<=ve&&Le.width>=je&&Le.width<=De&&Le.height>=Ie&&Le.height<=Ae&&(Be[ze++]=Le)}return Be.length=ze,Be}getMasks(){var ce=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},ge=this.getRois(ce),pe=Array(ge.length);for(var fe=0;fe<ge.length;fe++)pe[fe]=ge[fe].getMask(ce);return pe}getData(){var ce=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ge=(0,ne.default)({},this._options,ce);return this._assertLayerWithLabel(ge.label),this._layers[ge.label].roiMap.data}paint(){var ce=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ge=ce.labelProperty;this._painted||(this._painted=this._image.rgba8());var pe=this.getMasks(ce);if(ge){var fe=this.getRois(ce);ce.labels=fe.map(_e=>_e[ge]),ce.labelsPosition=fe.map(_e=>[_e.meanX,_e.meanY])}return this._painted.paintMasks(pe,ce),this._painted}getMask(){var ce=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},ge=new le.default(this._image.width,this._image.height,{kind:"BINARY"}),pe=this.getMasks(ce);for(var fe=0;fe<pe.length;fe++){var _e=pe[fe];for(var be=0;be<_e.width;be++)for(var ye=0;ye<_e.height;ye++)_e.getBitXY(be,ye)&&ge.setBitXY(be+_e.position[0],ye+_e.position[1])}return ge}resetPainted(){var ce=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},ge=ce.image;this._painted=ge?this.image.rgba8():this._image.rgba8()}mergeRoi(){var ce=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ge=(0,ne.default)({},this._options,ce),pe=ce.algorithm,fe=void 0===pe?"commonBorder":pe,_e=ce.minCommonBorderLength,be=void 0===_e?5:_e,ye=this.getRois(ge),xe=new Set;switch(fe.toLowerCase()){case"commonborder":for(var ke=0;ke<ye.length;ke++)for(var we=0;we<ye[ke].borderIDs.length;we++)0!==ye[ke].borderIDs[we]&&ye[ke].borderIDs[we]<ye[ke].id&&ye[ke].borderLengths[we]*be>=ye[ke].border&&xe.add([ye[ke].id,ye[ke].borderIDs[we]]);break;default:throw new Error(`Unexpected algorithm: ${fe}`);}var ve=this.getMap(ge).data;for(var Me=0;Me<ve.length;Me++)if(0!==ve[Me])for(var je of xe)ve[Me]===je[0]&&(ve[Me]=je[1]);return this.putMap(ve,ge),this}findCorrespondingRoi(ce){var ge=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},pe=this.getRois(ge),fe=[];for(var _e=0;_e<pe.length;_e++){var be=pe[_e],ye=be.minX,xe=be.minY,ke=be.points,we=Math.sign(be.id),ve=L(ye,xe,ke,ce,we);fe.push(ve)}return fe}_assertLayerWithLabel(ce){if(!this._layers[ce])throw new Error(`no layer with label ${ce}`)}}},{"../Image":146,"./RoiLayer":194,"./RoiMap":195,"./creator/fromMask":196,"./creator/fromMaskConnectedComponentLabelingAlgorithm":197,"./creator/fromMaxima":198,"./creator/fromPoints":199,"./creator/fromWaterShed":200,extend:35}],202:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[T.RGB]});var Z=E.default.createFrom(this,{components:4,colorModel:T.CMYK}),W=0,Q=this.data;for(var $=0;$<Q.length;$+=this.channels){var J=Q[$],ee=Q[$+1],te=Q[$+2],ae=Math.min(this.maxValue-J,this.maxValue-ee,this.maxValue-te),ie=(this.maxValue-J-ae)/(1-ae/this.maxValue),ne=(this.maxValue-ee-ae)/(1-ae/this.maxValue),oe=(this.maxValue-te-ae)/(1-ae/this.maxValue);Z.data[W++]=ie,Z.data[W++]=ne,Z.data[W++]=oe,Z.data[W++]=ae,this.alpha&&(Z.data[W++]=Q[$+3])}return Z};var T=D("../model/model"),L=D("../Image"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L)},{"../Image":146,"../model/model":186}],203:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var G=0<arguments.length&&void 0!==arguments[0]?arguments[0]:8;if(this.checkProcessable("colorDepth",{bitDepth:[8,16]}),![8,16].includes(G))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===G)return this.clone();var Z=L.default.createFrom(this,{bitDepth:G});if(8===G)for(var W=0;W<this.data.length;W++)Z.data[W]=this.data[W]>>8;else for(var Q=0;Q<this.data.length;Q++)Z.data[Q]=this.data[Q]<<8|this.data[Q];return Z};var T=D("../Image"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../Image":146}],204:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var G=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Z=G.x,W=void 0===Z?0:Z,Q=G.y,$=void 0===Q?0:Q,J=G.width,ee=void 0===J?this.width-W:J,te=G.height,ae=void 0===te?this.height-$:te;if(W=Math.round(W),$=Math.round($),ee=Math.round(ee),ae=Math.round(ae),W>this.width-1||$>this.height-1)throw new RangeError(`crop: origin (x:${W}, y:${$}) out of range (${this.width-1}; ${this.height-1})`);if(0>=ee||0>=ae)throw new RangeError(`crop: width and height (width:${ee}; height:${ae}) must be positive numbers`);if(0>W||0>$)throw new RangeError(`crop: x and y (x:${W}, y:${$}) must be positive numbers`);if(ee>this.width-W||ae>this.height-$)throw new RangeError(`crop: (x: ${W}, y:${$}, width:${ee}, height:${ae}) size is out of range`);var ie=L.default.createFrom(this,{width:ee,height:ae}),ne=ee*this.channels,oe=$+ae,le=0,se=W*this.channels;for(var de=$;de<oe;de++)for(var ue=de*this.width*this.channels+se,he=ue+ne;ue<he;ue++)ie.data[le++]=this.data[ue];return ie};var T=D("../Image"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../Image":146}],205:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var W=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},Q=W.algorithm,$=Q===void 0?"luma709":Q,J=W.keepAlpha,ee=J!==void 0&&J,te=W.mergeAlpha,ae=!(te!==void 0)||te,ie=W.allowGrey,ne=ie!==void 0&&ie,oe={bitDepth:[8,16],alpha:[0,1]};ne||(oe.colorModel=[E.RGB],oe.components=[3]),this.checkProcessable("grey",oe),1===this.components&&($="red"),ee&=this.alpha,ae&=this.alpha,ee&&(ae=!1);var le=L.default.createFrom(this,{components:1,alpha:ee,colorModel:null}),se=G.methods[$.toLowerCase()];if(!se)throw new Error("Unsupported grey algorithm: "+$);var de=0;for(var ue=0;ue<this.data.length;ue+=this.channels)ae?le.data[de++]=se(this.data,ue,this)*this.data[ue+this.components]/this.maxValue:(le.data[de++]=se(this.data,ue,this),le.alpha&&(le.data[de++]=this.data[ue+this.components]));return le};var T=D("../Image"),L=function(W){return W&&W.__esModule?W:{default:W}}(T),E=D("../model/model"),G=D("./greyAlgorithms")},{"../Image":146,"../model/model":186,"./greyAlgorithms":206}],206:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var T=R.methods={luma709:function(E,G){return 6966*E[G]+23436*E[G+1]+2366*E[G+2]>>15},luma601:function(E,G){return 9798*E[G]+19235*E[G+1]+3735*E[G+2]>>15},maximum:function(E,G){return Math.max(E[G],E[G+1],E[G+2])},minimum:function(E,G){return Math.min(E[G],E[G+1],E[G+2])},average:function(E,G){return(E[G]+E[G+1]+E[G+2])/3>>0},minmax:function(E,G){return(Math.max(E[G],E[G+1],E[G+2])+Math.min(E[G],E[G+1],E[G+2]))/2},red:function(E,G){return E[G]},green:function(E,G){return E[G+1]},blue:function(E,G){return E[G+2]},cyan:function(E,G,Z){var W=T.black(E,G,Z);return(Z.maxValue-E[0]-W)/(1-W/Z.maxValue)>>0},magenta:function(E,G,Z){var W=T.black(E,G,Z);return(Z.maxValue-E[1]-W)/(1-W/Z.maxValue)>>0},yellow:function(E,G,Z){var W=T.black(E,G,Z);return(Z.maxValue-E[2]-W)/(1-W/Z.maxValue)>>0},black:function(E,G,Z){return Math.min(Z.maxValue-E[G],Z.maxValue-E[G+1],Z.maxValue-E[G+2])},hue:function(E,G,Z){var W=T.min(E,G),Q=T.max(E,G);if(Q===W)return 0;var L=0,$=Q-W;switch(Q){case E[G]:L=(E[G+1]-E[G+2])/$+(E[G+1]<E[G+2]?6:0);break;case E[G+1]:L=(E[G+2]-E[G])/$+2;break;case E[G+2]:L=(E[G]-E[G+1])/$+4;break;default:throw new Error("unreachable");}return L/6*Z.maxValue>>0},saturation:function(E,G,Z){var W=T.min(E,G),Q=T.max(E,G);return 0===Q?0:(Q-W)/Q*Z.maxValue},lightness:function(E,G){var Z=T.min(E,G),W=T.max(E,G);return(W+Z)/2}};Object.defineProperty(T,"luminosity",{enumerable:!1,value:T.lightness}),Object.defineProperty(T,"luminance",{enumerable:!1,value:T.lightness}),Object.defineProperty(T,"min",{enumerable:!1,value:T.minimum}),Object.defineProperty(T,"max",{enumerable:!1,value:T.maximum}),Object.defineProperty(T,"brightness",{enumerable:!1,value:T.maximum}),R.names=Object.keys(T)},{}],207:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[T.RGB]});var Z=E.default.createFrom(this,{colorModel:T.HSL}),W=Math.floor(this.maxValue/2),Q=0,$=this.data;for(var J=0;J<$.length;J+=this.channels){var ee=$[J],te=$[J+1],ae=$[J+2],ie=Math.max(ee,te,ae),ne=Math.min(ee,te,ae),oe=0,le=0,se=(ie+ne)/2;if(ie!==ne){var de=ie-ne;switch(le=se>W?de/(2-ie-ne):de/(ie+ne),ie){case ee:oe=(te-ae)/de+(te<ae?6:0);break;case te:oe=(ae-ee)/de+2;break;case ae:oe=(ee-te)/de+4;break;default:throw new Error("unreachable");}oe/=6}Z.data[Q++]=oe*this.maxValue,Z.data[Q++]=le*this.maxValue,Z.data[Q++]=se,this.alpha&&(Z.data[Q++]=$[J+3])}return Z};var T=D("../model/model"),L=D("../Image"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L)},{"../Image":146,"../model/model":186}],208:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[T.RGB]});var Z=E.default.createFrom(this,{colorModel:T.HSV}),W=0,Q=this.data;for(var $=0;$<Q.length;$+=this.channels){var J=Q[$],ee=Q[$+1],te=Q[$+2],ae=Math.min(J,ee,te),ie=Math.max(J,ee,te),ne=ie-ae,oe=0,le=0===ie?0:ne/ie;if(ie!==ae){switch(ie){case J:oe=(ee-te)/ne+(ee<te?6:0);break;case ee:oe=(te-J)/ne+2;break;case te:oe=(J-ee)/ne+4;break;default:throw new Error("unreachable");}oe/=6}Z.data[W++]=oe*this.maxValue,Z.data[W++]=le*this.maxValue,Z.data[W++]=ie,this.alpha&&(Z.data[W++]=Q[$+3])}return Z};var T=D("../model/model"),L=D("../Image"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L)},{"../Image":146,"../model/model":186}],209:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){var E=0;for(var G=0;G<L.length;G++)if(0!==L[G]){E=G;break}var Z=L.length-1;for(var W=L.length-1;W>=E;W--)if(0!==L[W]){Z=W;break}var Q=1/(Z-E),$=Array(L.length),J=0,ee=0;for(var te=E;te<L.length;te++)J+=te*L[te],ee+=L[te],$[te]=J/ee;var ae=Array(L.length);J=ee=0;for(var ie=Z;0<ie;ie--)J+=ie*L[ie],ee+=L[ie],ae[ie-1]=J/ee;var ne=-1,oe=Number.MAX_VALUE;for(var le=0;le<L.length;le++){var se=0,de=void 0;for(var ue=0;ue<=le;ue++)de=1/(1+Q*Math.abs(ue-$[le])),1e-6>de||0.999999<de||(se+=L[ue]*(-de*Math.log(de)-(1-de)*Math.log(1-de)));for(var he=le+1;he<L.length;he++)de=1/(1+Q*Math.abs(he-ae[le])),1e-6>de||0.999999<de||(se+=L[he]*(-de*Math.log(de)-(1-de)*Math.log(1-de)));se<oe&&(oe=se,ne=le)}return ne}},{}],210:[function(D,I,R){"use strict";function T(L){var E=!1,G=0;for(var Z=1;Z<L.length-1;Z++)if(L[Z-1]<L[Z]&&L[Z+1]<L[Z]&&(G++,2<G))return!1;return 2==G&&(E=!0),E}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(E){for(var G=E.slice(),Z=0;!T(G);){var W=0,Q=0,$=G[0];for(var J=0;J<E.length-1;J++)W=Q,Q=$,$=G[J+1],G[J]=(W+Q+$)/3;if(G[E.length-1]=(Q+$)/3,Z++,1e4<Z)throw new Error("Intermodes Threshold not found after 10000 iterations")}var ee=0;for(var te=1;te<E.length-1;te++)G[te-1]<G[te]&&G[te+1]<G[te]&&(ee+=te);return Math.floor(ee/2)}},{}],211:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){var E=void 0,G=void 0,Z=void 0,W=void 0,Q=0;for(var $=1;$<L.length;$++)if(0<L[$]){Q=$+1;break}for(;!0;){E=0,Z=0;for(var J=0;J<Q;J++)Z=Z+L[J],E=E+L[J]*J;W=0,G=0;for(var ee=Q+1;ee<L.length;ee++)G+=L[ee],W+=L[ee]*ee;if(0<Z&&0<G&&(E/=Z,W/=G,Q===Math.round((E+W)/2)))break;if(Q++,Q>L.length-2)throw new Error("Threshold not found")}return Q}},{}],212:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E){var G=void 0,Z=void 0,W=void 0,Q=void 0,$=void 0,J=void 0,ee=void 0,te=void 0,ae=void 0,ie=void 0,ne=void 0,oe=void 0;ne=0.5,ie=0;for(var le=0;le<L.length;le++)ie+=le*L[le];ie/=E,ee=ie;do{J=ee,G=0|J+0.5,Z=0,Q=0;for(var se=0;se<=G;se++)Z+=se*L[se],Q+=L[se];te=0===Q?0:Z/Q,W=0,$=0;for(var de=G+1;de<L.length;de++)W+=de*L[de],$+=L[de];ae=0===$?0:W/$,oe=(te-ae)/(Math.log(te)-Math.log(ae)),ee=oe<-Number.EPSILON?0|oe-0.5:0|oe+0.5}while(Math.abs(ee-J)>ne);return G}},{}],213:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var W=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Q=W.algorithm,$=void 0===Q?"threshold":Q,J=W.threshold,ee=void 0===J?0.5:J,te=W.useAlpha,ae=void 0===te||te,ie=W.invert,ne=void 0!==ie&&ie;if(this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),"threshold"===$)ee=(0,G.getThreshold)(ee,this.maxValue);else{var oe=E.methods[$.toLowerCase()];if(oe){var le=this.getHistogram();ee=oe(le,this.size)}else throw new Error("mask transform unknown algorithm: "+$)}var se=new L.default(this.width,this.height,{kind:"BINARY",parent:this}),de=0;if(this.alpha&&ae)for(var ue=0;ue<this.data.length;ue+=this.channels){var he=this.data[ue]+(this.maxValue-this.data[ue])*(this.maxValue-this.data[ue+1])/this.maxValue;(ne&&he<=ee||!ne&&he>=ee)&&se.setBit(de),de++}else for(var me=0;me<this.data.length;me+=this.channels)(ne&&this.data[me]<=ee||!ne&&this.data[me]>=ee)&&se.setBit(de),de++;return se};var T=D("../../Image"),L=function(W){return W&&W.__esModule?W:{default:W}}(T),E=D("./maskAlgorithms"),G=D("../../../util/converter")},{"../../../util/converter":260,"../../Image":146,"./maskAlgorithms":214}],214:[function(D,I,R){"use strict";function T(Me){return Me&&Me.__esModule?Me:{default:Me}}Object.defineProperty(R,"__esModule",{value:!0}),R.names=R.methods=void 0;var L=D("./huang"),E=T(L),G=D("./intermodes"),Z=T(G),W=D("./isodata"),Q=T(W),$=D("./li"),J=T($),ee=D("./maxEntropy"),te=T(ee),ae=D("./mean"),ie=T(ae),ne=D("./minError"),oe=T(ne),le=D("./minimum"),se=T(le),de=D("./moments"),ue=T(de),he=D("./otsu"),me=T(he),ce=D("./percentile"),ge=T(ce),pe=D("./renyiEntropy.js"),fe=T(pe),_e=D("./shanbhag"),be=T(_e),ye=D("./triangle"),xe=T(ye),ke=D("./yen"),we=T(ke),ve=R.methods={huang:E.default,intermodes:Z.default,isodata:Q.default,li:J.default,maxentropy:te.default,mean:ie.default,minerror:oe.default,minimum:se.default,moments:ue.default,otsu:me.default,percentile:ge.default,renyientropy:fe.default,shanbhag:be.default,triangle:xe.default,yen:we.default};R.names=["threshold"].concat(Object.keys(ve))},{"./huang":209,"./intermodes":210,"./isodata":211,"./li":212,"./maxEntropy":215,"./mean":216,"./minError":217,"./minimum":218,"./moments":219,"./otsu":220,"./percentile":221,"./renyiEntropy.js":222,"./shanbhag":223,"./triangle":224,"./yen":225}],215:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E){var G=Array(L.length);for(var Z=0;Z<L.length;Z++)G[Z]=L[Z]/E;var W=Array(L.length),Q=Array(L.length);W[0]=G[0],Q[0]=1-W[0];for(var $=1;$<L.length;$++)W[$]=W[$-1]+G[$],Q[$]=1-W[$];var J=0;for(var ee=0;ee<L.length;ee++)if(Math.abs(W[ee])>=Number.EPSILON){J=ee;break}var te=L.length-1;for(var ae=L.length-1;ae>=J;ae--)if(Math.abs(Q[ae])>=Number.EPSILON){te=ae;break}var ie=-1,ne=void 0,oe=Number.MIN_VALUE,le=void 0,se=void 0;for(var de=J;de<=te;de++){le=0;for(var ue=0;ue<=de;ue++)0!==L[ue]&&(le-=G[ue]/W[de]*Math.log(G[ue]/W[de]));se=0;for(var he=de+1;he<L.length;he++)0!==L[he]&&(se-=G[he]/Q[de]*Math.log(G[he]/Q[de]));ne=le+se,oe<ne&&(oe=ne,ie=de)}return ie}},{}],216:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E){var G=0;for(var Z=0;Z<L.length;Z++)G+=Z*L[Z];return Math.floor(G/E)}},{}],217:[function(D,I,R){"use strict";function T(G,Z){var W=0;for(var Q=0;Q<=Z;Q++)W+=G[Q];return W}function L(G,Z){var W=0;for(var Q=0;Q<=Z;Q++)W+=Q*G[Q];return W}function E(G,Z){var W=0;for(var Q=0;Q<=Z;Q++)W+=Q*Q*G[Q];return W}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Z,W){var Q=void 0,$=-2,J=void 0,ee=void 0,te=void 0,ae=void 0,ie=void 0,ne=void 0,oe=void 0,le=void 0,se=void 0,de=void 0,ue=void 0,he=0;for(var me=0;me<Z.length;me++)he+=me*Z[me];for(he/=W,Q=he;Q!==$;){var ce=T(Z,Q),ge=T(Z,Z.length-1),pe=L(Z,Q),fe=L(Z,Z.length-1),_e=E(Z,Q),be=E(Z,Z.length-1);if(J=pe/ce,ee=(fe-pe)/(ge-ce),te=ce/ge,ae=(ge-ce)/ge,ie=_e/ce-J*J,ne=(be-_e)/(ge-ce)-ee*ee,oe=1/ie-1/ne,le=J/ie-ee/ne,se=J*J/ie-ee*ee/ne+Math.log10(ie*(ae*ae)/(ne*(te*te))),de=le*le-oe*se,0>de)return Q;$=Q,ue=(le+Math.sqrt(de))/oe,Q=isNaN(ue)?$:Math.floor(ue)}return Q}},{}],218:[function(D,I,R){"use strict";function T(G){var Z=Array(G.length);for(var W=1;W<G.length-1;W++)Z[W]=(G[W-1]+G[W]+G[W+1])/3;return Z[0]=(G[0]+G[1])/3,Z[G.length-1]=(G[G.length-2]+G[G.length-1])/3,Z}function L(G,Z){var W=void 0;for(var Q=1;Q<Z;Q++)if(G[Q-1]>G[Q]&&G[Q+1]>=G[Q]){W=Q;break}return W}function E(G){var Z=G.length,W=!1,Q=0;for(var $=1;$<Z-1;$++)if(G[$-1]<G[$]&&G[$+1]<G[$]&&(Q++,2<Q))return!1;return 2==Q&&(W=!0),W}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Z){if(2>Z.length)return 0;var W=0,Q=-1,$=-1,J=Array(Z.length);for(var ee=0;ee<Z.length;ee++)J[ee]=Z[ee],0<Z[ee]&&($=ee);for(;!E(J);)if(J=T(J),W++,1e4<W)return Q;return Q=L(J,$),Q}},{}],219:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E){var G=1,Z=0,W=0,Q=0,$=0,J=void 0,ee=void 0,te=void 0,ae=void 0,ie=void 0,ne=void 0,oe=-1,le=L.length,se=Array(le);for(var de=0;de<le;de++)se[de]=L[de]/E;for(var ue=0;ue<le;ue++)Z+=ue*se[ue],W+=ue*ue*se[ue],Q+=ue*ue*ue*se[ue];ee=G*W-Z*Z,te=(-W*W+Z*Q)/ee,ae=(G*-Q+W*Z)/ee,ie=0.5*(-ae-Math.sqrt(ae*ae-4*te)),ne=0.5*(-ae+Math.sqrt(ae*ae-4*te)),J=(ne-Z)/(ne-ie);for(var he=0;he<le;he++)if($+=se[he],$>J){oe=he;break}return oe}},{}],220:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E){var G=0,Z=0,W=0,Q=0,$=void 0,J=void 0,ee=0,te=0,ae=0;for(var ie=1;ie<L.length;++ie)G+=ie*L[ie];for(var ne=1;ne<L.length;++ne)if(W+=L[ne],0!=W){if(Q=E-W,0==Q)break;Z+=ne*L[ne],$=Z/W,J=(G-Z)/Q,te=W*Q*($-J)*($-J),te>=ee&&(ae=ne,ee=te)}return ae}},{}],221:[function(D,I,R){"use strict";function T(L,E){var G=0;for(var Z=0;Z<=E;Z++)G+=L[Z];return G}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){var E=-1,G=Array(L.length),Z=T(L,L.length-1),W=1;for(var Q=0;Q<L.length;Q++)G[Q]=Math.abs(T(L,Q)/Z-0.5),G[Q]<W&&(W=G[Q],E=Q);return E}},{}],222:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(E,G){var Z=void 0,W=void 0,Q=void 0,$=Array(E.length),J=Array(E.length),ee=Array(E.length),te=0,ae=0,ie=0,ne=0,oe=0,le=0;for(var se=0;se<E.length;se++)$[se]=E[se]/G;J[0]=$[0],ee[0]=1-J[0];for(var de=1;de<E.length;de++)J[de]=J[de-1]+$[de],ee[de]=1-J[de];W=0;for(var ue=0;ue<E.length;ue++)if(Math.abs(J[ue])>=Number.EPSILON){W=ue;break}Q=E.length-1;for(var he=E.length-1;he>=W;he--)if(Math.abs(ee[he])>=Number.EPSILON){Q=he;break}for(var me=W;me<=Q;me++){var ce=0,ge=0,pe=0;for(var fe=0;fe<=me;fe++)0!==E[fe]&&(ce-=$[fe]/J[me]*Math.log($[fe]/J[me])),ge+=Math.sqrt($[fe]/J[me]),pe+=$[fe]*$[fe]/(J[me]*J[me]);var _e=0,be=0,ye=0;for(var xe=me+1;xe<E.length;xe++)0!==E[xe]&&(_e-=$[xe]/ee[me]*Math.log($[xe]/ee[me])),be+=Math.sqrt($[xe]/ee[me]),ye+=$[xe]*$[xe]/(ee[me]*ee[me]);var ke=ce+_e,we=2*(0<ge*be?Math.log(ge*be):0),ve=-1*(0<pe*ye?Math.log(pe*ye):0);ke>ne&&(ne=ke,te=me),we>oe&&(oe=we,ae=me),ve>le&&(le=ve,ie=me)}var Me=[te,ae,ie];Me.sort(T.asc);var je=void 0;je=5>=Math.abs(Me[0]-Me[1])?5>=Math.abs(Me[1]-Me[2])?[1,2,1]:[0,1,3]:5>=Math.abs(Me[1]-Me[2])?[3,1,0]:[1,2,1];var Pe=J[Me[2]]-J[Me[0]];return Z=Math.round(Me[0]*(J[Me[0]]+0.25*Pe*je[0])+0.25*Me[1]*Pe*je[1]+Me[2]*(ee[Me[2]]+0.25*Pe*je[2])),Z};var T=D("num-sort")},{"num-sort":115}],223:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E){var G=Array(L.length);for(var Z=0;Z<L.length;Z++)G[Z]=L[Z]/E;var W=Array(L.length),Q=Array(L.length);W[0]=G[0],Q[0]=1-W[0];for(var $=1;$<L.length;$++)W[$]=W[$-1]+G[$],Q[$]=1-W[$];var J=0;for(var ee=0;ee<L.length;ee++)if(Math.abs(W[ee])>=Number.EPSILON){J=ee;break}var te=L.length-1;for(var ae=L.length-1;ae>=J;ae--)if(Math.abs(Q[ae])>=Number.EPSILON){te=ae;break}var ie=-1,ne=Number.MAX_VALUE,oe=void 0,le=void 0,se=void 0,de=void 0;for(var ue=J;ue<=te;ue++){se=0,oe=0.5/W[ue];for(var he=1;he<=ue;he++)se-=G[he]*Math.log(1-oe*W[he-1]);se*=oe,de=0,oe=0.5/Q[ue];for(var me=ue+1;me<L.length;me++)de-=G[me]*Math.log(1-oe*Q[me]);de*=oe,le=Math.abs(se-de),le<ne&&(ne=le,ie=ue)}return ie}},{}],224:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){var E=0,G=0,Z=0,W=0;for(var Q=0;Q<L.length;Q++)if(0<L[Q]){E=Q;break}0<E&&E--;for(var $=L.length-1;0<$;$--)if(0<L[$]){W=$;break}W<L.length-1&&W++;for(var J=0;J<L.length;J++)L[J]>G&&(Z=J,G=L[J]);var ee=!1;if(Z-E<W-Z){ee=!0;for(var te=0,ae=L.length-1;te<ae;){var ie=L[te];L[te]=L[ae],L[ae]=ie,te++,ae--}E=L.length-1-W,Z=L.length-1-Z}if(E===Z)return E;var ne=void 0,oe=void 0,le=void 0;ne=L[Z],oe=E-Z,le=Math.sqrt(ne*ne+oe*oe),ne/=le,oe/=le,le=ne*E+oe*L[E];var se=E,de=0;for(var ue=E+1;ue<=Z;ue++){var he=ne*ue+oe*L[ue]-le;he>de&&(se=ue,de=he)}if(se--,ee){for(var me=0,ce=L.length-1;me<ce;){var ge=L[me];L[me]=L[ce],L[ce]=ge,me++,ce--}return L.length-1-se}return se}},{}],225:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E){var G=Array(L.length);for(var Z=0;Z<L.length;Z++)G[Z]=L[Z]/E;var W=Array(L.length);W[0]=G[0];for(var Q=1;Q<L.length;Q++)W[Q]=W[Q-1]+G[Q];var $=Array(L.length);$[0]=G[0]*G[0];for(var J=1;J<L.length;J++)$[J]=$[J-1]+G[J]*G[J];var ee=Array(L.length);ee[L.length-1]=0;for(var te=L.length-2;0<=te;te--)ee[te]=ee[te+1]+G[te+1]*G[te+1];var ae=-1,ie=Number.MIN_VALUE,ne=void 0;for(var oe=0;oe<L.length;oe++)ne=-1*(0<$[oe]*ee[oe]?Math.log($[oe]*ee[oe]):0)+2*(0<W[oe]*(1-W[oe])?Math.log(W[oe]*(1-W[oe])):0),ne>ie&&(ie=ne,ae=oe);return ae}},{}],226:[function(D,I,R){"use strict";function T($){return $&&$.__esModule?$:{default:$}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var J=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ee=J.size,te=void 0===ee?0:ee,ae=J.algorithm,ie=void 0===ae?"copy":ae,ne=J.color;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===ie){if(ne.length!==this.channels)throw new Error("pad: the color array must have the same length as the number of channels. Here: "+this.channels);for(var oe=0;oe<ne.length;oe++)0===ne[oe]&&(ne[oe]=1e-3)}else ne=(0,Z.default)(this.channels,null);Array.isArray(te)||(te=[te,te]);var le=this.width+2*te[0],se=this.height+2*te[1],de=this.channels,ue=E.default.createFrom(this,{width:le,height:se});(0,Q.default)(this,ue,te[0],te[1]);for(var he=te[0];he<le-te[0];he++)for(var me=0;me<de;me++){var ce=ne[me]||ue.data[(te[1]*le+he)*de+me];for(var ge=0;ge<te[1];ge++)ue.data[(ge*le+he)*de+me]=ce;ce=ne[me]||ue.data[((se-te[1]-1)*le+he)*de+me];for(var pe=se-te[1];pe<se;pe++)ue.data[(pe*le+he)*de+me]=ce}for(var fe=0;fe<se;fe++)for(var _e=0;_e<de;_e++){var be=ne[_e]||ue.data[(fe*le+te[0])*de+_e];for(var ye=0;ye<te[0];ye++)ue.data[(fe*le+ye)*de+_e]=be;be=ne[_e]||ue.data[(fe*le+le-te[0]-1)*de+_e];for(var xe=le-te[0];xe<le;xe++)ue.data[(fe*le+xe)*de+_e]=be}return ue};var L=D("../Image"),E=T(L),G=D("new-array"),Z=T(G),W=D("../utility/copy"),Q=T(W)},{"../Image":146,"../utility/copy":233,"new-array":114}],227:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var Z=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0.5;this.checkProcessable("resizeBinary",{bitDepth:[1]});var W=Math.max(Math.floor(this.width*Z),1),Q=Math.max(Math.floor(this.height*Z),1),$=Math.round((this.width-W)/2),J=Math.round((this.height-Q)/2),ee=L.default.createFrom(this,{kind:E.BINARY,width:W,height:Q,position:[$,J],parent:this});for(var te=0;te<this.width;te++)for(var ae=0;ae<this.height;ae++)this.getBitXY(te,ae)&&ee.setBitXY(Math.floor(te*Z),Math.floor(ae*Z));return ee};var T=D("../Image"),L=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(T),E=D("../kindNames")},{"../Image":146,"../kindNames":183}],228:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){return new L.default(this.width,this.height,this.getRGBAData(),{kind:"RGBA"})};var T=D("../Image"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../Image":146}],229:[function(D,I,R){"use strict";function T(){var W=Z.default.createFrom(this,{width:this.height,height:this.width}),Q=W.height-1;for(var $=0;$<this.height;$++)for(var J=0;J<this.width;J++)for(var ee=0;ee<this.channels;ee++)W.setValueXY($,Q-J,ee,this.getValueXY(J,$,ee));return W}function L(){var W=Z.default.createFrom(this,{width:this.height,height:this.width}),Q=W.width-1;for(var $=0;$<this.height;$++)for(var J=0;J<this.width;J++)for(var ee=0;ee<this.channels;ee++)W.setValueXY(Q-$,J,ee,this.getValueXY(J,$,ee));return W}function E(){var W=Z.default.createFrom(this),Q=W.width-1,$=W.height-1;for(var J=0;J<this.height;J++)for(var ee=0;ee<this.width;ee++)for(var te=0;te<this.channels;te++)W.setValueXY(Q-ee,$-J,te,this.getValueXY(ee,J,te));return W}Object.defineProperty(R,"__esModule",{value:!0}),R.rotate=function(Q){if("number"!=typeof Q)throw new TypeError("angle must be a number");switch(0>Q&&(Q=360*Math.ceil(-Q/360)+Q),Q%360){case 0:return this.clone();case 90:return L.call(this);case 180:return E.call(this);case 270:return T.call(this);default:throw new Error("free angle rotation is currently not supported");}},R.rotateLeft=T,R.rotateRight=L;var G=D("../Image"),Z=function(Q){return Q&&Q.__esModule?Q:{default:Q}}(G)},{"../Image":146}],230:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E,G){var Z=this.width/E,W=this.height/G;if(1<this.bitDepth)for(var Q=0;Q<E;Q++){var $=Math.floor((Q+0.5)*Z);for(var J=0;J<G;J++){var ee=Math.floor((J+0.5)*W);for(var te=0;te<this.channels;te++)L.setValueXY(Q,J,te,this.getValueXY($,ee,te))}}else for(var ae=0;ae<E;ae++){var ie=Math.floor((ae+0.5)*Z);for(var ne=0;ne<G;ne++){var oe=Math.floor((ne+0.5)*W);this.getBitXY(ie,oe)&&L.setBitXY(ae,ne)}}}},{}],231:[function(D,I,R){"use strict";function T(Q){return Q&&Q.__esModule?Q:{default:Q}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var $=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},J=$.factor,ee=void 0===J?1:J,te=$.algorithm,ae=void 0===te?"nearestNeighbor":te,ie=$.preserveAspectRatio,ne=void 0===ie||ie,oe=$.width,le=$.height;oe||(le&&ne?oe=Math.round(le*(this.width/this.height)):oe=this.width),le||(ne?le=Math.round(oe*(this.height/this.width)):le=this.height);var se=(0,W.factorDimensions)(ee,oe,le);if(oe=se.width,le=se.height,oe===this.width&&le===this.height)return this.clone();var de=E.default.createFrom(this,{width:oe,height:le});switch(ae.toLowerCase()){case"nearestneighbor":case"nearestneighbour":Z.default.call(this,de,oe,le);break;default:throw new Error("Unsupported scale algorithm: "+ae);}return de};var L=D("../../Image"),E=T(L),G=D("./nearestNeighbor"),Z=T(G),W=D("../../../util/converter")},{"../../../util/converter":260,"../../Image":146,"./nearestNeighbor":230}],232:[function(D,I,R){"use strict";function T(G){return(G[0]+G[1]+G[2])/3}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var Z=0<arguments.length&&arguments[0]!==void 0?arguments[0]:T,W=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},Q=W.mergeAlpha,$=Q!==void 0&&Q,J=W.keepAlpha,ee=J!==void 0&&J;$&=this.alpha,ee&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});var te=E.default.createFrom(this,{components:1,alpha:ee,colorModel:null}),ae=0;for(var ie=0;ie<this.size;ie++){var ne=Z(this.getPixel(ie));$?te.data[ae++]=ne*this.data[ie*this.channels+this.components]/this.maxValue:(te.data[ae++]=ne,ee&&(te.data[ae++]=this.data[ie*this.channels+this.components]))}return te};var L=D("../Image"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L)},{"../Image":146}],233:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L,E,G,Z){var W=L.width,Q=L.height,$=E.width,J=L.channels;for(var ee=0;ee<W;ee++)for(var te=0;te<Q;te++)for(var ae=0;ae<J;ae++){var ie=(te*W+ee)*J+ae,ne=((Z+te)*$+G+ee)*J+ae;E.data[ne]=L.data[ie]}}},{}],234:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){var Z=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},W=Z.border;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==G.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==G.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==G.colorModel)throw new Error("Both images must have the same colorModel");for(var Q=new L.default(G.width,G.height,-(1/0)),$=Math.floor(G.width/2),J=Math.floor(G.height/2),ee=$,te=J,ae=!1;!ae;){var ie=Q.localSearch($,J,-(1/0));for(var ne=0;ne<ie.length;ne++){var oe=ie[ne],le=this.getSimilarity(G,{border:W,shift:[ee-oe[0],te-oe[1]]});Q[oe[0]][oe[1]]=le}var se=Q.localMax($,J);se.position[0]!==$||se.position[1]!==J?($=se.position[0],J=se.position[1]):ae=!0}return[$-ee,J-te]};var T=D("../../util/matrix"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../../util/matrix":265}],235:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Z){var W=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},Q=W.keepAlpha,$=Q!==void 0&&Q,J=W.mergeAlpha,ee=J!==void 0&&J;$&=this.alpha,ee&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),Z=(0,E.validateChannel)(this,Z);var te=L.default.createFrom(this,{components:1,alpha:$,colorModel:null}),ae=0;for(var ie=0;ie<this.data.length;ie+=this.channels)ee?te.data[ae++]=this.data[ie+Z]*this.data[ie+this.components]/this.maxValue:(te.data[ae++]=this.data[ie+Z],$&&(te.data[ae++]=this.data[ie+this.components]));return te};var T=D("../Image"),L=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(T),E=D("./../../util/channel")},{"../Image":146,"./../../util/channel":258}],236:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;this.checkProcessable("getColumn",{bitDepth:[8,16]}),this.checkColumn(L),this.checkChannel(E);var G=Array(this.height),Z=0,W=this.width*this.channels;for(var Q=E+L*this.channels;Q<this.data.length;Q+=W)G[Z++]=this.data[Q];return G}},{}],237:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var G=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Z=G.channel;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===Z){if(1<this.components)throw new RangeError("You need to define the channel for an image that contains more than one channel");Z=0}var W=new L.default(this.height,this.width);for(var Q=0;Q<this.height;Q++)for(var $=0;$<this.width;$++)W.set(Q,$,this.getValueXY($,Q,Z));return W};var T=D("ml-matrix"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"ml-matrix":87}],238:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});var L=Array(this.size),E=0;for(var G=0;G<this.data.length;G+=this.channels){var Z=Array(this.components);for(var W=0;W<this.components;W++)Z[W]=this.data[G+W];L[E++]=Z}return L}},{}],239:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var L=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},E=L.sampling,G=void 0===E?[10,10]:E,Z=L.painted,W=void 0!==Z&&Z,Q=L.mask;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(G)||(G=[G,G]);var $=G[0],J=G[1],ee=$*J,te=Array(ee),ae=Array(ee),ie=this.width/$,ne=this.height/J,oe=Math.floor(ie/2),le=0;for(var se=0;se<$;se++){var de=Math.floor(ne/2);for(var ue=0;ue<J;ue++){var he=Math.round(oe),me=Math.round(de);(!Q||Q.getBitXY(he,me))&&(te[le]=[he,me],ae[le]=this.getPixelXY(he,me),le++),de+=ne}oe+=ie}te.length=le,ae.length=le;var ce={xyS:te,zS:ae};return W&&(ce.painted=this.rgba8().paintPoints(te)),ce}},{}],240:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){var E=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;this.checkProcessable("getRow",{bitDepth:[8,16]}),this.checkRow(L),this.checkChannel(E);var G=Array(this.width),Z=0,W=L*this.width*this.channels+E,Q=W+this.width*this.channels;for(var $=W;$<Q;$+=this.channels)G[Z++]=this.data[$];return G}},{}],241:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(Z){var W=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},Q=W.shift,$=void 0===Q?[0,0]:Q,J=W.average,ee=W.channels,te=W.defaultAlpha,ae=W.normalize,ie=W.border,ne=void 0===ie?[0,0]:ie;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(ne)||(ne=[ne,ne]),ee=(0,T.validateArrayOfChannels)(this,{channels:ee,defaultAlpha:te}),this.bitDepth!==Z.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==Z.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==Z.colorModel)throw new Error("Both images must have the same colorModel");"undefined"==typeof J&&(J=!0);var oe=Math.max(ne[0],-$[0]),le=Math.min(this.width-ne[0],this.width-$[0]),se=Math.max(ne[1],-$[1]),de=Math.min(this.height-ne[1],this.height-$[1]),ue=(0,E.default)(ee.length,0);for(var he=0;he<ee.length;he++){var me=ee[he],ce=ae?this.sum[me]:Math.max(this.sum[me],Z.sum[me]),ge=ae?Z.sum[me]:Math.max(this.sum[me],Z.sum[me]);if(0!==ce&&0!==ge)for(var pe=oe;pe<le;pe++)for(var fe=se;fe<de;fe++){var _e=pe*this.multiplierX+fe*this.multiplierY+me,be=_e+$[0]*this.multiplierX+$[1]*this.multiplierY;ue[he]+=Math.min(this.data[_e]/ce,Z.data[be]/ge)}}return J?ue.reduce((ye,xe)=>ye+xe)/ue.length:ue};var T=D("./../../util/channel"),L=D("new-array"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L)},{"./../../util/channel":258,"new-array":114}],242:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var G=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},Z=G.size,W=void 0===Z?0:Z,Q=G.algorithm,$=void 0===Q?"copy":Q,J=G.color;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===$){if(J.length!==this.channels)throw new Error("setBorder: the color array must have the same length as the number of channels. Here: "+this.channels);for(var ee=0;ee<J.length;ee++)0===J[ee]&&(J[ee]=1e-3)}else J=(0,L.default)(this.channels,null);Array.isArray(W)||(W=[W,W]);var te=W[0],ae=W[1],ie=this.channels;for(var ne=te;ne<this.width-te;ne++)for(var oe=0;oe<ie;oe++){var le=J[oe]||this.data[(ne+this.width*ae)*ie+oe];for(var se=0;se<ae;se++)this.data[(se*this.width+ne)*ie+oe]=le;le=J[oe]||this.data[(ne+this.width*(this.height-ae-1))*ie+oe];for(var de=this.height-ae;de<this.height;de++)this.data[(de*this.width+ne)*ie+oe]=le}for(var ue=0;ue<this.height;ue++)for(var he=0;he<ie;he++){var me=J[he]||this.data[(ue*this.width+te)*ie+he];for(var ce=0;ce<te;ce++)this.data[(ue*this.width+ce)*ie+he]=me;me=J[he]||this.data[(ue*this.width+this.width-te-1)*ie+he];for(var ge=this.width-te;ge<this.width;ge++)this.data[(ue*this.width+ge)*ie+he]=me}return this};var T=D("new-array"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"new-array":114}],243:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(E,G){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),G.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),G.width!==this.width||G.height!==this.height)throw new Error("Images must have exactly the same width and height");E=(0,T.validateChannel)(this,E);var Z=E;for(var W=0;W<G.data.length;W++)this.data[Z]=G.data[W],Z+=this.channels;return this};var T=D("./../../util/channel")},{"./../../util/channel":258}],244:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){var E=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},G=E.channel;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===G){if(1<this.components)throw new RangeError("You need to define the channel for an image that contains more than one channel");G=0}if(!L.length||!L[0].length||this.width!==L.columns||this.height!==L.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(var Z=0;Z<this.height;Z++)for(var W=0;W<this.width;W++)this.setValueXY(W,Z,G,L.get(Z,W))}},{}],245:[function(D,I,R){"use strict";function T(W){return W&&W.__esModule?W:{default:W}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var Q=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},$=Q.preserveAlpha,J=void 0===$||$;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new Z.default([this.clone()]);var ee=new Z.default,te=this.data;if(this.alpha&&J)for(var ae=0;ae<this.components;ae++){var ie=E.default.createFrom(this,{components:1,alpha:!0,colorModel:null}),ne=0;for(var oe=0;oe<te.length;oe+=this.channels)ie.data[ne++]=te[oe+ae],ie.data[ne++]=te[oe+this.components];ee.push(ie)}else for(var le=0;le<this.channels;le++){var se=E.default.createFrom(this,{components:1,alpha:!1,colorModel:null}),de=0;for(var ue=0;ue<te.length;ue+=this.channels)se.data[de++]=te[ue+le];ee.push(se)}return ee};var L=D("../Image"),E=T(L),G=D("../../stack/Stack"),Z=T(G)},{"../../stack/Stack":249,"../Image":146}],246:[function(D,I,R){"use strict";var T=D("./image/environment"),L=D("array-includes"),E=function(Z){return Z&&Z.__esModule?Z:{default:Z}}(L);E.default.shim(),I.exports=R=D("./image/Image").default,R.Stack=D("./stack/Stack").default,R.Shape=D("./util/shape").default,R.Kernel=D("./kernel/kernel"),R.Static={grey:D("./image/transform/greyAlgorithms").names,mask:D("./image/transform/mask/maskAlgorithms").names},"browser"===T.env&&(R.Worker=D("./worker/worker").default)},{"./image/Image":146,"./image/environment":160,"./image/transform/greyAlgorithms":206,"./image/transform/mask/maskAlgorithms":214,"./kernel/kernel":247,"./stack/Stack":249,"./util/shape":266,"./worker/worker":270,"array-includes":2}],247:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var T=D("../util/kernels");Object.keys(T).forEach(function(E){"default"===E||"__esModule"===E||Object.defineProperty(R,E,{enumerable:!0,get:function(){return T[E]}})});var L=D("./laplacianOfGaussian");Object.defineProperty(R,"laplacianOfGaussian",{enumerable:!0,get:function(){return L.laplacianOfGaussian}})},{"../util/kernels":264,"./laplacianOfGaussian":248}],248:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.laplacianOfGaussian=function(L,E,G){var Z=Array(E),W=void 0,Q=void 0,$=void 0,J=void 0;G||(G=100),G*=-1;var ee=(E-1)/2,te=2*L*L;for(W=0;W<E;W++)for(Z[W]=Array(E),J=(W-ee)*(W-ee),Q=0;Q<E;Q++)$=(Q-ee)*(Q-ee),Z[W][Q]=Math.round(G*(1-($+J)/te)*Math.exp(-($+J)/te));return Z}},{}],249:[function(D,I,R){"use strict";function T(te){return te&&te.__esModule?te:{default:te}}function L(te){if(Array.isArray(te)){for(var ae=0,ie=Array(te.length);ae<te.length;ae++)ie[ae]=te[ae];return ie}return Array.from(te)}Object.defineProperty(R,"__esModule",{value:!0});var E=D("./extend"),G=T(E),Z=D("../image/Image"),W=T(Z),Q=D("has-own"),$=T(Q),J={configurable:!0,enumerable:!1,get:void 0};class ee extends Array{constructor(te){if(Array.isArray(te)){super(te.length);for(var ae=0;ae<te.length;ae++)this[ae]=te[ae]}else"number"==typeof te?super(te):super();this.computed=null}static load(te){return Promise.all(te.map(W.default.load)).then(ae=>new ee(ae))}static extendMethod(te,ae){var ie=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},ne=ie.inPlace,oe=void 0!==ne&&ne,le=ie.returnThis,se=void 0===le||le,de=ie.partialArgs,ue=void 0===de?[]:de;return ee.prototype[te]=oe?function(){this.computed=null;for(var he=arguments.length,me=Array(he),ce=0;ce<he;ce++)me[ce]=arguments[ce];var ge=ae.apply(this,[].concat(L(ue),me));return se?this:ge}:function(){for(var he=arguments.length,me=Array(he),ce=0;ce<he;ce++)me[ce]=arguments[ce];return ae.apply(this,[].concat(L(ue),me))},ee}static extendProperty(te,ae){var ie=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},ne=ie.partialArgs,oe=void 0===ne?[]:ne;return J.get=function(){if(null===this.computed)this.computed={};else if((0,$.default)(te,this.computed))return this.computed[te];var le=ae.apply(this,oe);return this.computed[te]=le,le},Object.defineProperty(ee.prototype,te,J),ee}checkProcessable(te){var ae=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};if("string"!=typeof te)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw new TypeError("The process: "+te+" can not be applied on an empty stack");this[0].checkProcessable(te,ae);for(var ie=1;ie<this.length;ie++){if((ae.sameSize===void 0||ae.sameSize)&&this[0].width!==this[ie].width)throw new TypeError("The process: "+te+" can not be applied if width is not identical in all images");if((void 0===ae.sameSize||ae.sameSize)&&this[0].height!==this[ie].height)throw new TypeError("The process: "+te+" can not be applied if height is not identical in all images");if((void 0===ae.sameAlpha||ae.sameAlpha)&&this[0].alpha!==this[ie].alpha)throw new TypeError("The process: "+te+" can not be applied if alpha is not identical in all images");if((void 0===ae.sameBitDepth||ae.sameBitDepth)&&this[0].bitDepth!==this[ie].bitDepth)throw new TypeError("The process: "+te+" can not be applied if bitDepth is not identical in all images");if((void 0===ae.sameColorModel||ae.sameColorModel)&&this[0].colorModel!==this[ie].colorModel)throw new TypeError("The process: "+te+" can not be applied if colorModel is not identical in all images");if((void 0===ae.sameNumberChannels||ae.sameNumberChannels)&&this[0].channels!==this[ie].channels)throw new TypeError("The process: "+te+" can not be applied if channels is not identical in all images")}}}R.default=ee,Array[Symbol.species]||(ee.prototype.map=function(te,ae){if("function"!=typeof te)throw new TypeError(te+" is not a function");var ie=new ee(this.length);for(var ne=0;ne<this.length;ne++)ie[ne]=te.call(ae,this[ne],ne,this);return ie}),(0,G.default)(ee)},{"../image/Image":146,"./extend":255,"has-own":44}],250:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){this.checkProcessable("min",{bitDepth:[8,16]});var T=this[0].getHistogram(L);for(var E=1;E<this.length;E++){var G=this[E].getHistogram(L);for(var Z=0;Z<T.length;Z++)T[Z]+=G[Z]}return T}},{}],251:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(L){this.checkProcessable("min",{bitDepth:[8,16]});var T=this[0].getHistograms(L),E=T[0].length;for(var G=1;G<this.length;G++){var Z=this[G].getHistograms(L);for(var W=0;W<T.length;W++)for(var Q=0;Q<E;Q++)T[W][Q]+=Z[W][Q]}return T}},{}],252:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("min",{bitDepth:[8,16]});var T=this[0].max;for(var L=1;L<this.length;L++)for(var E=0;E<T.length;E++)T[E]=Math.max(T[E],this[L].max[E]);return T}},{}],253:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("median",{bitDepth:[8,16]});var E=this.getHistograms({maxSlots:this[0].maxValue+1}),G=Array(E.length);for(var Z=0;Z<E.length;Z++){var W=E[Z];G[Z]=(0,T.median)(W)}return G};var T=D("../../util/histogram")},{"../../util/histogram":262}],254:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("min",{bitDepth:[8,16]});var T=this[0].min;for(var L=1;L<this.length;L++)for(var E=0;E<T.length;E++)T[E]=Math.min(T[E],this[L].min[E]);return T}},{}],255:[function(D,I,R){"use strict";function T(le){return le&&le.__esModule?le:{default:le}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(se){se.extendMethod("matchAndCrop",E.default),se.extendMethod("getMin",Z.default),se.extendMethod("getMax",Q.default),se.extendMethod("getMedian",J.default),se.extendMethod("getHistogram",te.default),se.extendMethod("getHistograms",ie.default),se.extendMethod("getAverage",oe.default)};var L=D("./transform/matchAndCrop"),E=T(L),G=D("./compute/min"),Z=T(G),W=D("./compute/max"),Q=T(W),$=D("./compute/median"),J=T($),ee=D("./compute/histogram"),te=T(ee),ae=D("./compute/histograms"),ie=T(ae),ne=D("./utility/average"),oe=T(ne)},{"./compute/histogram":250,"./compute/histograms":251,"./compute/max":252,"./compute/median":253,"./compute/min":254,"./transform/matchAndCrop":256,"./utility/average":257}],256:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){var G=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},Z=G.algorithm,W=Z===void 0?"matchToPrevious":Z,Q=G.ignoreBorder,$=Q===void 0?[0,0]:Q;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});var J=this[0],ee=[];ee[0]={position:[0,0],image:this[0]};var te=[0,0];for(var ae=1;ae<this.length;ae++){var ie=J.getBestMatch(this[ae],{border:$});ee[ae]={position:[ie[0]+te[0],ie[1]+te[1]],image:this[ae]},"matchToPrevious"===W&&(te[0]+=ie[0],te[1]+=ie[1],J=this[ae])}var ne=0,oe=0,le=0,se=0;for(var de=0;de<ee.length;de++){var ue=ee[de];ue.position[0]>ne&&(ne=ue.position[0]),ue.position[0]<oe&&(oe=ue.position[0]),ue.position[1]>le&&(le=ue.position[1]),ue.position[1]<se&&(se=ue.position[1])}oe=0-oe,se=0-se;for(var he=0;he<ee.length;he++){var me=ee[he];me.crop=me.image.crop({x:ne-me.position[0],y:le-me.position[1],width:J.width-oe-ne,height:J.height-se-le})}var ce=[];for(var ge=0;ge<ee.length;ge++)ce[ge]=ee[ge].crop;return new L.default(ce)};var T=D("../Stack"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../Stack":249}],257:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(){this.checkProcessable("average",{bitDepth:[8,16]});var G=new Uint32Array(this[0].data.length);for(var Z=0;Z<this.length;Z++){var W=this[Z];for(var Q=0;Q<this[0].data.length;Q++)G[Q]+=W.data[Q]}var $=L.default.createFrom(this[0]),J=$.data;for(var ee=0;ee<this[0].data.length;ee++)J[ee]=G[ee]/this.length;return $};var T=D("../../image/Image"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"../../image/Image":146}],258:[function(D,I,R){"use strict";function T(W,Q){var $=Q?W.channels:W.components,J=Array($);for(var ee=0;ee<$;ee++)J[ee]=ee;return J}function L(W,Q,$){Array.isArray(Q)||(Q=[Q]);for(var J=0;J<Q.length;J++)Q[J]=E(W,Q[J],$);return Q}function E(W,Q){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0;if(Q===void 0)throw new RangeError("validateChannel : the channel has to be >=0 and <"+W.channels);if("string"==typeof Q){switch(W.colorModel){case Z.GREY:break;case Z.RGB:"rgb".includes(Q)&&("r"===Q?Q=0:"g"===Q?Q=1:"b"===Q?Q=2:void 0);break;case Z.HSL:"hsl".includes(Q)&&("h"===Q?Q=0:"s"===Q?Q=1:"l"===Q?Q=2:void 0);break;case Z.HSV:"hsv".includes(Q)&&("h"===Q?Q=0:"s"===Q?Q=1:"v"===Q?Q=2:void 0);break;case Z.CMYK:"cmyk".includes(Q)&&("c"===Q?Q=0:"m"===Q?Q=1:"y"===Q?Q=2:"k"===Q?Q=3:void 0);break;default:throw new Error(`Unexpected color model: ${W.colorModel}`);}if("a"===Q){if(!W.alpha)throw new Error("validateChannel : the image does not contain alpha channel");Q=W.components}if("string"==typeof Q)throw new Error("validateChannel : undefined channel: "+Q)}if(Q>=W.channels)throw new RangeError("validateChannel : the channel has to be >=0 and <"+W.channels);if(!$&&Q>=W.components)throw new RangeError("validateChannel : alpha channel may not be selected");return Q}Object.defineProperty(R,"__esModule",{value:!0}),R.validateArrayOfChannels=function(Q){var $=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},J=$.channels,ee=$.allowAlpha,te=$.defaultAlpha;return"boolean"!=typeof ee&&(ee=!0),"undefined"==typeof J?T(Q,te):L(Q,J,ee)},R.validateChannel=E;var G=D("../image/model/model"),Z=function(Q){if(Q&&Q.__esModule)return Q;var $={};if(null!=Q)for(var J in Q)Object.prototype.hasOwnProperty.call(Q,J)&&($[J]=Q[J]);return $.default=Q,$}(G)},{"../image/model/model":186}],259:[function(D,I,R){"use strict";function T(G,Z,W){return 0>W&&(W+=1),1<W&&(W-=1),W<1/6?G+6*(Z-G)*W:W<1/2?Z:W<2/3?G+6*((Z-G)*(2/3-W)):G}function L(G,Z,W){var Q=void 0,$=void 0,J=void 0,ee=void 0,te=void 0,ae=void 0;return Z/=100,W/=100,0===Z?ee=te=ae=255*W:($=0.5>=W?W*(Z+1):W+Z-W*Z,Q=2*W-$,J=G/360,ee=T(Q,$,J+1/3),te=T(Q,$,J),ae=T(Q,$,J-1/3)),{r:ee,g:te,b:ae}}Object.defineProperty(R,"__esModule",{value:!0}),R.css2array=function(Z){var W=(0,E.cssColor)(Z);return[W.r,W.g,W.b,Math.round(255*W.a/100)]},R.getDistinctColors=function(Z){var W=Array(Z),Q=0;for(var $=0;360>$;$+=360/Z){Q++;var J=L($,100,30+15*(Q%4));W[Q-1]=[Math.round(255*J.r),Math.round(255*J.g),Math.round(255*J.b)]}return W},R.getRandomColor=function(){return[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]};var E=D("color-functions")},{"color-functions":9}],260:[function(D,I,R){"use strict";function T(L){if("string"==typeof L){var E=L[L.length-1];L=parseFloat(L),"%"===E&&(L/=100)}return L}Object.defineProperty(R,"__esModule",{value:!0}),R.getFactor=T,R.getThreshold=function(E,G){if(!G)throw Error("getThreshold : the maxValue should be specified");if("string"==typeof E){var Z=E[E.length-1];if("%"!==Z)throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(E)/100*G}if("number"==typeof E)return 1>E?E*G:E;throw Error("getThreshold : the value is not valid")},R.factorDimensions=function(E,G,Z){E=T(E);var W=Math.round(E*G),Q=Math.round(E*Z);return 0>=W&&(W=1),0>=Q&&(Q=1),{width:W,height:Q}}},{}],261:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.dxs=[1,0,-1,0,1,1,-1,-1],R.dys=[0,1,0,-1,1,-1,1,-1]},{}],262:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.median=function(L){var E=L.reduce(($,J)=>$+J);if(0===E)throw new Error("unreachable");for(var G=0,Z=0,W=E/2,Q=void 0;!0;){if(0<L[G]){if(void 0!=Q)return(Q+G)/2;if(Z+=L[G],Z>W)return G;Z==W&&(Q=G)}G++}},R.mean=function(L){var E=0,G=0;for(var Z=0;Z<L.length;Z++)E+=L[Z],G+=L[Z]*Z;return 0===E?0:G/E}},{}],263:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.validateKernel=function(G){var Z=void 0,W=void 0;if(!Array.isArray(G))throw new Error("validateKernel: Invalid Kernel: "+G);else if(!Array.isArray(G[0])){var Q=Math.sqrt(G.length);if((0,L.default)(Q))W=Z=Math.floor(Math.sqrt(G.length)/2);else throw new RangeError("validateKernel: Kernel array should be a square");var $=Array(Q);for(var J=0;J<Q;J++){$[J]=Array(Q);for(var ee=0;ee<Q;ee++)$[J][ee]=G[J*Q+ee]}G=$}else if(0==(1&G.length)||0==(1&G[0].length))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");else Z=Math.floor(G.length/2),W=Math.floor(G[0].length/2);return{kernel:G,kWidth:W,kHeight:Z}};var T=D("is-integer"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"is-integer":53}],264:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.DISCRETE_LAPLACE_4=[[0,1,0],[1,-4,1],[0,1,0]],R.DISCRETE_LAPLACE_8=[[1,1,1],[1,-8,1],[1,1,1]],R.GRADIENT_X=[[-1,0,1],[-2,0,2],[-1,0,1]],R.GRADIENT_Y=[[-1,-2,-1],[0,0,0],[1,2,1]],R.SECOND_DERIVATIVE=[[-1,-2,0,2,1],[-2,-4,0,4,2],[0,0,0,0,0],[1,2,0,-2,-1],[2,4,0,-4,-2]],R.SECOND_DERIVATIVE_INV=[[1,2,0,-2,-1],[2,4,0,-4,-2],[0,0,0,0,0],[-2,-4,0,4,2],[-1,-2,0,2,1]]},{}],265:[function(D,I,R){"use strict";function T(L,E,G){var Z=Array(L);for(var W=0;W<L;W++)Z[W]=Array(E);if(G)for(var Q=0;Q<L;Q++)for(var $=0;$<E;$++)Z[Q][$]=G;return Z.width=L,Z.height=E,Z.__proto__=T.prototype,Z}Object.defineProperty(R,"__esModule",{value:!0}),R.default=T,T.prototype.localMin=function(L,E){var G=this[L][E],Z=[L,E];for(var W=Math.max(0,L-1);W<Math.min(this.length,L+2);W++)for(var Q=Math.max(0,E-1);Q<Math.min(this[0].length,E+2);Q++)this[W][Q]<G&&(G=this[W][Q],Z=[W,Q]);return{position:Z,value:G}},T.prototype.localMax=function(L,E){var G=this[L][E],Z=[L,E];for(var W=Math.max(0,L-1);W<Math.min(this.length,L+2);W++)for(var Q=Math.max(0,E-1);Q<Math.min(this[0].length,E+2);Q++)this[W][Q]>G&&(G=this[W][Q],Z=[W,Q]);return{position:Z,value:G}},T.prototype.localSearch=function(L,E,G){var Z=[];for(var W=Math.max(0,L-1);W<Math.min(this.length,L+2);W++)for(var Q=Math.max(0,E-1);Q<Math.min(this[0].length,E+2);Q++)this[W][Q]===G&&Z.push([W,Q]);return Z}},{}],266:[function(D,I,R){"use strict";function T(ae){return ae&&ae.__esModule?ae:{default:ae}}function L(ae,ie,ne){var oe=W.default.zeros(ie,ae);if(ne.filled)for(var le=0;le<ie;le++)for(var se=0;se<ae;se++)oe.set(le,se,1);else{for(var de of[0,ie-1])for(var ue=0;ue<ae;ue++)oe.set(de,ue,1);for(var he=0;he<ie;he++)for(var me of[0,ae-1])oe.set(he,me,1)}return oe}function E(ae,ie,ne){var oe=W.default.zeros(ie,ae,ne),le=1-ie%2,se=1-ae%2,de=Math.floor((ae-1)/2),ue=Math.floor((ie-1)/2),he=de*de,me=ue*ue;if(ne.filled)for(var ce=0;ce<=ue;ce++){var ge=Math.floor(Math.sqrt(he-he*ce*ce/me));for(var pe=de-ge;pe<=de;pe++)oe.set(ue-ce,pe,1),oe.set(ue+ce+le,pe,1),oe.set(ue-ce,ae-pe-1,1),oe.set(ue+ce+le,ae-pe-1,1)}else{for(var fe=0;fe<=ue;fe++){var _e=Math.floor(Math.sqrt(he-he*fe*fe/me)),be=de-_e;oe.set(ue-fe,be,1),oe.set(ue+fe+le,be,1),oe.set(ue-fe,ae-be-1,1),oe.set(ue+fe+le,ae-be-1,1)}for(var ye=0;ye<=de;ye++){var xe=Math.floor(Math.sqrt(me-me*ye*ye/he)),ke=ue-xe;oe.set(ke,de-ye,1),oe.set(ke,de+ye+se,1),oe.set(ie-ke-1,de-ye,1),oe.set(ie-ke-1,de+ye+se,1)}}return oe}function G(ae,ie,ne){if(!ne.filled)throw new Error("Non filled triangle is not implemented");var oe=W.default.zeros(ie,ae,ne);for(var le=0;le<ie;le++){var se=Math.floor((1-le/ie)*ae/2);for(var de=se;de<ae-se;de++)oe.set(le,de,1)}return oe}Object.defineProperty(R,"__esModule",{value:!0});var Z=D("ml-matrix"),W=T(Z),Q=D("../image/Image"),$=T(Q),J=D("../image/kindNames"),ee=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],te=[[0,1,0],[1,1,1],[0,1,0]];R.default=class{constructor(){var ie=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},ne=ie.kind,oe=void 0===ne?"cross":ne,le=ie.shape,se=ie.size,de=ie.width,ue=ie.height,he=ie.filled,me=void 0===he||he;if(se&&(de=se,ue=se),le)switch(le.toLowerCase()){case"square":case"rectangle":this.matrix=L(de,ue,{filled:me});break;case"circle":case"ellipse":this.matrix=E(de,ue,{filled:me});break;case"triangle":this.matrix=G(de,ue,{filled:me});break;default:throw new Error(`Shape: unexpected shape: ${le}`);}else if(oe)switch(oe.toLowerCase()){case"cross":this.matrix=ee;break;case"smallcross":this.matrix=te;break;default:throw new Error(`Shape: unexpected kind: ${oe}`);}else throw new Error("Shape: expected a kind or a shape option");this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2>>0,this.halfWidth=this.width/2>>0}getPoints(){var ie=this.matrix,ne=[];for(var oe=0;oe<ie.length;oe++)for(var le=0;le<ie[0].length;le++)ie[oe][le]&&ne.push([le-this.halfWidth,oe-this.halfHeight]);return ne}getMask(){var ie=new $.default(this.width,this.height,{kind:J.BINARY});for(var ne=0;ne<this.matrix.length;ne++)for(var oe=0;oe<this.matrix[0].length;oe++)this.matrix[ne][oe]&&ie.setBitXY(oe,ne);return ie}}},{"../image/Image":146,"../image/kindNames":183,"ml-matrix":87}],267:[function(D,I,R){"use strict";function T(W){return W&&W.__esModule?W:{default:W}}Object.defineProperty(R,"__esModule",{value:!0}),R.checkNumberArray=function(Q){if(!isNaN(Q)){if(0>=Q)throw new Error("checkNumberArray: the value must be greater than 0");return Q}if(Q instanceof E.default)return Q.data;if(!(0,Z.default)(Q))throw new Error("checkNumberArray: the value should be either a number, array or Image");return Q};var L=D("../image/Image"),E=T(L),G=D("is-array-type"),Z=T(G)},{"../image/Image":146,"is-array-type":49}],268:[function(D,I,R){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.default=function(G){G.extendMethod("background",L.default)};var T=D("./process/background"),L=function(G){return G&&G.__esModule?G:{default:G}}(T)},{"./process/background":269}],269:[function(D,I,R){"use strict";function T($){return $&&$.__esModule?$:{default:$}}function L($,J,ee){return $.post("data",[J,ee]).then(function(te){for(var ae in te)te[ae]=new W.default(te[ae]);return te})}Object.defineProperty(R,"__esModule",{value:!0});var E=D("extend"),G=T(E),Z=D("../../image/Image"),W=T(Z),Q={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:0.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};R.default={run:function(J,ee,te){ee=(0,G.default)({},Q,ee);var ae=this.manager;return Array.isArray(J)?Promise.all(J.map(function(ie){var ne=L(ae,ie,ee);return"function"==typeof te&&ne.then(te),ne})):L(ae,J,ee)},work:function(){worker.on("data",function(J,ee,te){function ae(ge,pe){te.include.includes(ge)&&(ie[ge]=pe,ne.push(pe.data.buffer))}ee=new IJS(ee);var ie={},ne=[],oe=ee.grey(),le=oe.sobelFilter();ae("sobel",le);var se=le.level().mask({threshold:te.threshold});ae("mask",se);var de=le.getRoiManager();de.fromMask(se);var ue=de.getMask(te.roi);ae("realMask",ue);var he=oe.getPixelsGrid({sampling:te.sampling,mask:ue}),me=ee.getBackground(he.xyS,he.zS,te.regression);ae("background",me);var ce=ee.subtract(me);ie.result=ce,ne.push(ce.data.buffer),J(ie,ne)})}}},{"../../image/Image":146,extend:35}],270:[function(D,I,R){"use strict";function T(Q){return Q&&Q.__esModule?Q:{default:Q}}Object.defineProperty(R,"__esModule",{value:!0});var L=D("web-worker-manager"),E=T(L),G=D("./extend"),Z=T(G);class W{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(Q){if("string"!=typeof Q)throw new TypeError("worker URL must be a string");this._url=Q,this._deps[0]=Q}static extendMethod(Q,$){function J(){var ie;ee||(this.checkUrl(),te=this.url,ee=new E.default($.work,{deps:te}),ae.manager=ee);for(var ne=arguments.length,oe=Array(ne),le=0;le<ne;le++)oe[le]=arguments[le];return(ie=$.run).call.apply(ie,[ae].concat(oe))}var ee=void 0,te=void 0,ae={};J.reset=function(){ee&&(ee.terminate(),ee=new E.default($.work,{deps:te}),ae.manager=ee)},W.prototype[Q]=J}}(0,Z.default)(W),R.default=new W},{"./extend":268,"web-worker-manager":144}]},{},[246])(246)});

//# sourceMappingURL=image.min.js.map